<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HVAC Markets - Air Conditioning Platform</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');
        
        /* Reset and base styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            line-height: 1.6;
            color: #1A1A1A;
            background: #FFFFFF;
            overflow-x: hidden;
        }

        /* Color variables */
        :root {
            --primary-white: #FFFFFF;
            --deep-graphite: #1A1A1A;
            --signature-blue: #1464F4;
            --warm-gray: #F4F4F4;
            --lemon: #F4E146;
            --turquoise: #46F4E1;
            --light-gray: #E5E5E5;
            --orange: #FF6B35;
            --success-green: #4CAF50;
            --warning-yellow: #FF9800;
            --error-red: #F44336;
            --search-header-gray: #EEEEEE;
        }

        /* Typography */
        h1, h2, h3, h4, h5, h6 {
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            line-height: 1.2;
        }

        /* Navigation */
        .nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 80px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 2rem;
            z-index: 1000;
            border-bottom: 1px solid rgba(26, 26, 26, 0.1);
        }

        .nav-logo {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            cursor: default;
        }

        .logo-main {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .hvac-letters {
            display: flex;
            gap: 0.05rem;
            align-items: center;
        }

        .hvac-letter {
            font-size: 1.5rem;
            font-weight: 900;
            color: var(--deep-graphite);
            letter-spacing: 0;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 0.2rem 0.1rem;
            border-radius: 4px;
            position: relative;
            margin: 0;
            z-index: 10;
            pointer-events: auto;
        }

        .markets-text {
            font-size: 1.5rem;
            font-weight: 900;
            color: var(--deep-graphite);
            letter-spacing: 0.1em;
        }


        /* Heating platform styles */
        .hvac-letter[data-platform="heating"]:hover {
            background: rgba(255, 107, 53, 0.15);
            color: #FF6B35;
        }

        /* Ventilation platform styles */
        .hvac-letter[data-platform="ventilation"]:hover {
            background: rgba(76, 175, 80, 0.15);
            color: #4CAF50;
        }

        /* Air Conditioning platform styles (default) */
        .hvac-letter[data-platform="airconditioning"] {
            background: rgba(20, 100, 244, 0.15);
            color: var(--signature-blue);
        }

        .hvac-letter[data-platform="airconditioning"]:hover {
            background: rgba(20, 100, 244, 0.25);
            color: var(--signature-blue);
        }

        .nav-menu {
            display: flex;
            gap: 1.2rem;
        }

        .nav-item {
            text-decoration: none;
            color: var(--deep-graphite);
            font-weight: 500;
            font-size: 0.8rem;
            letter-spacing: 0.05em;
            transition: color 0.3s ease;
        }

        .nav-item:hover {
            color: var(--signature-blue);
        }

        .nav-item.active {
            color: var(--signature-blue);
        }

        /* Navigation Right Side */
        .nav-right {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .nav-icon {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: transparent;
            color: var(--deep-graphite);
            transition: all 0.3s ease;
            text-decoration: none;
            border: 2px solid transparent;
            position: relative;
            cursor: pointer;
        }

        .nav-icon:hover {
            background: var(--signature-blue);
            color: var(--primary-white);
            border-color: var(--signature-blue);
            transform: scale(1.05);
        }

        .profile-icon {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: transparent;
            color: var(--deep-graphite);
            transition: all 0.3s ease;
            text-decoration: none;
            border: 2px solid transparent;
        }

        .profile-icon:hover {
            background: var(--signature-blue);
            color: var(--primary-white);
            border-color: var(--signature-blue);
            transform: scale(1.05);
        }

        .cart-badge {
            position: absolute;
            top: -2px;
            right: -2px;
            background: var(--signature-blue);
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: 600;
            min-width: 18px;
            transition: all 0.3s ease;
        }
        
        .cart-badge.updated {
            animation: cart-pulse 0.5s ease;
            background: var(--success-green);
        }
        
        @keyframes cart-pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.3); }
            100% { transform: scale(1); }
        }

        /* Cart Modal Styles */
        .cart-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }

        .cart-modal-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
        }

        .cart-modal-content {
            position: relative;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            max-width: 800px;
            max-height: 90vh;
            width: 100%;
            overflow: hidden;
            animation: cart-modal-appear 0.3s ease;
        }

        @keyframes cart-modal-appear {
            0% { opacity: 0; transform: scale(0.9) translateY(-20px); }
            100% { opacity: 1; transform: scale(1) translateY(0); }
        }

        .cart-header {
            background: var(--signature-blue);
            color: white;
            padding: 1.5rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .cart-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin: 0;
        }

        .cart-close {
            background: none;
            border: none;
            color: white;
            font-size: 2rem;
            cursor: pointer;
            padding: 0;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background 0.3s ease;
        }

        .cart-close:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .cart-body {
            padding: 2rem;
            max-height: 70vh;
            overflow-y: auto;
        }

        .cart-items {
            margin-bottom: 2rem;
        }

        .cart-brand-section {
            margin-bottom: 2rem;
            border: 1px solid var(--light-gray);
            border-radius: 8px;
            overflow: hidden;
        }

        .cart-brand-header {
            background: var(--warm-gray);
            padding: 1rem 1.5rem;
            font-weight: 700;
            font-size: 1.1rem;
            color: var(--deep-graphite);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 8px 8px 0 0;
        }

        .cart-brand-logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 1.2rem;
        }

        .cart-brand-name {
            font-weight: 700;
            text-shadow: 0 1px 2px rgba(0,0,0,0.2);
        }

        .cart-brand-products {
            background: white;
        }

        .cart-brand-count {
            background: var(--signature-blue);
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .cart-product-item {
            display: flex;
            align-items: center;
            padding: 1rem 1.5rem;
            border-bottom: 1px solid var(--light-gray);
            gap: 1rem;
        }

        .cart-product-item:last-child {
            border-bottom: none;
        }

        .cart-product-icon {
            width: 40px;
            height: 40px;
            background: var(--warm-gray);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: #999;
            flex-shrink: 0;
        }

        .cart-product-info {
            flex: 1;
            min-width: 0;
        }

        .cart-product-name {
            font-weight: 600;
            color: var(--deep-graphite);
            margin-bottom: 0.25rem;
            word-break: break-word;
        }

        .cart-product-specs {
            font-size: 0.85rem;
            color: #666;
            line-height: 1.3;
        }

        .cart-product-price {
            font-weight: 700;
            color: var(--signature-blue);
            font-size: 1.1rem;
        }

        .cart-product-remove {
            background: var(--error-red);
            color: white;
            border: none;
            border-radius: 4px;
            width: 28px;
            height: 28px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .cart-product-remove:hover {
            background: var(--deep-graphite);
            transform: scale(1.05);
        }

        .cart-product-analog {
            font-size: 0.75rem;
            color: var(--signature-blue);
            font-weight: 600;
            background: rgba(20, 100, 244, 0.1);
            padding: 0.25rem 0.5rem;
            border-radius: 12px;
            margin-top: 0.25rem;
            display: inline-block;
        }

        .cart-summary {
            background: var(--warm-gray);
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 2rem;
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.75rem;
            font-size: 1rem;
        }

        .summary-row.total {
            border-top: 2px solid var(--light-gray);
            padding-top: 0.75rem;
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--signature-blue);
        }

        .cart-actions {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .btn-cart-action {
            flex: 1;
            min-width: 150px;
            padding: 0.875rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-family: inherit;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .btn-primary {
            background: var(--signature-blue);
            color: white;
        }

        .btn-primary:hover {
            background: var(--deep-graphite);
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: var(--success-green);
            color: white;
        }

        .btn-secondary:hover {
            background: #45a049;
            transform: translateY(-1px);
        }

        .btn-danger {
            background: var(--error-red);
            color: white;
        }

        .btn-danger:hover {
            background: #d32f2f;
            transform: translateY(-1px);
        }

        .cart-empty {
            text-align: center;
            padding: 3rem 1rem;
            color: #666;
        }

        .cart-empty-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        .cart-empty-text {
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
        }

        .cart-empty-subtext {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        /* Mobile responsiveness */
        @media (max-width: 768px) {
            .cart-modal-content {
                margin: 1rem;
                max-height: 95vh;
            }

            .cart-header {
                padding: 1rem;
            }

            .cart-body {
                padding: 1rem;
            }

            .cart-actions {
                flex-direction: column;
            }

            .btn-cart-action {
                min-width: auto;
            }

            .cart-product-item {
                padding: 0.75rem;
                flex-wrap: wrap;
                gap: 0.5rem;
            }

            .cart-product-info {
                flex-basis: 100%;
                order: 1;
            }

            .cart-product-price {
                order: 2;
            }

            .cart-product-remove {
                order: 3;
            }
        }

        .search-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            align-items: flex-start;
            justify-content: center;
            padding-top: 100px;
            z-index: 10000;
        }

        .search-modal.active {
            display: flex;
        }

        .search-modal-content {
            background: white;
            border-radius: 12px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
        }

        .search-modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .search-modal-title {
            margin: 0;
            color: var(--deep-graphite);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .search-modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--deep-graphite);
        }

        .search-modal-body {
            padding: 1.5rem;
        }

        .profile-icon svg {
            transition: transform 0.3s ease;
        }

        .profile-icon:hover svg {
            transform: scale(1.1);
        }

        /* Navigation Dropdowns */
        .nav-dropdown {
            position: relative;
        }

        .nav-select {
            background: var(--primary-white);
            border: 2px solid var(--light-gray);
            color: var(--deep-graphite);
            padding: 0.5rem 2rem 0.5rem 1rem;
            font-family: inherit;
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 6px;
            text-transform: uppercase;
            min-width: 80px;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%23666' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 0.7rem center;
            background-size: 1em;
        }

        .nav-select:hover {
            border-color: var(--signature-blue);
            color: var(--signature-blue);
        }

        .nav-select:focus {
            outline: none;
            border-color: var(--signature-blue);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        /* Mobile Menu Toggle */
        .mobile-menu-toggle {
            display: none;
            flex-direction: column;
            justify-content: space-around;
            width: 24px;
            height: 24px;
            background: transparent;
            border: none;
            cursor: pointer;
            padding: 12px;
            min-width: 48px;
            min-height: 48px;
            touch-action: manipulation;
            border-radius: 4px;
            transition: background-color 0.3s ease;
        }

        .mobile-menu-toggle:hover {
            background-color: rgba(20, 100, 244, 0.1);
        }

        .hamburger-line {
            width: 100%;
            height: 2px;
            background-color: var(--deep-graphite);
            transition: all 0.3s ease;
            transform-origin: center;
        }

        .mobile-menu-toggle.active .hamburger-line:nth-child(1) {
            transform: rotate(45deg) translate(5px, 5px);
        }

        .mobile-menu-toggle.active .hamburger-line:nth-child(2) {
            opacity: 0;
        }

        .mobile-menu-toggle.active .hamburger-line:nth-child(3) {
            transform: rotate(-45deg) translate(7px, -6px);
        }

        /* Mobile Menu */
        .mobile-menu {
            position: fixed;
            top: 80px;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            transform: translateY(-100%);
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 999;
            border-top: 1px solid var(--light-gray);
        }

        .mobile-menu.active {
            transform: translateY(0);
            opacity: 1;
            visibility: visible;
        }

        .mobile-menu-content {
            padding: 2rem;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .mobile-menu-item {
            text-decoration: none;
            color: var(--deep-graphite);
            font-weight: 600;
            font-size: 1.1rem;
            letter-spacing: 0.05em;
            padding: 1rem 0;
            border-bottom: 1px solid var(--light-gray);
            transition: all 0.3s ease;
        }

        .mobile-menu-item:last-child {
            border-bottom: none;
        }

        .mobile-menu-item:hover {
            color: var(--signature-blue);
            transform: translateX(10px);
        }

        /* Main Dashboard Layout */
        .dashboard-container {
            padding-top: 100px;
            min-height: 100vh;
            background: var(--warm-gray);
            display: flex;
            position: relative;
        }

        /* Equipment Type Sidebar */
        .equipment-sidebar {
            background: var(--warm-gray);
            padding: 1rem 0.5rem;
            border-right: 1px solid var(--light-gray);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
            min-height: 600px;
        }

        /* Search layout positioning */
        .search-layout {
            position: relative;
            margin-left: 0;
        }

        .equipment-type-item {
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            background: transparent;
            border: none;
            margin-bottom: 0.5rem;
            border-radius: 6px;
        }

        .equipment-type-item:hover {
            transform: scale(1.1);
        }

        /* Equipment Icon Colors - Light Outline Style */
        .equipment-icon {
            width: 24px;
            height: 24px;
            transition: all 0.3s ease;
            fill: #d0d0d0;
            stroke: #d0d0d0;
        }

        .equipment-icon svg {
            width: 100%;
            height: 100%;
        }

        .equipment-type-item:hover .equipment-icon {
            transform: scale(1.1);
            fill: #a0a0a0;
            stroke: #a0a0a0;
        }

        /* Air Conditioning Equipment - Blue Colors on Active */
        .equipment-type-item[data-subcategory="split-systems"].active .equipment-icon,
        .equipment-type-item[data-subcategory="multi-split"].active .equipment-icon,
        .equipment-type-item[data-subcategory="vrf"].active .equipment-icon,
        .equipment-type-item[data-subcategory="accessories"].active .equipment-icon {
            fill: var(--signature-blue);
            stroke: var(--signature-blue);
            transform: scale(1.1);
        }


        /* Ventilation Equipment - Dark Blue Colors on Active */
        .equipment-type-item[data-subcategory="supply-ventilation"].active .equipment-icon,
        .equipment-type-item[data-subcategory="exhaust-ventilation"].active .equipment-icon,
        .equipment-type-item[data-subcategory="heat-recovery"].active .equipment-icon,
        .equipment-type-item[data-subcategory="air-handling"].active .equipment-icon,
        .equipment-type-item[data-subcategory="fans"].active .equipment-icon {
            fill: #0d47a1;
            stroke: #0d47a1;
            transform: scale(1.1);
        }


        /* Heating Equipment - Red Colors on Active */
        .equipment-type-item[data-subcategory="heat-pumps"].active .equipment-icon,
        .equipment-type-item[data-subcategory="boilers"].active .equipment-icon,
        .equipment-type-item[data-subcategory="radiators"].active .equipment-icon,
        .equipment-type-item[data-subcategory="floor-heating"].active .equipment-icon,
        .equipment-type-item[data-subcategory="heat-exchangers"].active .equipment-icon {
            fill: #f44336;
            stroke: #f44336;
            transform: scale(1.1);
        }



        .equipment-tooltip {
            position: absolute;
            left: calc(100% + 10px);
            top: 50%;
            transform: translateY(-50%);
            background: var(--deep-graphite);
            color: white;
            padding: 0.5rem 0.75rem;
            border-radius: 6px;
            font-size: 0.8rem;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            z-index: 1000;
        }

        .equipment-tooltip::before {
            content: '';
            position: absolute;
            left: -4px;
            top: 50%;
            transform: translateY(-50%);
            border: 4px solid transparent;
            border-right-color: var(--deep-graphite);
        }

        .equipment-type-item:hover .equipment-tooltip {
            opacity: 1;
        }

        /* Main content area with sidebar offset */
        .main-content-area {
            flex: 1;
            margin-left: 80px;
        }

        /* Module Content Styles */
        .module-content {
            display: none;
            padding: 2rem;
            min-height: 80vh;
            width: 100%;
        }

        .module-content.active {
            display: block !important;
        }

        /* Ensure module grids are visible */
        .module-content .module-grid {
            display: grid !important;
        }

        .module-content .module-card {
            opacity: 1;
            visibility: visible;
        }

        /* Scout Content Styles (sub-tabs within modules) */
        .scout-content {
            display: none;
        }

        .scout-content.active {
            display: block;
        }

        .dashboard-header {
            text-align: center;
            padding: 2rem 0;
            background: var(--primary-white);
            margin-bottom: 2rem;
        }

        .dashboard-title {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            color: var(--deep-graphite);
        }

        .dashboard-subtitle {
            font-size: 1.2rem;
            color: #666;
            font-weight: 400;
            text-transform: none;
        }

        /* Module Tabs */
        .module-tabs {
            display: flex;
            justify-content: center;
            gap: 0;
            margin-bottom: 3rem;
            overflow-x: auto;
            padding: 0 2rem;
        }

        .module-tab {
            background: var(--primary-white);
            border: 2px solid var(--light-gray);
            color: var(--deep-graphite);
            padding: 1rem 2rem;
            font-family: inherit;
            font-weight: 600;
            font-size: 0.9rem;
            letter-spacing: 0.05em;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            white-space: nowrap;
            min-width: 150px;
        }

        .module-tab:first-child {
            border-top-left-radius: 8px;
            border-bottom-left-radius: 8px;
        }

        .module-tab:last-child {
            border-top-right-radius: 8px;
            border-bottom-right-radius: 8px;
        }

        .module-tab:not(:first-child) {
            border-left: none;
        }

        .module-tab:hover {
            border-color: var(--signature-blue);
            color: var(--signature-blue);
        }

        .module-tab.active {
            background: var(--signature-blue);
            border-color: var(--signature-blue);
            color: var(--primary-white);
        }

        /* Module Content */
        .module-content {
            display: none;
            max-width: 100%;
            margin: 0 auto;
            padding: 0 1rem;
        }

        .module-content.active {
            display: block;
        }

        /* Module Cards Grid */
        .module-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        /* Equipment Search Block */
        .equipment-search {
            background: var(--primary-white);
            border-radius: 0;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            margin-bottom: 2rem;
            width: calc(100vw - 80px);
            margin-left: -80px;
            margin-right: 0;
        }

        .search-header {
            background: var(--search-header-gray);
            color: var(--deep-graphite);
            padding: 0.75rem 2rem;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 2rem;
        }

        .header-text {
            flex: 1;
        }

        .search-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .search-subtitle {
            font-size: 1rem;
            opacity: 0.9;
            font-weight: 400;
        }

        .header-ai-search {
            flex-shrink: 0;
        }

        .ai-search-box {
            min-width: 500px; /* увеличено еще больше */
        }

        .ai-search-input-wrapper {
            display: flex;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 25px;
            padding: 0.25rem;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            width: 100%;
        }

        .ai-search-input {
            flex: 1;
            background: transparent;
            border: none;
            padding: 0.75rem 1rem;
            color: var(--primary-white);
            font-size: 0.9rem;
            outline: none;
        }

        .ai-search-input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .ai-search-btn {
            background: var(--primary-white);
            color: var(--signature-blue);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            font-size: 1.1rem;
        }

        .ai-search-btn:hover {
            background: var(--lemon);
            transform: scale(1.05);
        }

        .ai-icon {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        /* Responsive AI Search */
        @media (max-width: 1200px) {
            .header-content {
                flex-direction: column;
                gap: 1.5rem;
                text-align: center;
            }

            .ai-search-box {
                min-width: 450px;
            }
        }

        /* Additional mobile text overflow improvements */
        @media (max-width: 480px) {
            .card-title {
                font-size: 0.9rem;
                line-height: 1.2;
            }

            .card-description {
                font-size: 0.8rem;
                line-height: 1.3;
            }

            .card-header {
                flex-direction: row;
                align-items: center;
                justify-content: space-between;
                gap: 0.5rem;
                margin-bottom: 0.75rem;
            }

            .card-icon {
                display: none; /* Hide icons on small mobile screens */
            }

            .product-image {
                display: none; /* Hide product icons in equipment list */
            }

            /* Mobile card layout optimization */
            .module-card {
                position: relative;
            }

            .card-header {
                display: flex;
                align-items: flex-start;
                justify-content: space-between;
                margin-bottom: 0.5rem;
            }

            .card-header > div {
                flex: 1;
                min-width: 0;
            }

            .card-description {
                margin-bottom: 0.75rem;
                clear: both;
            }

            .card-metrics {
                position: absolute;
                top: 0;
                right: 0;
                display: flex;
                flex-direction: column;
                gap: 0.25rem;
                margin: 0;
                padding: 0;
                background: transparent;
                max-width: 80px;
            }

            .metric {
                text-align: right;
                min-width: 0;
                padding: 0.2rem 0.4rem;
                background: rgba(20, 100, 244, 0.08);
                border-radius: 3px;
                margin-bottom: 0.15rem;
            }

            .metric-value {
                font-size: 0.85rem;
                font-weight: 700;
                margin-bottom: 0.05rem;
                color: var(--signature-blue);
            }

            .metric-label {
                font-size: 0.6rem;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
                color: #666;
                line-height: 1;
            }

            /* Adjust card title to leave space for metrics */
            .card-title {
                padding-right: 85px;
                margin-bottom: 0.25rem;
            }

            /* Enhanced mobile touch targets and usability */
            .module-tab, .scout-tab {
                min-height: 48px;
                padding: 0.75rem 0.5rem;
                font-size: 0.75rem;
                min-width: 100px;
                touch-action: manipulation;
            }

            .ai-search-btn, .ai-chat-send-btn, .send-btn {
                min-height: 48px;
                min-width: 48px;
                touch-action: manipulation;
                font-size: 1.1rem;
            }

            .nav-select {
                min-height: 40px;
                padding: 0.5rem 1.5rem 0.5rem 0.75rem;
                font-size: 0.8rem;
                touch-action: manipulation;
            }

            .profile-icon {
                min-height: 44px;
                min-width: 44px;
                touch-action: manipulation;
            }

            /* Better mobile spacing for tab containers */
            .module-tabs {
                gap: 2px;
                padding: 0.5rem;
                flex-wrap: wrap;
                justify-content: center;
            }

            .scout-tabs {
                gap: 2px;
                padding: 0.5rem;
                flex-wrap: wrap;
                justify-content: center;
            }
        }

        @media (max-width: 768px) {
            .search-header {
                padding: 0.5rem 1rem;
            }

            .ai-search-box {
                min-width: 280px;
                width: 100%;
            }

            .ai-search-input, .ai-chat-input-field {
                min-height: 44px;
                font-size: 16px; /* Prevents zoom on iOS */
                touch-action: manipulation;
            }

            .ai-search-input {
                font-size: 0.8rem;
                padding: 0.6rem 0.8rem;
            }
        }

        @media (max-width: 480px) {
            .ai-search-box {
                min-width: 300px;
            }
        }

        /* Scout Sub-tabs */
        .scout-tabs {
            display: flex;
            justify-content: center;
            gap: 0;
            margin-bottom: 2rem;
            overflow-x: auto;
            padding: 0 2rem;
        }

        .scout-tab {
            background: var(--warm-gray);
            border: 2px solid var(--light-gray);
            color: var(--deep-graphite);
            padding: 1rem 2rem;
            font-family: inherit;
            font-weight: 600;
            font-size: 0.9rem;
            letter-spacing: 0.05em;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            white-space: nowrap;
            min-width: 180px;
        }

        .scout-tab:first-child {
            border-top-left-radius: 8px;
            border-bottom-left-radius: 8px;
        }

        .scout-tab:last-child {
            border-top-right-radius: 8px;
            border-bottom-right-radius: 8px;
        }

        .scout-tab:not(:first-child) {
            border-left: none;
        }

        .scout-tab:hover {
            border-color: var(--signature-blue);
            color: var(--signature-blue);
        }

        .scout-tab.active {
            background: var(--signature-blue);
            border-color: var(--signature-blue);
            color: var(--primary-white);
        }

        .scout-content {
            display: none;
        }

        .scout-content.active {
            display: block;
        }

        /* AI Chat Interface */
        .ai-search-interface {
            margin-bottom: 2rem;
        }

        .ai-chat-container {
            background: var(--primary-white);
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            margin-bottom: 2rem;
        }

        .ai-chat-messages {
            padding: 2rem;
            max-height: 300px;
            overflow-y: auto;
            border-bottom: 1px solid var(--light-gray);
        }

        .ai-message {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .ai-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--signature-blue);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .ai-message-content {
            background: var(--warm-gray);
            padding: 1rem 1.5rem;
            border-radius: 18px;
            flex: 1;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .ai-chat-input {
            display: flex;
            padding: 1.5rem 2rem;
            gap: 1rem;
        }

        .ai-chat-input-field {
            flex: 1;
            border: 2px solid var(--light-gray);
            border-radius: 25px;
            padding: 0.75rem 1.5rem;
            font-family: inherit;
            font-size: 0.9rem;
            outline: none;
            transition: border-color 0.3s ease;
        }

        .ai-chat-input-field:focus {
            border-color: var(--signature-blue);
        }

        .ai-chat-send-btn {
            background: var(--signature-blue);
            color: var(--primary-white);
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .ai-chat-send-btn:hover {
            background: var(--deep-graphite);
            transform: scale(1.05);
        }

        /* Analytics Charts */
        .analytics-charts {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .chart-container {
            background: var(--primary-white);
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        }

        .chart-header {
            margin-bottom: 1.5rem;
        }

        .chart-header h3 {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--deep-graphite);
        }

        .chart-placeholder {
            text-align: center;
        }

        .chart-mock {
            display: flex;
            align-items: end;
            justify-content: space-between;
            height: 200px;
            margin-bottom: 1rem;
        }

        .chart-bar {
            width: 30px;
            background: #D1D1D1;
            border-radius: 4px 4px 0 0;
            animation: growBar 1s ease-out;
        }

        @keyframes growBar {
            from { height: 0; }
        }

        .pie-chart-mock {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            margin: 0 auto 1rem;
            background: conic-gradient(
                var(--signature-blue) 0deg 126deg,
                var(--success-green) 126deg 216deg,
                var(--orange) 216deg 288deg,
                var(--lemon) 288deg 360deg
            );
            position: relative;
        }

        .chart-label {
            font-size: 0.8rem;
            color: #666;
            font-style: italic;
        }

        /* Responsive Scout Tabs */
        @media (max-width: 768px) {
            .scout-tabs {
                padding: 0 1rem;
            }

            .scout-tab {
                min-width: 150px;
                padding: 0.75rem 1rem;
                font-size: 0.8rem;
            }

            .ai-chat-messages {
                padding: 1rem;
            }

            .ai-chat-input {
                padding: 1rem;
            }

            .analytics-charts {
                grid-template-columns: 1fr;
            }
        }

        /* Brand Tabs */
        .brand-tabs {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--warm-gray);
            border-bottom: 1px solid var(--light-gray);
            overflow-x: auto;
            padding: 0 1rem;
        }

        .brand-tabs-left {
            display: flex;
            overflow-x: auto;
            flex: 1;
        }

        .brand-tabs-right {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-left: 2rem;
            white-space: nowrap;
        }

        .brand-tab {
            background: transparent;
            border: none;
            padding: 1rem 1.5rem;
            font-family: inherit;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
            position: relative;
            color: #666;
        }

        .brand-tab.active {
            color: var(--signature-blue);
            background: var(--primary-white);
        }

        .brand-tab.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--signature-blue);
        }

        .brand-tab:hover:not(.active) {
            background: rgba(255, 255, 255, 0.7);
            color: var(--deep-graphite);
        }

        /* Brand discount indicator */
        .brand-discount {
            display: inline-block;
            background: var(--orange);
            color: white;
            font-size: 0.7rem;
            padding: 0.2rem 0.5rem;
            border-radius: 10px;
            margin-left: 0.5rem;
            font-weight: 700;
        }

        /* Catalog Categories Row */
        .catalog-categories-row {
            display: flex;
            gap: 1rem;
            background: var(--primary-white);
            border-bottom: 1px solid var(--light-gray);
            padding: 0.75rem 1rem;
        }

        .category-dropdown {
            position: relative;
            flex: 1;
        }

        .category-btn {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--warm-gray);
            border: 2px solid var(--light-gray);
            padding: 0.75rem 1rem;
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--dark-gray);
            cursor: pointer;
            border-radius: 0.5rem;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .category-btn:hover {
            border-color: var(--signature-blue);
            background: rgba(20, 100, 244, 0.05);
            color: var(--signature-blue);
        }

        .category-btn.active {
            background: var(--signature-blue);
            color: var(--primary-white);
            border-color: var(--signature-blue);
            box-shadow: 0 2px 8px rgba(20, 100, 244, 0.3);
        }

        .category-btn.active .dropdown-arrow {
            color: var(--primary-white);
        }

        .dropdown-arrow {
            font-size: 0.7rem;
            transition: transform 0.3s ease, color 0.3s ease;
            margin-left: 0.5rem;
        }

        .category-btn.open .dropdown-arrow {
            transform: rotate(180deg);
        }

        .category-menu {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--primary-white);
            border: 1px solid var(--light-gray);
            border-radius: 0.5rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            max-height: 250px;
            overflow-y: auto;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
        }

        .category-menu.show {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .subcategory-option {
            width: 100%;
            display: block;
            background: transparent;
            border: none;
            padding: 0.75rem 1rem;
            font-size: 0.85rem;
            color: var(--dark-gray);
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
            border-bottom: 1px solid var(--light-gray);
        }

        .subcategory-option:last-child {
            border-bottom: none;
        }

        .subcategory-option:hover {
            background: rgba(20, 100, 244, 0.1);
            color: var(--signature-blue);
        }

        .subcategory-option.active {
            background: var(--signature-blue);
            color: var(--primary-white);
        }

        .exclude-option {
            background: #e0e0e0 !important;
            color: #757575 !important;
            font-weight: 600;
            border-bottom: 2px solid #bdbdbd !important;
        }

        .exclude-option:hover {
            background: #d6d6d6 !important;
            color: #616161 !important;
        }

        .category-btn.excluded {
            background: #f5f5f5 !important;
            color: #9e9e9e !important;
            border-color: #e0e0e0 !important;
            opacity: 0.6;
        }

        .category-btn.excluded .dropdown-arrow {
            color: #9e9e9e !important;
        }

        .category-btn.excluded:hover {
            background: #eeeeee !important;
            color: #757575 !important;
            border-color: #d6d6d6 !important;
        }

        /* Updated Filter Styles - Daichi Style */
        .filter-checkbox {
            width: 18px;
            height: 18px;
            accent-color: var(--signature-blue);
            margin-right: 0.5rem;
            cursor: pointer;
        }

        .filter-item {
            display: flex;
            align-items: center;
            padding: 0.5rem 0;
            border-bottom: 1px solid #f0f0f0;
            transition: background-color 0.2s ease;
        }

        .filter-item:hover {
            background-color: var(--warm-gray);
        }

        .filter-label {
            cursor: pointer;
            font-size: 0.9rem;
            color: var(--deep-graphite);
            user-select: none;
            flex: 1;
        }

        /* Price Range Styles */
        .price-range, .area-range, .capacity-range {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .price-input, .area-input, .capacity-input {
            width: 80px;
            padding: 0.5rem;
            border: 1px solid var(--light-gray);
            border-radius: 4px;
            font-size: 0.85rem;
            text-align: center;
        }

        .price-input:focus, .area-input:focus, .capacity-input:focus {
            border-color: var(--signature-blue);
            outline: none;
        }

        .price-separator, .area-separator, .capacity-separator {
            color: var(--deep-graphite);
            font-weight: 500;
        }

        .area-unit, .capacity-unit {
            font-size: 0.85rem;
            color: #666;
            font-weight: 500;
        }

        /* Price Range Slider */
        .price-range-slider {
            position: relative;
            height: 6px;
            background: var(--light-gray);
            border-radius: 3px;
            margin-top: 0.5rem;
        }

        .range-track {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 100%;
            background: var(--light-gray);
            border-radius: 3px;
        }

        .range-progress {
            position: absolute;
            top: 0;
            left: 20%;
            height: 100%;
            width: 60%;
            background: var(--signature-blue);
            border-radius: 3px;
        }

        /* Clear Filters Button */
        .filter-actions {
            padding: 1rem 0;
            border-top: 1px solid var(--light-gray);
            margin-top: 1rem;
        }

        .clear-filters-btn {
            width: 100%;
            padding: 0.75rem;
            background: var(--warm-gray);
            border: 1px solid var(--light-gray);
            border-radius: 6px;
            color: var(--deep-graphite);
            font-family: inherit;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .clear-filters-btn:hover {
            background: var(--signature-blue);
            color: var(--primary-white);
            border-color: var(--signature-blue);
        }

        /* Horizontal Filters Layout */
        .horizontal-filters {
            background: var(--warm-gray);
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 8px;
            border: 1px solid var(--light-gray);
        }

        .filter-row {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            flex-wrap: wrap;
        }

        .horizontal-filter {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
            min-width: 120px;
        }

        .horizontal-filter label {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--deep-graphite);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .filter-select {
            padding: 0.5rem;
            border: 1px solid var(--light-gray);
            border-radius: 4px;
            font-family: inherit;
            font-size: 0.85rem;
            background: var(--primary-white);
            min-width: 120px;
        }

        .price-range-compact,
        .area-range-compact {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .price-input-compact,
        .area-input-compact {
            width: 60px;
            padding: 0.5rem;
            border: 1px solid var(--light-gray);
            border-radius: 4px;
            font-family: inherit;
            font-size: 0.85rem;
            text-align: center;
        }

        .unit {
            font-size: 0.8rem;
            color: var(--deep-graphite);
            font-weight: 500;
        }

        .clear-filters-btn-compact {
            padding: 0.5rem 1rem;
            background: var(--signature-blue);
            color: var(--primary-white);
            border: none;
            border-radius: 4px;
            font-family: inherit;
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            margin-top: 1rem;
            transition: all 0.2s ease;
        }

        .clear-filters-btn-compact:hover {
            background: #1976d2;
            transform: translateY(-1px);
        }

        .clear-filters-btn-mini {
            background: var(--signature-blue);
            color: white;
            border: none;
            padding: 0.4rem 0.6rem;
            border-radius: 4px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: background-color 0.3s ease;
            min-width: 28px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .clear-filters-btn-mini:hover {
            background: #2563eb;
        }

        .results-count-box {
            padding: 0.5rem 0.75rem;
            border: 1px solid var(--light-gray);
            border-radius: 4px;
            background: var(--primary-white);
            font-size: 0.85rem;
            color: #666;
            min-width: 80px;
            text-align: center;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .clear-filters-btn-square {
            background: var(--signature-blue);
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 1rem;
            cursor: pointer;
            transition: background-color 0.3s ease;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .clear-filters-btn-square:hover {
            background: #2563eb;
        }

        /* Responsive Category Row */
        @media (max-width: 768px) {
            .catalog-categories-row {
                flex-direction: column;
                gap: 0.75rem;
                padding: 0.5rem;
            }

            .category-btn {
                padding: 0.6rem 0.75rem;
                font-size: 0.8rem;
            }

            .category-menu {
                max-height: 200px;
            }

            .subcategory-option {
                padding: 0.5rem 0.75rem;
                font-size: 0.8rem;
            }
        }

            .price-input, .area-input, .capacity-input {
                width: 70px;
                padding: 0.4rem;
            }
        }

        /* Settings Panel */
        .settings-panel {
            background: var(--primary-white);
            border-bottom: 1px solid var(--light-gray);
            padding: 0;
            min-height: 80px;
            display: flex;
            align-items: center;
            transition: all 0.3s ease;
        }

        .settings-panel.brand-hover {
            background: rgba(20, 100, 244, 0.05);
            border-left: 3px solid var(--signature-blue);
        }

        .settings-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 3rem;
            width: 100%;
            padding: 0.75rem 2rem;
        }

        .discount-settings,
        .currency-settings {
            display: flex;
            gap: 2rem;
            align-items: center;
        }

        .setting-group {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .setting-label {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--deep-graphite);
            white-space: nowrap;
        }

        .discount-input,
        .rate-input {
            width: 80px;
            padding: 0.5rem;
            border: 2px solid var(--light-gray);
            border-radius: 6px;
            font-size: 0.9rem;
            text-align: center;
            transition: border-color 0.3s ease;
        }

        .discount-input:focus,
        .rate-input:focus {
            outline: none;
            border-color: var(--signature-blue);
        }

        .currency-select {
            width: 120px;
            padding: 0.5rem;
            border: 2px solid var(--light-gray);
            border-radius: 6px;
            font-size: 0.9rem;
            background: var(--primary-white);
            cursor: pointer;
            transition: border-color 0.3s ease;
        }

        .currency-select:focus {
            outline: none;
            border-color: var(--signature-blue);
        }

        .setting-unit {
            font-size: 0.9rem;
            font-weight: 600;
            color: #666;
        }

        .exchange-rates {
            display: flex;
            gap: 1.5rem;
        }

        .rate-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .rate-label {
            font-size: 0.8rem;
            font-weight: 600;
            color: #666;
            white-space: nowrap;
        }

        .rate-update-btn {
            background: var(--signature-blue);
            color: var(--primary-white);
            border: none;
            border-radius: 4px;
            width: 28px;
            height: 28px;
            cursor: pointer;
            font-size: 0.7rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .rate-update-btn:hover {
            background: var(--deep-graphite);
            transform: scale(1.1);
        }

        /* Responsive Settings Panel */
        @media (max-width: 1200px) {
            .settings-row {
                flex-direction: column;
                gap: 1.5rem;
            }

            .discount-settings,
            .currency-settings {
                width: 100%;
                justify-content: space-between;
            }

            .exchange-rates {
                gap: 1rem;
            }
        }

        @media (max-width: 768px) {
            .settings-panel {
                min-height: auto;
                padding: 0;
            }

            .settings-row {
                padding: 1rem;
                flex-direction: column;
                gap: 1rem;
            }

            .discount-settings,
            .currency-settings {
                width: 100%;
                flex-direction: column;
                gap: 1rem;
                align-items: flex-start;
            }

            .setting-group {
                flex-wrap: wrap;
                gap: 0.5rem;
            }

            .exchange-rates {
                flex-direction: column;
                gap: 0.75rem;
                width: 100%;
            }
        }

        /* Products Layout */
        .products-layout {
            display: grid;
            grid-template-columns: 80px 1fr;
            gap: 0;
            margin-top: 1rem;
        }

        /* Filters Sidebar */
        .filters-sidebar {
            background: var(--warm-gray);
            padding: 1.5rem 1rem;
            border-right: 1px solid var(--light-gray);
        }

        .filter-section {
            margin-bottom: 1.5rem;
        }

        .filter-title {
            font-size: 0.9rem;
            font-weight: 700;
            color: var(--deep-graphite);
            margin-bottom: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .filter-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .filter-checkbox {
            width: 18px;
            height: 18px;
            border: 2px solid var(--light-gray);
            border-radius: 3px;
            cursor: pointer;
            position: relative;
            transition: all 0.3s ease;
        }

        .filter-checkbox.checked {
            background: var(--signature-blue);
            border-color: var(--signature-blue);
        }

        .filter-checkbox.checked::after {
            content: '✓';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 12px;
            font-weight: bold;
        }

        .filter-label {
            font-size: 0.8rem;
            color: #666;
            cursor: pointer;
        }

        .filter-range {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }

        .filter-input {
            width: 60px;
            padding: 0.4rem;
            border: 1px solid var(--light-gray);
            border-radius: 4px;
            font-size: 0.8rem;
        }

        /* Results Area */
        .results-area {
            padding: 1.5rem 1rem;
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .results-count {
            font-size: 0.9rem;
            color: #666;
            font-weight: 500;
        }

        .sort-select {
            padding: 0.5rem 1rem;
            border: 1px solid var(--light-gray);
            border-radius: 6px;
            font-family: inherit;
            font-size: 0.9rem;
            background: var(--primary-white);
        }

        /* Product List */
        .products-grid {
            display: flex;
            flex-direction: column;
            gap: 0;
        }

        /* Original product layout is already defined above in existing CSS */

        .product-card {
            background: var(--primary-white);
            border: 1px solid var(--light-gray);
            border-bottom: none;
            display: flex;
            align-items: center;
            padding: 1rem 1.5rem;
            transition: all 0.3s ease;
            position: relative;
        }

        .product-card:last-child {
            border-bottom: 1px solid var(--light-gray);
        }

        .product-card:hover {
            background: rgba(20, 100, 244, 0.02);
            border-color: var(--signature-blue);
            z-index: 2;
        }

        .product-image {
            width: 80px;
            height: 60px;
            background: var(--warm-gray);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: #999;
            margin-right: 1.5rem;
            border-radius: 6px;
            flex-shrink: 0;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .product-image:hover {
            transform: scale(3);
            z-index: 10;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            border: 2px solid var(--signature-blue);
        }

        .product-info {
            flex: 1;
            display: grid;
            grid-template-columns: 2fr 0.8fr 0.8fr 1fr auto;
            gap: 1rem;
            align-items: center;
        }

        .product-details {
            min-width: 0;
        }

        .product-title {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
            color: var(--deep-graphite);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .product-specs {
            font-size: 0.8rem;
            color: #666;
            line-height: 1.3;
        }

        .product-prices {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
            text-align: right;
        }

        .price-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.8rem;
            gap: 0.5rem;
        }

        .price-label {
            color: #666;
            font-size: 0.7rem;
        }

        .price-value {
            font-weight: 600;
            min-width: 60px;
            text-align: right;
        }

        .price-retail {
            color: #999;
            text-decoration: line-through;
        }

        .price-purchase {
            color: var(--success-green);
        }

        .price-sale {
            color: var(--signature-blue);
            font-size: 0.9rem;
            font-weight: 700;
        }

        .product-capacity {
            text-align: center;
            font-weight: 600;
            color: var(--deep-graphite);
        }

        .capacity-value {
            font-size: 1rem;
        }

        .capacity-label {
            font-size: 0.7rem;
            color: #666;
        }

        /* Stock Availability */
        .product-availability {
            text-align: center;
            min-width: 80px;
        }

        .availability-scale {
            display: flex;
            gap: 2px;
            justify-content: center;
            margin-bottom: 0.25rem;
        }

        .availability-square {
            width: 8px;
            height: 8px;
            border-radius: 2px;
            transition: all 0.3s ease;
        }

        .availability-square.filled {
            opacity: 1;
            background: #4caf50;
        }

        .availability-square.empty {
            opacity: 0.2;
            background: var(--light-gray);
        }

        .availability-square.red {
            background: var(--error-red);
        }

        .availability-square.yellow {
            background: var(--warning-yellow);
        }

        .availability-square.green {
            background: var(--success-green);
        }

        .availability-label {
            font-size: 0.7rem;
            color: #666;
            font-weight: 500;
        }

        .availability-text {
            font-size: 0.65rem;
            color: #666;
            margin-top: 0.15rem;
        }

        .product-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.3rem;
            min-width: 80px;
        }

        .action-btn {
            background: transparent;
            border: none;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 4px;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .capacity-value {
            font-size: 1rem;
        }

        .capacity-label {
            font-size: 0.7rem;
            color: #666;
        }


        /* Stock Availability */
        .product-availability {
            text-align: center;
            min-width: 80px;
        }

        .availability-scale {
            display: flex;
            gap: 2px;
            justify-content: center;
            margin-bottom: 0.25rem;
        }

        .availability-square {
            width: 8px;
            height: 8px;
            border-radius: 2px;
            transition: all 0.3s ease;
        }

        .availability-square.filled {
            opacity: 1;
            background: #4caf50;
        }

        .availability-square.empty {
            opacity: 0.2;
            background: var(--light-gray);
        }

        .availability-square.red {
            background: var(--error-red);
        }

        .availability-square.yellow {
            background: var(--warning-yellow);
        }

        .availability-square.green {
            background: var(--success-green);
        }

        .availability-label {
            font-size: 0.7rem;
            color: #666;
            font-weight: 500;
        }

        .availability-text {
            font-size: 0.65rem;
            color: #666;
            margin-top: 0.15rem;
        }

        .product-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.3rem;
            min-width: 80px;
        }

        .action-btn {
            width: 32px;
            height: 32px;
            border: none;
            background: transparent;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .action-icon {
            font-size: 1rem;
            font-weight: 400;
            color: #9e9e9e;
            transition: all 0.3s ease;
        }

        .action-btn:hover {
            transform: scale(1.1);
        }

        .action-btn:hover .action-icon {
            color: #757575;
        }

        /* Specific button states - Pastel Transparent Active States */
        .btn-select.selected .action-icon {
            color: #2d5a2d;
            transform: scale(1.1);
        }

        .btn-favorite.favorited .action-icon {
            color: #f44336;
            transform: scale(1.1);
        }

        .btn-compare.comparing .action-icon {
            color: #2196f3;
            transform: scale(1.1);
        }

        .btn-details.active .action-icon {
            color: #ff9800;
            transform: scale(1.1);
        }

        /* Tooltip enhancement */
        .action-btn[title]:hover::after {
            content: attr(title);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: var(--deep-graphite);
            color: var(--primary-white);
            padding: 0.5rem 0.75rem;
            border-radius: 4px;
            font-size: 0.7rem;
            white-space: nowrap;
            z-index: 10;
            margin-bottom: 0.5rem;
            opacity: 0;
            animation: fadeInTooltip 0.3s ease-in-out forwards;
        }

        .action-btn[title]:hover::before {
            content: '';
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 4px solid transparent;
            border-top-color: var(--deep-graphite);
            z-index: 10;
            margin-bottom: 0.1rem;
            opacity: 0;
            animation: fadeInTooltip 0.3s ease-in-out forwards;
        }

        @keyframes fadeInTooltip {
            to {
                opacity: 1;
            }
        }

        /* Product Modal */
        .product-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: var(--primary-white);
            border-radius: 12px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            z-index: 1;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem 2rem;
            border-bottom: 1px solid var(--light-gray);
        }

        .modal-header h3 {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--deep-graphite);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 2rem;
            cursor: pointer;
            color: #666;
            transition: color 0.3s ease;
            padding: 0;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-close:hover {
            color: var(--signature-blue);
        }

        .modal-body {
            padding: 2rem;
        }

        .product-image-large {
            width: 150px;
            height: 100px;
            background: var(--warm-gray);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            color: #999;
            border-radius: 8px;
            margin: 0 auto 2rem;
        }

        .product-details-full p {
            margin-bottom: 1rem;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .price-details {
            margin-top: 1.5rem;
            padding-top: 1rem;
            border-top: 1px solid var(--light-gray);
        }

        .price-details p {
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .price-details {
            background: var(--warm-gray);
            padding: 1.5rem;
            border-radius: 8px;
            margin-top: 1.5rem;
        }

        .price-details p {
            margin-bottom: 0.5rem;
            display: flex;
            justify-content: space-between;
        }

        /* Selected Items Panel - Positioned below top navigation */
        .selected-panel {
            position: fixed;
            top: 80px;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.4);
            backdrop-filter: blur(20px);
            color: var(--deep-graphite);
            padding: 1rem 2rem;
            display: none;
            align-items: center;
            justify-content: space-between;
            z-index: 999;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            box-shadow: 0 2px 15px rgba(0, 0, 0, 0.1);
        }

        .selected-panel.active {
            display: flex;
        }

        .selected-info {
            display: flex;
            align-items: center;
            gap: 2rem;
            flex: 1;
            position: relative;
        }

        .selected-count {
            font-size: 1rem;
            font-weight: 600;
            color: var(--deep-graphite);
            opacity: 0.8;
        }

        .selected-total {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--signature-blue);
        }
        
        /* Reset Selection Button */
        .btn-reset-selection {
            background: rgba(244, 67, 54, 0.4);
            color: #d32f2f;
            border: 1px solid rgba(244, 67, 54, 0.6);
            border-radius: 50%;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-left: 1rem;
            backdrop-filter: blur(5px);
        }
        
        .btn-reset-selection:hover {
            background: rgba(244, 67, 54, 0.6);
            border-color: rgba(244, 67, 54, 0.8);
            transform: scale(1.1);
            box-shadow: 0 2px 8px rgba(244, 67, 54, 0.3);
        }
        
        .reset-icon {
            font-size: 0.9rem;
            font-weight: 700;
            line-height: 1;
        }

        .btn-quote {
            background: rgba(20, 100, 244, 0.1);
            color: var(--signature-blue);
            border: 1px solid rgba(20, 100, 244, 0.3);
            padding: 0.6rem 1.5rem;
            border-radius: 20px;
            font-family: inherit;
            font-weight: 600;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
        }

        .btn-quote:hover {
            background: rgba(20, 100, 244, 0.2);
            border-color: rgba(20, 100, 244, 0.5);
            transform: translateY(-1px);
        }

        .btn-request {
            background: rgba(0, 150, 0, 0.1);
            color: var(--success-green);
            border: 1px solid rgba(0, 150, 0, 0.3);
            padding: 0.6rem 1.5rem;
            border-radius: 20px;
            font-family: inherit;
            font-weight: 600;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-left: 0.5rem;
            backdrop-filter: blur(5px);
        }

        .btn-request:hover {
            background: rgba(0, 150, 0, 0.2);
            border-color: rgba(0, 150, 0, 0.5);
            transform: translateY(-1px);
        }

        .btn-catalog {
            background: rgba(255, 140, 0, 0.1);
            color: var(--orange);
            border: 1px solid rgba(255, 140, 0, 0.3);
            padding: 0.6rem 1.5rem;
            border-radius: 20px;
            font-family: inherit;
            font-weight: 600;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-left: 0.5rem;
            backdrop-filter: blur(5px);
        }

        .btn-catalog:hover {
            background: rgba(255, 140, 0, 0.2);
            border-color: rgba(255, 140, 0, 0.5);
            transform: translateY(-1px);
        }

        /* List Header */
        .list-header {
            display: grid;
            grid-template-columns: 80px 2fr 0.8fr 0.8fr 1fr 100px;
            gap: 1rem;
            padding: 0.75rem 1rem;
            background: var(--warm-gray);
            border: 1px solid var(--light-gray);
            font-weight: 600;
            font-size: 0.8rem;
            color: var(--deep-graphite);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .header-cell {
            padding: 0.5rem 0;
        }

        .header-cell.text-center {
            text-align: center;
        }

        .header-cell.text-right {
            text-align: right;
        }

        /* Responsive Design for Products */
        @media (max-width: 1366px) {
            .products-layout {
                grid-template-columns: 70px 1fr;
            }

            .filters-sidebar {
                padding: 1rem 0.75rem;
            }

            .results-area {
                padding: 1rem 0.75rem;
            }
        }

        @media (max-width: 1200px) {
            .product-info {
                grid-template-columns: 2fr 0.8fr 1fr auto;
                gap: 0.75rem;
            }

            .list-header {
                grid-template-columns: 80px 2fr 0.8fr 1fr 100px;
                gap: 0.75rem;
            }

            .product-energy {
                display: none;
            }

            .list-header .header-energy {
                display: none;
            }

            .products-layout {
                grid-template-columns: 60px 1fr;
            }
        }

        @media (max-width: 1024px) {
            .product-info {
                grid-template-columns: 2fr 0.7fr 0.9fr auto;
                gap: 0.5rem;
            }

            .list-header {
                grid-template-columns: 2fr 0.7fr 0.9fr 90px;
                gap: 0.5rem;
            }

            .product-image {
                display: none; /* Hide product icons on mobile */
            }

            .product-actions {
                min-width: 70px;
            }

            .action-btn {
                width: 28px;
                height: 28px;
            }

            .action-icon {
                font-size: 0.8rem;
            }
        }

        @media (max-width: 768px) {
            .products-layout {
                grid-template-columns: 1fr;
            }

            .equipment-sidebar {
                display: none;
            }

            .horizontal-filters .filter-row {
                flex-direction: column;
                align-items: stretch;
                gap: 0.75rem;
            }

            .horizontal-filter {
                min-width: auto;
            }

            .product-info {
                grid-template-columns: 1fr auto;
                gap: 1rem;
            }

            .list-header {
                grid-template-columns: 1fr 120px;
                gap: 1rem;
            }

            .product-capacity,
            .product-prices {
                display: none;
            }

            .header-capacity,
            .header-prices {
                display: none;
            }

            .brand-tabs {
                padding: 0 0.5rem;
                flex-direction: column;
                gap: 1rem;
            }

            .brand-tabs-left {
                order: 1;
            }

            .brand-tabs-right {
                order: 2;
                margin-left: 0;
                justify-content: center;
            }

            .brand-tab {
                padding: 0.75rem 1rem;
                font-size: 0.8rem;
            }

            .selected-panel {
                left: 1rem;
                right: 1rem;
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }

            .product-image {
                display: none; /* Hide product icons on mobile */
            }

            .product-actions {
                min-width: 70px;
            }

            .action-btn {
                width: 30px;
                height: 30px;
            }

            .action-icon {
                font-size: 0.8rem;
            }
        }

        .module-card {
            background: var(--primary-white);
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            border: 1px solid var(--light-gray);
        }

        .module-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            min-width: 0;
        }

        .card-icon {
            font-size: 2rem;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--signature-blue);
            color: var(--primary-white);
            border-radius: 50%;
            flex-shrink: 0;
        }

        .card-title {
            font-size: 1.2rem;
            color: var(--deep-graphite);
            font-weight: 700;
            word-wrap: break-word;
            overflow-wrap: break-word;
            hyphens: auto;
            max-width: 100%;
        }

        .card-description {
            color: #666;
            font-size: 1rem;
            margin-bottom: 1.5rem;
            line-height: 1.5;
            word-wrap: break-word;
            overflow-wrap: break-word;
            hyphens: auto;
            max-width: 100%;
        }

        .card-metrics {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }

        .metric {
            text-align: center;
        }

        .metric-value {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--signature-blue);
            margin-bottom: 0.25rem;
        }

        .metric-label {
            font-size: 0.8rem;
            color: #666;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .card-status {
            display: inline-block;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-top: 1rem;
        }

        .status-active {
            background: rgba(76, 175, 80, 0.1);
            color: var(--success-green);
        }

        .status-development {
            background: rgba(255, 152, 0, 0.1);
            color: var(--warning-yellow);
        }

        .status-planned {
            background: rgba(244, 244, 244, 1);
            color: #666;
        }

        /* Chatbot Section */
        .chatbot-section {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            z-index: 999;
        }

        .chatbot-toggle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--signature-blue);
            color: var(--primary-white);
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 20px rgba(20, 100, 244, 0.3);
        }

        .chatbot-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 25px rgba(20, 100, 244, 0.4);
        }

        .chatbot-window {
            position: absolute;
            bottom: 80px;
            right: 0;
            width: 350px;
            height: 450px;
            background: var(--primary-white);
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
            display: none;
            flex-direction: column;
            overflow: hidden;
        }

        .chatbot-window.active {
            display: flex;
        }

        .chatbot-header {
            background: var(--signature-blue);
            color: var(--primary-white);
            padding: 1rem 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .chatbot-avatar {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: var(--primary-white);
            color: var(--signature-blue);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
        }

        .chatbot-info h3 {
            font-size: 1rem;
            margin-bottom: 0.25rem;
        }

        .chatbot-info p {
            font-size: 0.8rem;
            opacity: 0.8;
            font-weight: 400;
        }

        .chatbot-messages {
            flex: 1;
            padding: 1rem;
            overflow-y: auto;
            background: #f9f9f9;
        }

        .message {
            margin-bottom: 1rem;
            display: flex;
            align-items: flex-start;
            gap: 0.5rem;
        }

        .message.user {
            flex-direction: row-reverse;
        }

        .message-content {
            background: var(--primary-white);
            padding: 0.75rem 1rem;
            border-radius: 18px;
            max-width: 80%;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .message.user .message-content {
            background: var(--signature-blue);
            color: var(--primary-white);
        }

        .chatbot-input {
            display: flex;
            padding: 1rem;
            gap: 0.5rem;
            background: var(--primary-white);
            border-top: 1px solid var(--light-gray);
        }

        .chatbot-input input {
            flex: 1;
            border: 1px solid var(--light-gray);
            border-radius: 20px;
            padding: 0.75rem 1rem;
            font-family: inherit;
            font-size: 0.9rem;
            outline: none;
        }

        .chatbot-input input:focus {
            border-color: var(--signature-blue);
        }

        .send-btn {
            background: var(--signature-blue);
            color: var(--primary-white);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .send-btn:hover {
            background: var(--deep-graphite);
        }

        /* Medium screens - hide some menu items */
        @media (max-width: 1024px) {
            .nav-menu {
                gap: 1rem;
            }
            
            .nav-item {
                font-size: 0.75rem;
            }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .nav {
                padding: 0 1rem;
            }

            .nav-menu {
                display: none;
            }

            .mobile-menu-toggle {
                display: flex;
            }

            .equipment-sidebar {
                display: none;
            }

            .main-content-area {
                margin-left: 0;
            }

            .dashboard-container {
                padding-left: 0.5rem;
                padding-right: 0.5rem;
            }

            .equipment-search {
                width: 100vw;
                margin-left: calc(-50vw + 50%);
            }
            
            .nav-right {
                gap: 1rem;
            }
            
            .profile-icon {
                width: 36px;
                height: 36px;
            }

            .dashboard-container {
                padding-top: 90px;
                padding-left: 0.5rem;
                padding-right: 0.5rem;
            }

            .dashboard-header {
                padding: 1.5rem 1rem;
            }

            .dashboard-title {
                font-size: 1.8rem;
                line-height: 1.2;
                margin-bottom: 0.5rem;
                word-wrap: break-word;
                overflow-wrap: break-word;
            }

            .dashboard-subtitle {
                font-size: 0.9rem;
                line-height: 1.3;
                word-wrap: break-word;
                overflow-wrap: break-word;
            }

            .module-tabs {
                padding: 0 1rem;
            }

            .module-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
                padding: 0 0.5rem;
            }

            .module-card {
                padding: 1rem;
                margin: 0;
            }

            .card-title {
                font-size: 1rem;
                line-height: 1.3;
                word-wrap: break-word;
                overflow-wrap: break-word;
                hyphens: auto;
                text-overflow: ellipsis;
                max-width: 100%;
            }

            .card-description {
                font-size: 0.85rem;
                line-height: 1.4;
                word-wrap: break-word;
                overflow-wrap: break-word;
                hyphens: auto;
                margin-bottom: 1rem;
                max-width: 100%;
            }

            .card-header {
                gap: 0.75rem;
                margin-bottom: 1rem;
                justify-content: space-between;
            }

            .card-icon {
                font-size: 1.5rem;
                min-width: 40px;
                height: 40px;
                flex-shrink: 0;
            }

            .card-metrics {
                gap: 0.75rem;
            }

            .metric {
                padding: 0.5rem;
            }

            .metric-value {
                font-size: 1.2rem;
            }

            .metric-label {
                font-size: 0.7rem;
            }

            .module-tab {
                min-width: 120px;
                min-height: 44px;
                padding: 0.75rem 1rem;
                font-size: 0.8rem;
                touch-action: manipulation;
            }

            /* Enhanced mobile touch targets */
            .ai-search-btn, .ai-chat-send-btn, .send-btn {
                min-height: 44px;
                min-width: 44px;
                touch-action: manipulation;
            }

            .nav-select {
                min-height: 36px;
                padding: 0.4rem 1.4rem 0.4rem 0.6rem;
                font-size: 0.75rem;
                touch-action: manipulation;
            }

            .module-grid {
                grid-template-columns: 1fr;
                padding: 0 1rem;
            }

            .chatbot-window {
                width: 300px;
                height: 400px;
                right: -10px;
            }

            .chatbot-section {
                bottom: 1rem;
                right: 1rem;
            }
        }

        /* Loading Animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid var(--light-gray);
            border-top: 2px solid var(--signature-blue);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes slideIn {
            from { 
                transform: translateX(100%); 
                opacity: 0; 
            }
            to { 
                transform: translateX(0); 
                opacity: 1; 
            }
        }

        @keyframes slideOut {
            from { 
                transform: translateX(0); 
                opacity: 1; 
            }
            to { 
                transform: translateX(100%); 
                opacity: 0; 
            }
        }

        /* Animations */
        .fade-in {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s ease-out;
        }

        .fade-in.visible {
            opacity: 1;
            transform: translateY(0);
        }


        /* Product selection styling from demo - updated for product-card */
        .product-card.selected {
            background: linear-gradient(135deg, rgba(20, 100, 244, 0.08), rgba(20, 100, 244, 0.12)) !important;
            border: 2px solid var(--signature-blue) !important;
            box-shadow: 0 4px 15px rgba(20, 100, 244, 0.25) !important;
            transform: translateY(-2px) !important;
            z-index: 3;
            position: relative;
        }

        
        /* Pastel Transparent Checkmark Styling - 60% Transparency */
        .product-card.selected .action-btn.btn-select.selected {
            background: rgba(144, 238, 144, 0.6) !important;
            color: #2d5a2d !important;
            font-weight: 900 !important;
            font-size: 1.1rem !important;
            transform: scale(1.1);
            box-shadow: 0 2px 8px rgba(144, 238, 144, 0.4);
            border-color: rgba(144, 238, 144, 0.8) !important;
            backdrop-filter: blur(5px);
        }
        
        /* Enhanced action button styling */
        .action-btn.btn-select {
            background: transparent;
            border: 2px solid rgba(221, 221, 221, 0.6);
            color: #666;
            font-weight: 400;
            transition: all 0.3s ease;
        }
        
        .action-btn.btn-select.selected {
            background: rgba(144, 238, 144, 0.6) !important;
            border-color: rgba(144, 238, 144, 0.8) !important;
            color: #2d5a2d !important;
            font-weight: 900 !important;
            font-size: 1.2rem !important;
            transform: scale(1.15) !important;
            box-shadow: 0 3px 10px rgba(144, 238, 144, 0.5) !important;
            backdrop-filter: blur(5px);
        }
        
        .action-btn.btn-select.selected .action-icon {
            font-weight: 900 !important;
            text-shadow: 0 1px 2px rgba(45, 90, 45, 0.3);
        }

        /* Analog product highlighting */
        .product-card.analog-product {
            background: rgba(20, 100, 244, 0.08) !important;
            border-left: 4px solid var(--signature-blue) !important;
            position: relative;
        }
        
        /* Compatibility percentage display under checkmarks */
        .compatibility-percentage {
            position: absolute;
            top: 34px;
            right: 0px;
            background: rgba(144, 238, 144, 0.6);
            color: #2d5a2d;
            font-size: 0.65rem;
            font-weight: 700;
            padding: 1px 4px;
            border-radius: 8px;
            z-index: 5;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
            text-align: center;
            min-width: 24px;
            width: 32px;
            backdrop-filter: blur(5px);
        }

        .product-card.analog-product:hover {
            background: rgba(20, 100, 244, 0.12) !important;
        }

        .product-card.analog-product::before {
            content: '🎯';
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            font-size: 1rem;
            z-index: 5;
        }
        
        /* Make product cards clickable */
        .product-card {
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 0.5rem;
        }
        
        .product-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        /* Enhanced analog highlighting */
        .product-card.analog-product {
            background: linear-gradient(135deg, rgba(20, 100, 244, 0.08), rgba(20, 100, 244, 0.12)) !important;
            border-left: 4px solid var(--signature-blue) !important;
            box-shadow: 0 2px 8px rgba(20, 100, 244, 0.2) !important;
        }

        /* Selection counter styling - hidden */
        .selection-counter {
            display: none !important;
        }
        
        /* Analog separator styling */
        .analog-separator {
            width: 100%;
            margin: 1rem 0;
        }

        /* Success green color variable */
        :root {
            --success-green: #4CAF50;
        }
        
        /* Override product card border for selected state */
        .product-card {
            border: 1px solid #ddd;
        }
        
        /* Selected Panel Buttons - Matte Pastel Translucent Styling */
        .selected-actions {
            display: flex;
            gap: 1.2rem;
            align-items: center;
        }
        
        .selected-panel button {
            background: rgba(255, 255, 255, 0.4);
            color: var(--deep-graphite);
            border: 1px solid rgba(26, 26, 26, 0.15);
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-family: inherit;
            font-weight: 500;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            min-width: 100px;
            backdrop-filter: blur(10px);
        }
        
        .selected-panel button:hover {
            background: rgba(255, 255, 255, 0.6);
            border-color: rgba(26, 26, 26, 0.25);
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        /* Selected Panel Button Styling - Matte Pastel 60% Transparent */
        .btn-quote {
            background: rgba(144, 238, 144, 0.4) !important;
            color: #2d5a2d !important;
            border-color: rgba(144, 238, 144, 0.6) !important;
        }
        
        .btn-quote:hover {
            background: rgba(144, 238, 144, 0.6) !important;
            border-color: rgba(144, 238, 144, 0.8) !important;
        }
        
        .btn-request {
            background: rgba(173, 216, 230, 0.4) !important;
            color: #2c4a5a !important;
            border-color: rgba(173, 216, 230, 0.6) !important;
        }
        
        .btn-request:hover {
            background: rgba(173, 216, 230, 0.6) !important;
            border-color: rgba(173, 216, 230, 0.8) !important;
        }
        
        .btn-catalog {
            background: rgba(255, 218, 185, 0.4) !important;
            color: #5a4a2c !important;
            border-color: rgba(255, 218, 185, 0.6) !important;
        }
        
        .btn-catalog:hover {
            background: rgba(255, 218, 185, 0.6) !important;
            border-color: rgba(255, 218, 185, 0.8) !important;
        }
        

        .match-score-display {
            text-align: center;
        }

        .analog-info {
            margin-bottom: 1rem;
        }

        .products-separator {
            margin: 1rem 0;
        }

        /* Additional styles for brand search integration */
        .scale-dot {
            display: inline-block;
            width: 6px;
            height: 6px;
            background: #ddd;
            border-radius: 50%;
            margin: 0 1px;
        }

        .scale-dot.active {
            background: var(--success-green);
        }

        .availability-text {
            font-size: 0.7rem;
            color: #666;
            text-align: center;
            margin-top: 2px;
        }

        .product-stock {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 0.5rem;
        }

        .no-products {
            grid-column: 1 / -1;
            text-align: center;
            padding: 2rem;
            color: #666;
            font-size: 1.1rem;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="nav">
        <div class="nav-logo">
            <div class="logo-main">
                <div class="hvac-letters">
                    <span class="hvac-letter" data-platform="heating" data-letter="h">H</span>
                    <span class="hvac-letter" data-platform="ventilation" data-letter="v">V</span>
                    <span class="hvac-letter" data-platform="airconditioning" data-letter="ac">AC</span>
                </div>
                <span class="markets-text">MARKETS</span>
            </div>
        </div>
        <div class="nav-menu">
            <a href="#scout" class="nav-item active" data-module="scout" data-en="SEARCH" data-ru="ПОИСК">SEARCH</a>
            <a href="#match" class="nav-item" data-module="match" data-en="ANALYSIS" data-ru="АНАЛИЗ">ANALYSIS</a>
            <a href="quote.html" class="nav-item" data-en="SALES" data-ru="ПРОДАЖА">SALES</a>
            <a href="design.html" class="nav-item" data-en="DESIGN" data-ru="ПРОЕКТ">DESIGN</a>
            <a href="service.html" class="nav-item" data-en="SERVICE" data-ru="СЕРВИС">SERVICE</a>
            <a href="forecast.html" class="nav-item" data-en="FORECAST" data-ru="ПРОГНОЗ">FORECAST</a>
            <a href="installation.html" class="nav-item" data-en="INSTALLATION" data-ru="МОНТАЖ">INSTALLATION</a>
        </div>
        <div class="nav-right">
            <!-- AI Search Button -->
            <button class="nav-icon" id="searchBtn" title="AI Search / ИИ Поиск">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
                </svg>
            </button>
            
            <!-- Personal Account -->
            <a href="account.html" class="profile-icon" title="Personal Account / Личный кабинет">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                </svg>
            </a>
            
            <!-- Quote Cart -->
            <button class="nav-icon" id="cartBtn" title="Quote Cart - Click to view multi-brand quote / Корзина КП - Нажмите для просмотра многобрендового КП">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M7 18c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12L8.1 13h7.45c.75 0 1.41-.41 1.75-1.03L21.7 4H5.21l-.94-2H1zm16 16c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"/>
                </svg>
                <span class="cart-badge" id="cartBadge">0</span>
            </button>
            
            <!-- Language Selection Dropdown -->
            <div class="nav-dropdown">
                <select class="nav-select" id="languageSelect">
                    <option value="en" selected>EN</option>
                    <option value="ru">RU</option>
                </select>
            </div>
            
            <!-- Currency Selection Dropdown -->
            <div class="nav-dropdown">
                <select class="nav-select" id="currencySelect">
                    <option value="usd" selected>USD ($)</option>
                    <option value="rub">RUB (₽)</option>
                    <option value="eur">EUR (€)</option>
                </select>
            </div>
            
            
            <button class="mobile-menu-toggle" id="mobileMenuToggle">
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
            </button>
        </div>
    </nav>

    <!-- Mobile Menu -->
    <div class="mobile-menu" id="mobileMenu">
        <div class="mobile-menu-content">
            <a href="#scout" class="mobile-menu-item" data-module="scout" data-en="SEARCH" data-ru="ПОИСК">SEARCH</a>
            <a href="#match" class="mobile-menu-item" data-module="match" data-en="ANALYSIS" data-ru="АНАЛИЗ">ANALYSIS</a>
            <a href="quote.html" class="mobile-menu-item" data-en="SALES" data-ru="ПРОДАЖА">SALES</a>
            <a href="design.html" class="mobile-menu-item" data-en="DESIGN" data-ru="ПРОЕКТ">DESIGN</a>
            <a href="service.html" class="mobile-menu-item" data-en="SERVICE" data-ru="СЕРВИС">SERVICE</a>
            <a href="forecast.html" class="mobile-menu-item" data-en="FORECAST" data-ru="ПРОГНОЗ">FORECAST</a>
            <a href="installation.html" class="mobile-menu-item" data-en="INSTALLATION" data-ru="МОНТАЖ">INSTALLATION</a>
        </div>
    </div>

    <!-- Dashboard Container -->
    <div class="dashboard-container">

        <!-- Main Content Area -->
        <div class="main-content-area">
            <!-- Search Module -->
            <div class="module-content active" data-content="scout" id="scout">
            <!-- Scout Sub-tabs -->

            <!-- Product Search System -->
            <div class="scout-content active" data-scout-content="product-search">
                <!-- Equipment Search Block -->
                <div class="equipment-search">
                    <div class="search-header">
                        <div class="header-content">
                            <div class="header-text">
                                <h2 class="search-title" data-en="Equipment Search & Selection" data-ru="Поиск и подбор оборудования">Поиск и подбор оборудования</h2>
                            </div>
                        </div>
                    </div>


                <!-- Brand Tabs with Client Discount -->
                <div class="brand-tabs">
                    <div class="brand-tabs-left">
                        <button class="brand-tab active" data-brand="daikin">Daikin</button>
                        <button class="brand-tab" data-brand="mitsubishi">Mitsubishi</button>
                        <button class="brand-tab" data-brand="lg">LG</button>
                        <button class="brand-tab" data-brand="panasonic">Panasonic</button>
                        <button class="brand-tab" data-brand="toshiba">Toshiba</button>
                        <button class="brand-tab" data-brand="fujitsu">Fujitsu</button>
                        <button class="brand-tab" data-brand="carrier">Carrier</button>
                        <button class="brand-tab" data-brand="york">York</button>
                        <button class="brand-tab" data-brand="trane">Trane</button>
                        <button class="brand-tab" data-brand="lennox">Lennox</button>
                    </div>
                    <div class="brand-tabs-right">
                        <div class="setting-group">
                            <label class="setting-label" data-en="Client Discount:" data-ru="Скидка клиента:">Client Discount:</label>
                            <input type="number" class="discount-input" id="clientDiscount" placeholder="0" min="0" max="100" step="0.1">
                            <span class="setting-unit">%</span>
                        </div>
                    </div>
                </div>


                <!-- Horizontal Filters -->
                <div class="horizontal-filters">
                    <div class="filter-row">
                        <!-- Price Range Filter -->
                        <div class="horizontal-filter">
                            <label class="filter-label" data-en="Price" data-ru="Цена">Price</label>
                            <div class="price-range-compact">
                                <input type="number" class="price-input-compact" id="priceFromH" placeholder="0" />
                                <span>—</span>
                                <input type="number" class="price-input-compact" id="priceToH" placeholder="50000" />
                            </div>
                        </div>

                        <!-- Technology Filter -->
                        <div class="horizontal-filter">
                            <label class="filter-label" data-en="Technology" data-ru="Технология">Technology</label>
                            <select class="filter-select" id="technologyFilter">
                                <option value="" data-en="All" data-ru="Все">All</option>
                                <option value="full-dc-inverter" data-en="Full DC Inverter" data-ru="Full DC Инвертор">Full DC Inverter</option>
                                <option value="inverter" data-en="Inverter" data-ru="Инвертор">Inverter</option>
                                <option value="on-off" data-en="On/Off" data-ru="Вкл/Выкл">On/Off</option>
                            </select>
                        </div>

                        <!-- Room Area Filter -->
                        <div class="horizontal-filter">
                            <label class="filter-label" data-en="Room Area" data-ru="Площадь">Room Area</label>
                            <div class="area-range-compact">
                                <input type="number" class="area-input-compact" id="areaFromH" placeholder="10" />
                                <span>—</span>
                                <input type="number" class="area-input-compact" id="areaToH" placeholder="200" />
                                <span class="unit">м²</span>
                            </div>
                        </div>

                        <!-- Wi-Fi Management Filter -->
                        <div class="horizontal-filter">
                            <label class="filter-label" data-en="Wi-Fi" data-ru="Wi-Fi">Wi-Fi</label>
                            <select class="filter-select" id="wifiFilter">
                                <option value="" data-en="All" data-ru="Все">All</option>
                                <option value="yes" data-en="Yes" data-ru="Да">Yes</option>
                                <option value="no" data-en="No" data-ru="Нет">No</option>
                            </select>
                        </div>

                        <!-- Color Filter -->
                        <div class="horizontal-filter">
                            <label class="filter-label" data-en="Color" data-ru="Цвет">Color</label>
                            <select class="filter-select">
                                <option value="" data-en="All" data-ru="Все">All</option>
                                <option value="white" data-en="White" data-ru="Белый">White</option>
                                <option value="black" data-en="Black" data-ru="Черный">Black</option>
                                <option value="silver" data-en="Silver" data-ru="Серебряный">Silver</option>
                            </select>
                        </div>

                        <!-- Results Count -->
                        <div class="horizontal-filter">
                            <label class="filter-label" data-en="Found" data-ru="Найдено">Found</label>
                            <div class="results-count-box" data-en="247 products" data-ru="247 товаров">247 products</div>
                        </div>

                        <!-- Sort Selection -->
                        <div class="horizontal-filter">
                            <label class="filter-label" data-en="Sort" data-ru="Сорт.">Sort</label>
                            <select class="filter-select sort-select">
                                <option data-en="Price" data-ru="Цена">Price</option>
                                <option data-en="Rating" data-ru="Рейтинг">Rating</option>
                                <option data-en="Capacity" data-ru="Мощность">Capacity</option>
                            </select>
                        </div>

                        <!-- Clear Filters Button -->
                        <div class="horizontal-filter">
                            <button class="clear-filters-btn-square" onclick="clearAllFilters()" title="Clear filters">✕</button>
                        </div>
                    </div>
                </div>

                <!-- Products Layout with Sidebar and List -->
                <div class="products-layout">
                    <!-- Equipment Type Sidebar -->
                    <div class="equipment-sidebar">
                        <!-- Air Conditioning Equipment -->
                        <div class="equipment-type-item active" data-subcategory="split-systems">
                            <div class="equipment-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                    <rect x="2" y="8" width="8" height="6" rx="1"/>
                                    <rect x="14" y="8" width="8" height="6" rx="1"/>
                                    <path d="m10 11 4 0"/>
                                    <path d="M6 8V6a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v2"/>
                                    <path d="M6 14v2a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2v-2"/>
                                </svg>
                            </div>
                            <div class="equipment-tooltip" data-en="Split Systems" data-ru="Сплит-системы">Split Systems</div>
                        </div>
                        <div class="equipment-type-item" data-subcategory="multi-split">
                            <div class="equipment-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                    <rect x="2" y="6" width="6" height="4" rx="1"/>
                                    <rect x="2" y="14" width="6" height="4" rx="1"/>
                                    <rect x="16" y="10" width="6" height="4" rx="1"/>
                                    <path d="m8 8 8 4"/>
                                    <path d="m8 16 8-4"/>
                                    <circle cx="13" cy="12" r="1" fill="currentColor"/>
                                </svg>
                            </div>
                            <div class="equipment-tooltip" data-en="Multi-Split" data-ru="Мульти-сплит">Multi-Split</div>
                        </div>
                        <div class="equipment-type-item" data-subcategory="vrf">
                            <div class="equipment-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                    <rect x="9" y="2" width="6" height="4" rx="1"/>
                                    <rect x="2" y="9" width="4" height="6" rx="1"/>
                                    <rect x="18" y="9" width="4" height="6" rx="1"/>
                                    <rect x="9" y="18" width="6" height="4" rx="1"/>
                                    <path d="m9 6 0 3"/>
                                    <path d="m15 6 0 3"/>
                                    <path d="m6 9 3 0"/>
                                    <path d="m6 15 3 0"/>
                                    <path d="m15 9 3 0"/>
                                    <path d="m15 15 3 0"/>
                                    <path d="m9 15 0 3"/>
                                    <path d="m15 15 0 3"/>
                                    <circle cx="12" cy="12" r="2"/>
                                </svg>
                            </div>
                            <div class="equipment-tooltip" data-en="VRF Systems" data-ru="VRF системы">VRF Systems</div>
                        </div>
                        <div class="equipment-type-item" data-subcategory="accessories">
                            <div class="equipment-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                    <circle cx="12" cy="12" r="3"/>
                                    <path d="m12 1 0 6"/>
                                    <path d="m12 17 0 6"/>
                                    <path d="m1 12 6 0"/>
                                    <path d="m17 12 6 0"/>
                                    <path d="m4.22 4.22 4.24 4.24"/>
                                    <path d="m15.54 15.54 4.24 4.24"/>
                                    <path d="m4.22 19.78 4.24-4.24"/>
                                    <path d="m15.54 8.46 4.24-4.24"/>
                                </svg>
                            </div>
                            <div class="equipment-tooltip" data-en="AC Accessories" data-ru="Аксессуары">AC Accessories</div>
                        </div>
                        
                        <!-- Ventilation Equipment -->
                        <div class="equipment-type-item" data-subcategory="supply-ventilation">
                            <div class="equipment-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                    <rect x="3" y="8" width="8" height="8" rx="1"/>
                                    <path d="m11 12 6 0"/>
                                    <path d="m14 9 3 3-3 3"/>
                                    <path d="M6 11v2"/>
                                    <path d="M8 11v2"/>
                                </svg>
                            </div>
                            <div class="equipment-tooltip" data-en="Supply Ventilation" data-ru="Приточная вентиляция">Supply Ventilation</div>
                        </div>
                        <div class="equipment-type-item" data-subcategory="exhaust-ventilation">
                            <div class="equipment-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                    <rect x="13" y="8" width="8" height="8" rx="1"/>
                                    <path d="m7 12 6 0"/>
                                    <path d="m10 9-3 3 3 3"/>
                                    <path d="M16 11v2"/>
                                    <path d="M18 11v2"/>
                                </svg>
                            </div>
                            <div class="equipment-tooltip" data-en="Exhaust Ventilation" data-ru="Вытяжная вентиляция">Exhaust Ventilation</div>
                        </div>
                        <div class="equipment-type-item" data-subcategory="heat-recovery">
                            <div class="equipment-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                    <rect x="3" y="6" width="18" height="12" rx="2"/>
                                    <path d="M7 10h4l2 4h4"/>
                                    <path d="M17 14h-4l-2-4H7"/>
                                    <path d="m1 10 2 0"/>
                                    <path d="m1 14 2 0"/>
                                    <path d="m21 10 2 0"/>
                                    <path d="m21 14 2 0"/>
                                </svg>
                            </div>
                            <div class="equipment-tooltip" data-en="Heat Recovery" data-ru="Рекуперация">Heat Recovery</div>
                        </div>
                        <div class="equipment-type-item" data-subcategory="air-handling">
                            <div class="equipment-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                    <rect x="2" y="6" width="20" height="12" rx="2"/>
                                    <rect x="6" y="9" width="3" height="6" rx="0.5"/>
                                    <rect x="11" y="9" width="3" height="6" rx="0.5"/>
                                    <rect x="16" y="9" width="3" height="6" rx="0.5"/>
                                    <path d="M2 12h2"/>
                                    <path d="M20 12h2"/>
                                </svg>
                            </div>
                            <div class="equipment-tooltip" data-en="Air Handling Units" data-ru="Приточные установки">Air Handling Units</div>
                        </div>
                        <div class="equipment-type-item" data-subcategory="fans">
                            <div class="equipment-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                    <circle cx="12" cy="12" r="9"/>
                                    <circle cx="12" cy="12" r="2"/>
                                    <path d="M12 2v4"/>
                                    <path d="M12 18v4"/>
                                    <path d="M2 12h4"/>
                                    <path d="M18 12h4"/>
                                    <path d="m6.34 6.34 2.83 2.83"/>
                                    <path d="m14.83 14.83 2.83 2.83"/>
                                    <path d="m6.34 17.66 2.83-2.83"/>
                                    <path d="m14.83 9.17 2.83-2.83"/>
                                </svg>
                            </div>
                            <div class="equipment-tooltip" data-en="Fans" data-ru="Вентиляторы">Fans</div>
                        </div>
                        
                        <!-- Heating Equipment -->
                        <div class="equipment-type-item" data-subcategory="heat-pumps">
                            <div class="equipment-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                    <rect x="4" y="6" width="16" height="12" rx="2"/>
                                    <circle cx="12" cy="12" r="3"/>
                                    <path d="M8 9h8"/>
                                    <path d="M8 15h8"/>
                                    <path d="M12 2v2"/>
                                    <path d="M12 20v2"/>
                                    <path d="M2 12h2"/>
                                    <path d="M20 12h2"/>
                                </svg>
                            </div>
                            <div class="equipment-tooltip" data-en="Heat Pumps" data-ru="Тепловые насосы">Heat Pumps</div>
                        </div>
                        <div class="equipment-type-item" data-subcategory="boilers">
                            <div class="equipment-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                    <rect x="6" y="4" width="12" height="16" rx="2"/>
                                    <circle cx="12" cy="10" r="2"/>
                                    <path d="M9 16h6"/>
                                    <path d="M10 16v2"/>
                                    <path d="M14 16v2"/>
                                    <path d="M12 2v2"/>
                                    <path d="M12 20v2"/>
                                </svg>
                            </div>
                            <div class="equipment-tooltip" data-en="Boilers" data-ru="Котлы">Boilers</div>
                        </div>
                        <div class="equipment-type-item" data-subcategory="radiators">
                            <div class="equipment-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                    <rect x="4" y="8" width="2" height="8"/>
                                    <rect x="7" y="8" width="2" height="8"/>
                                    <rect x="10" y="8" width="2" height="8"/>
                                    <rect x="13" y="8" width="2" height="8"/>
                                    <rect x="16" y="8" width="2" height="8"/>
                                    <path d="M2 10h20"/>
                                    <path d="M2 14h20"/>
                                </svg>
                            </div>
                            <div class="equipment-tooltip" data-en="Radiators" data-ru="Радиаторы">Radiators</div>
                        </div>
                        <div class="equipment-type-item" data-subcategory="floor-heating">
                            <div class="equipment-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                    <rect x="2" y="18" width="20" height="3" rx="1"/>
                                    <path d="M4 18c0-1 0-2 1-3s2-1 3-1 2 0 3 1 1 2 1 3"/>
                                    <path d="M12 18c0-1 0-2 1-3s2-1 3-1 2 0 3 1 1 2 1 3"/>
                                    <path d="M6 8v6"/>
                                    <path d="M10 5v9"/>
                                    <path d="M14 8v6"/>
                                    <path d="M18 5v9"/>
                                </svg>
                            </div>
                            <div class="equipment-tooltip" data-en="Floor Heating" data-ru="Теплый пол">Floor Heating</div>
                        </div>
                        <div class="equipment-type-item" data-subcategory="heat-exchangers">
                            <div class="equipment-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                    <rect x="3" y="8" width="18" height="8" rx="1"/>
                                    <path d="M7 12h10"/>
                                    <path d="M9 10v4"/>
                                    <path d="M12 10v4"/>
                                    <path d="M15 10v4"/>
                                    <path d="M3 10h-2"/>
                                    <path d="M3 14h-2"/>
                                    <path d="M21 10h2"/>
                                    <path d="M21 14h2"/>
                                </svg>
                            </div>
                            <div class="equipment-tooltip" data-en="Heat Exchangers" data-ru="Теплообменники">Heat Exchangers</div>
                        </div>
                    </div>

                    <!-- Results Area -->
                <div class="results-area">

                        <!-- List Header -->
                        <div class="list-header">
                            <div class="header-cell"></div>
                            <div class="header-cell" data-en="Product" data-ru="Товар">Product</div>
                            <div class="header-cell text-center header-capacity" data-en="Capacity" data-ru="Мощность">Capacity</div>
                            <div class="header-cell text-center header-energy" data-en="Stock" data-ru="Наличие">Stock</div>
                            <div class="header-cell text-right header-prices" data-en="Prices" data-ru="Цены">Prices</div>
                            <div class="header-cell text-center" data-en="Actions" data-ru="Действия">Actions</div>
                        </div>

                        <!-- Products List -->
                        <div class="products-grid" id="productsGrid">
                            <!-- Sample products will be generated by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>
            </div>

        </div>

        <!-- Analysis Module -->
        <div class="module-content" data-content="match" id="match">
            <!-- Analysis Sub-tabs -->
            <div class="scout-tabs">
                <button class="scout-tab active" data-scout-module="configuration" data-en="Configuration Engine" data-ru="Движок конфигураций">Configuration Engine</button>
                <button class="scout-tab" data-scout-module="smart-search" data-en="Smart AI Search" data-ru="Умный поиск ИИ">Smart AI Search</button>
                <button class="scout-tab" data-scout-module="analytics" data-en="Analytics Overview" data-ru="Аналитический обзор">Analytics Overview</button>
            </div>

            <!-- Configuration Engine -->
            <div class="scout-content active" data-scout-content="configuration">
                <div class="module-grid">
                <div class="module-card">
                    <div class="card-header">
                        <div class="card-icon">📈</div>
                        <div>
                            <h3 class="card-title" data-en="Configuration Engine" data-ru="Движок конфигураций">Configuration Engine</h3>
                        </div>
                    </div>
                    <p class="card-description" data-en="Optimal HVAC system configuration based on client requirements" data-ru="Оптимальная конфигурация HVAC систем на основе требований клиента">Optimal HVAC system configuration based on client requirements</p>
                    <div class="card-metrics">
                        <div class="metric">
                            <div class="metric-value">3,247</div>
                            <div class="metric-label" data-en="Configurations" data-ru="Конфигураций">Configurations</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">91%</div>
                            <div class="metric-label" data-en="Match Rate" data-ru="Уровень совпадений">Match Rate</div>
                        </div>
                    </div>
                    <div class="card-status status-active" data-en="Active" data-ru="Активно">Active</div>
                </div>

                <div class="module-card">
                    <div class="card-header">
                        <div class="card-icon">⚡</div>
                        <div>
                            <h3 class="card-title" data-en="Real-time Matching" data-ru="Сопоставление в реальном времени">Real-time Matching</h3>
                        </div>
                    </div>
                    <p class="card-description" data-en="Instant equipment matching with project requirements" data-ru="Мгновенное сопоставление оборудования с требованиями проекта">Instant equipment matching with project requirements</p>
                    <div class="card-metrics">
                        <div class="metric">
                            <div class="metric-value">1.2s</div>
                            <div class="metric-label" data-en="Avg Time" data-ru="Среднее время">Avg Time</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">99%</div>
                            <div class="metric-label" data-en="Success Rate" data-ru="Успешность">Success Rate</div>
                        </div>
                    </div>
                    <div class="card-status status-active" data-en="Active" data-ru="Активно">Active</div>
                </div>

                <div class="module-card">
                    <div class="card-header">
                        <div class="card-icon">🎯</div>
                        <div>
                            <h3 class="card-title" data-en="Optimization AI" data-ru="ИИ Оптимизация">Optimization AI</h3>
                        </div>
                    </div>
                    <p class="card-description" data-en="AI for energy efficiency and cost optimization" data-ru="ИИ для оптимизации энергоэффективности и стоимости">AI for energy efficiency and cost optimization</p>
                    <div class="card-metrics">
                        <div class="metric">
                            <div class="metric-value">25%</div>
                            <div class="metric-label" data-en="Savings" data-ru="Экономия">Savings</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">847</div>
                            <div class="metric-label" data-en="Optimizations" data-ru="Оптимизаций">Optimizations</div>
                        </div>
                    </div>
                    <div class="card-status status-development" data-en="Development" data-ru="Разработка">Development</div>
                </div>
            </div>

            <!-- Smart AI Search -->
            <div class="scout-content" data-scout-content="smart-search">
                <div class="smart-search-block">
                    <div class="search-header">
                        <div class="header-content">
                            <div class="header-text">
                                <h2 class="search-title" data-en="Smart AI Search Engine" data-ru="Умный поиск ИИ">Smart AI Search Engine</h2>
                                <p class="search-subtitle" data-en="Natural language processing for HVAC equipment discovery" data-ru="Обработка естественного языка для поиска HVAC оборудования">Natural language processing for HVAC equipment discovery</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- AI Search Interface -->
                    <div class="ai-search-interface">
                        <div class="ai-chat-container">
                            <div class="ai-chat-messages" id="aiChatMessages">
                                <div class="ai-message">
                                    <div class="ai-avatar">🤖</div>
                                    <div class="ai-message-content" data-en="Hello! I can help you find HVAC equipment using natural language. Try asking: 'Find quiet split systems with heating for a 25m² room'" data-ru="Привет! Я помогу найти HVAC оборудование через естественный язык. Попробуйте спросить: 'Найди тихие сплит-системы с обогревом для комнаты 25м²'">Hello! I can help you find HVAC equipment using natural language. Try asking: 'Find quiet split systems with heating for a 25m² room'</div>
                                </div>
                            </div>
                            <div class="ai-chat-input">
                                <input type="text" class="ai-chat-input-field" id="aiChatInput" placeholder="Ask me anything about HVAC equipment..." data-en-placeholder="Ask me anything about HVAC equipment..." data-ru-placeholder="Спросите меня о HVAC оборудовании...">
                                <button class="ai-chat-send-btn" id="aiChatSendBtn">➤</button>
                            </div>
                        </div>
                    </div>

                    <!-- AI Features Cards -->
                    <div class="module-grid">
                        <div class="module-card">
                            <div class="card-header">
                                <div class="card-icon">🧠</div>
                                <div>
                                    <h3 class="card-title" data-en="Natural Language Processing" data-ru="Обработка естественного языка">Natural Language Processing</h3>
                                </div>
                            </div>
                            <p class="card-description" data-en="Advanced NLP algorithms understand complex queries in multiple languages" data-ru="Продвинутые NLP алгоритмы понимают сложные запросы на нескольких языках">Advanced NLP algorithms understand complex queries in multiple languages</p>
                            <div class="card-metrics">
                                <div class="metric">
                                    <div class="metric-value">97%</div>
                                    <div class="metric-label" data-en="Accuracy" data-ru="Точность">Accuracy</div>
                                </div>
                                <div class="metric">
                                    <div class="metric-value">15+</div>
                                    <div class="metric-label" data-en="Languages" data-ru="Языков">Languages</div>
                                </div>
                            </div>
                            <div class="card-status status-active" data-en="Active" data-ru="Активно">Active</div>
                        </div>

                        <div class="module-card">
                            <div class="card-header">
                                <div class="card-icon">🎯</div>
                                <div>
                                    <h3 class="card-title" data-en="Contextual Understanding" data-ru="Контекстное понимание">Contextual Understanding</h3>
                                </div>
                            </div>
                            <p class="card-description" data-en="AI understands context, preferences, and technical requirements" data-ru="ИИ понимает контекст, предпочтения и технические требования">AI understands context, preferences, and technical requirements</p>
                            <div class="card-metrics">
                                <div class="metric">
                                    <div class="metric-value">1.2s</div>
                                    <div class="metric-label" data-en="Response Time" data-ru="Время ответа">Response Time</div>
                                </div>
                                <div class="metric">
                                    <div class="metric-value">89%</div>
                                    <div class="metric-label" data-en="Satisfaction" data-ru="Удовлетворенность">Satisfaction</div>
                                </div>
                            </div>
                            <div class="card-status status-active" data-en="Active" data-ru="Активно">Active</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Analytics Overview -->
            <div class="scout-content" data-scout-content="analytics">
                <div class="analytics-block">
                    <div class="search-header">
                        <div class="header-content">
                            <div class="header-text">
                                <h2 class="search-title" data-en="Analytics Overview" data-ru="Аналитический обзор">Analytics Overview</h2>
                                <p class="search-subtitle" data-en="Advanced analytics and performance monitoring for search systems" data-ru="Продвинутая аналитика и мониторинг производительности поисковых систем">Advanced analytics and performance monitoring for search systems</p>
                            </div>
                        </div>
                    </div>

                    <!-- Analytics Charts -->
                    <div class="analytics-charts">
                        <div class="chart-container">
                            <div class="chart-header">
                                <h3 data-en="Search Performance" data-ru="Производительность поиска">Search Performance</h3>
                            </div>
                            <div class="chart-placeholder">
                                <div class="chart-mock">
                                    <div class="chart-bar" style="height: 60%"></div>
                                    <div class="chart-bar" style="height: 80%"></div>
                                    <div class="chart-bar" style="height: 45%"></div>
                                    <div class="chart-bar" style="height: 95%"></div>
                                    <div class="chart-bar" style="height: 70%"></div>
                                    <div class="chart-bar" style="height: 85%"></div>
                                    <div class="chart-bar" style="height: 65%"></div>
                                </div>
                                <p class="chart-label" data-en="Daily search requests" data-ru="Ежедневные поисковые запросы">Daily search requests</p>
                            </div>
                        </div>
                        
                        <div class="chart-container">
                            <div class="chart-header">
                                <h3 data-en="Popular Categories" data-ru="Популярные категории">Popular Categories</h3>
                            </div>
                            <div class="chart-placeholder">
                                <div class="pie-chart-mock">
                                    <div class="pie-section" style="--percentage: 35%; --color: var(--signature-blue);" data-label="Split Systems 35%"></div>
                                    <div class="pie-section" style="--percentage: 25%; --color: var(--success-green);" data-label="Multi Split 25%"></div>
                                    <div class="pie-section" style="--percentage: 20%; --color: var(--orange);" data-label="VRF 20%"></div>
                                    <div class="pie-section" style="--percentage: 20%; --color: var(--lemon);" data-label="Central AC 20%"></div>
                                </div>
                                <p class="chart-label" data-en="Equipment type distribution" data-ru="Распределение типов оборудования">Equipment type distribution</p>
                            </div>
                        </div>
                    </div>

                    <!-- Analytics Stats Cards -->
                    <div class="module-grid">
                        <div class="module-card">
                            <div class="card-header">
                                <div class="card-icon">📊</div>
                                <div>
                                    <h3 class="card-title" data-en="Performance Monitoring" data-ru="Мониторинг производительности">Performance Monitoring</h3>
                                </div>
                            </div>
                            <p class="card-description" data-en="Real-time monitoring of search performance and system health" data-ru="Мониторинг производительности поиска и состояния системы в реальном времени">Real-time monitoring of search performance and system health</p>
                            <div class="card-metrics">
                                <div class="metric">
                                    <div class="metric-value">127</div>
                                    <div class="metric-label" data-en="Reports" data-ru="Отчетов">Reports</div>
                                </div>
                                <div class="metric">
                                    <div class="metric-value">98%</div>
                                    <div class="metric-label" data-en="Uptime" data-ru="Время работы">Uptime</div>
                                </div>
                            </div>
                            <div class="card-status status-active" data-en="Active" data-ru="Активно">Active</div>
                        </div>

                        <div class="module-card">
                            <div class="card-header">
                                <div class="card-icon">📈</div>
                                <div>
                                    <h3 class="card-title" data-en="Usage Analytics" data-ru="Аналитика использования">Usage Analytics</h3>
                                </div>
                            </div>
                            <p class="card-description" data-en="Detailed analytics on search patterns and user behavior" data-ru="Детальная аналитика паттернов поиска и поведения пользователей">Detailed analytics on search patterns and user behavior</p>
                            <div class="card-metrics">
                                <div class="metric">
                                    <div class="metric-value">2.4k</div>
                                    <div class="metric-label" data-en="Daily Queries" data-ru="Запросов/день">Daily Queries</div>
                                </div>
                                <div class="metric">
                                    <div class="metric-value">94%</div>
                                    <div class="metric-label" data-en="Success Rate" data-ru="Успешность">Success Rate</div>
                                </div>
                            </div>
                            <div class="card-status status-active" data-en="Active" data-ru="Активно">Active</div>
                        </div>

                        <div class="module-card">
                            <div class="card-header">
                                <div class="card-icon">🔧</div>
                                <div>
                                    <h3 class="card-title" data-en="System Optimization" data-ru="Оптимизация системы">System Optimization</h3>
                                </div>
                            </div>
                            <p class="card-description" data-en="AI-driven optimization recommendations for better search performance" data-ru="Рекомендации по оптимизации на основе ИИ для улучшения производительности поиска">AI-driven optimization recommendations for better search performance</p>
                            <div class="card-metrics">
                                <div class="metric">
                                    <div class="metric-value">15%</div>
                                    <div class="metric-label" data-en="Improvement" data-ru="Улучшение">Improvement</div>
                                </div>
                                <div class="metric">
                                    <div class="metric-value">0.8s</div>
                                    <div class="metric-label" data-en="Avg Response" data-ru="Ср. ответ">Avg Response</div>
                                </div>
                            </div>
                            <div class="card-status status-development" data-en="Development" data-ru="Разработка">Development</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sales Module -->
        <div class="module-content" data-content="negotiator" id="negotiator">
            <div class="module-grid">
                <div class="module-card">
                    <div class="card-header">
                        <div class="card-icon">💰</div>
                        <div>
                            <h3 class="card-title" data-en="Dynamic Pricing" data-ru="Динамическое ценообразование">Dynamic Pricing</h3>
                        </div>
                    </div>
                    <p class="card-description">Динамическое ценообразование с учетом рыночных условий</p>
                    <div class="card-metrics">
                        <div class="metric">
                            <div class="metric-value">$2.4M</div>
                            <div class="metric-label" data-en="Volume" data-ru="Объем">Volume</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">18%</div>
                            <div class="metric-label" data-en="Margin +" data-ru="Маржа +">Margin +</div>
                        </div>
                    </div>
                    <div class="card-status status-planned" data-en="Planned" data-ru="Запланировано">Planned</div>
                </div>

                <div class="module-card">
                    <div class="card-header">
                        <div class="card-icon">🤝</div>
                        <div>
                            <h3 class="card-title" data-en="Negotiation Bot" data-ru="Бот переговоров">Negotiation Bot</h3>
                        </div>
                    </div>
                    <p class="card-description">Автоматизированные переговоры с поставщиками</p>
                    <div class="card-metrics">
                        <div class="metric">
                            <div class="metric-value">127</div>
                            <div class="metric-label" data-en="Deals" data-ru="Сделок">Deals</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">92%</div>
                            <div class="metric-label" data-en="Success" data-ru="Успешно">Success</div>
                        </div>
                    </div>
                    <div class="card-status status-planned" data-en="Planned" data-ru="Запланировано">Planned</div>
                </div>

                <div class="module-card">
                    <div class="card-header">
                        <div class="card-icon">📋</div>
                        <div>
                            <h3 class="card-title" data-en="Quote Generator" data-ru="Генератор КП">Quote Generator</h3>
                        </div>
                    </div>
                    <p class="card-description">Автоматическая генерация коммерческих предложений</p>
                    <div class="card-metrics">
                        <div class="metric">
                            <div class="metric-value">456</div>
                            <div class="metric-label" data-en="Quotes" data-ru="КП">Quotes</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">7min</div>
                            <div class="metric-label">Avg Time</div>
                        </div>
                    </div>
                    <div class="card-status status-planned" data-en="Planned" data-ru="Запланировано">Planned</div>
                </div>
            </div>
        </div>

        <!-- Design Module -->
        <div class="module-content" data-content="designer" id="designer">
            <div class="module-grid">
                <div class="module-card">
                    <div class="card-header">
                        <div class="card-icon">📝</div>
                        <div>
                            <h3 class="card-title" data-en="System Layout Tool" data-ru="Инструмент компоновки систем">System Layout Tool</h3>
                        </div>
                    </div>
                    <p class="card-description">Инструмент для проектирования компоновки HVAC систем</p>
                    <div class="card-metrics">
                        <div class="metric">
                            <div class="metric-value">89</div>
                            <div class="metric-label" data-en="Layouts" data-ru="Макетов">Layouts</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">95%</div>
                            <div class="metric-label" data-en="Accuracy" data-ru="Точность">Accuracy</div>
                        </div>
                    </div>
                    <div class="card-status status-planned" data-en="Planned" data-ru="Запланировано">Planned</div>
                </div>

                <div class="module-card">
                    <div class="card-header">
                        <div class="card-icon">🏗️</div>
                        <div>
                            <h3 class="card-title" data-en="3D Modeling" data-ru="3D Моделирование">3D Modeling</h3>
                        </div>
                    </div>
                    <p class="card-description">3D моделирование установок и помещений</p>
                    <div class="card-metrics">
                        <div class="metric">
                            <div class="metric-value">34</div>
                            <div class="metric-label" data-en="Models" data-ru="Моделей">Models</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">2.5GB</div>
                            <div class="metric-label" data-en="Storage" data-ru="Хранилище">Storage</div>
                        </div>
                    </div>
                    <div class="card-status status-planned" data-en="Planned" data-ru="Запланировано">Planned</div>
                </div>

                <div class="module-card">
                    <div class="card-header">
                        <div class="card-icon">📐</div>
                        <div>
                            <h3 class="card-title" data-en="Specification Engine" data-ru="Движок спецификаций">Specification Engine</h3>
                        </div>
                    </div>
                    <p class="card-description">Автоматическая генерация технических спецификаций</p>
                    <div class="card-metrics">
                        <div class="metric">
                            <div class="metric-value">156</div>
                            <div class="metric-label" data-en="Specs" data-ru="Спецификаций">Specs</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">100%</div>
                            <div class="metric-label" data-en="Compliance" data-ru="Соответствие">Compliance</div>
                        </div>
                    </div>
                    <div class="card-status status-planned" data-en="Planned" data-ru="Запланировано">Planned</div>
                </div>
            </div>
        </div>

        <!-- Service Module -->
        <div class="module-content" data-content="service" id="service">
            <div class="module-grid">
                <div class="module-card">
                    <div class="card-header">
                        <div class="card-icon">🔧</div>
                        <div>
                            <h3 class="card-title" data-en="Maintenance Planner" data-ru="Планировщик обслуживания">Maintenance Planner</h3>
                        </div>
                    </div>
                    <p class="card-description">Планировщик технического обслуживания оборудования</p>
                    <div class="card-metrics">
                        <div class="metric">
                            <div class="metric-value">247</div>
                            <div class="metric-label" data-en="Schedules" data-ru="Расписаний">Schedules</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">99%</div>
                            <div class="metric-label" data-en="On-time" data-ru="В срок">On-time</div>
                        </div>
                    </div>
                    <div class="card-status status-planned" data-en="Planned" data-ru="Запланировано">Planned</div>
                </div>

                <div class="module-card">
                    <div class="card-header">
                        <div class="card-icon">📞</div>
                        <div>
                            <h3 class="card-title" data-en="Support System" data-ru="Система поддержки">Support System</h3>
                        </div>
                    </div>
                    <p class="card-description">Система технической поддержки клиентов</p>
                    <div class="card-metrics">
                        <div class="metric">
                            <div class="metric-value">1,247</div>
                            <div class="metric-label">Tickets</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">4.8</div>
                            <div class="metric-label">Rating</div>
                        </div>
                    </div>
                    <div class="card-status status-planned" data-en="Planned" data-ru="Запланировано">Planned</div>
                </div>

                <div class="module-card">
                    <div class="card-header">
                        <div class="card-icon">🚨</div>
                        <div>
                            <h3 class="card-title" data-en="Alert System" data-ru="Система оповещений">Alert System</h3>
                        </div>
                    </div>
                    <p class="card-description">Система предупреждений и мониторинга</p>
                    <div class="card-metrics">
                        <div class="metric">
                            <div class="metric-value">89</div>
                            <div class="metric-label">Alerts</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">24/7</div>
                            <div class="metric-label">Monitoring</div>
                        </div>
                    </div>
                    <div class="card-status status-planned" data-en="Planned" data-ru="Запланировано">Planned</div>
                </div>
            </div>
        </div>

        <!-- Forecast Module -->
        <div class="module-content" data-content="forecast" id="forecast">
            <div class="module-grid">
                <div class="module-card">
                    <div class="card-header">
                        <div class="card-icon">📈</div>
                        <div>
                            <h3 class="card-title" data-en="Predictive Analytics" data-ru="Предиктивная аналитика">Predictive Analytics</h3>
                        </div>
                    </div>
                    <p class="card-description">Предиктивная аналитика спроса и рыночных трендов</p>
                    <div class="card-metrics">
                        <div class="metric">
                            <div class="metric-value">87%</div>
                            <div class="metric-label" data-en="Accuracy" data-ru="Точность">Accuracy</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">30d</div>
                            <div class="metric-label">Forecast</div>
                        </div>
                    </div>
                    <div class="card-status status-planned" data-en="Planned" data-ru="Запланировано">Planned</div>
                </div>

                <div class="module-card">
                    <div class="card-header">
                        <div class="card-icon">🎯</div>
                        <div>
                            <h3 class="card-title" data-en="Market Intelligence" data-ru="Рыночная аналитика">Market Intelligence</h3>
                        </div>
                    </div>
                    <p class="card-description">Анализ рыночной ситуации и конкурентов</p>
                    <div class="card-metrics">
                        <div class="metric">
                            <div class="metric-value">247</div>
                            <div class="metric-label">Sources</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">Real-time</div>
                            <div class="metric-label">Updates</div>
                        </div>
                    </div>
                    <div class="card-status status-planned" data-en="Planned" data-ru="Запланировано">Planned</div>
                </div>

                <div class="module-card">
                    <div class="card-header">
                        <div class="card-icon">💡</div>
                        <div>
                            <h3 class="card-title" data-en="Insights Engine" data-ru="Движок инсайтов">Insights Engine</h3>
                        </div>
                    </div>
                    <p class="card-description">Генерация инсайтов для бизнес-решений</p>
                    <div class="card-metrics">
                        <div class="metric">
                            <div class="metric-value">156</div>
                            <div class="metric-label">Insights</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">94%</div>
                            <div class="metric-label">Relevance</div>
                        </div>
                    </div>
                    <div class="card-status status-planned" data-en="Planned" data-ru="Запланировано">Planned</div>
                </div>
            </div>
        </div>

        <!-- Installation Module -->
        <div class="module-content" data-content="install" id="install">
            <div class="module-grid">
                <div class="module-card">
                    <div class="card-header">
                        <div class="card-icon">🔩</div>
                        <div>
                            <h3 class="card-title" data-en="Crew Management" data-ru="Управление бригадами">Crew Management</h3>
                        </div>
                    </div>
                    <p class="card-description">Управление монтажными бригадами и ресурсами</p>
                    <div class="card-metrics">
                        <div class="metric">
                            <div class="metric-value">47</div>
                            <div class="metric-label">Teams</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">95%</div>
                            <div class="metric-label">Utilization</div>
                        </div>
                    </div>
                    <div class="card-status status-planned" data-en="Planned" data-ru="Запланировано">Planned</div>
                </div>

                <div class="module-card">
                    <div class="card-header">
                        <div class="card-icon">💵</div>
                        <div>
                            <h3 class="card-title" data-en="Cost Calculator" data-ru="Калькулятор стоимости">Cost Calculator</h3>
                        </div>
                    </div>
                    <p class="card-description">Калькулятор стоимости монтажных работ</p>
                    <div class="card-metrics">
                        <div class="metric">
                            <div class="metric-value">247</div>
                            <div class="metric-label">Calculations</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">±5%</div>
                            <div class="metric-label" data-en="Accuracy" data-ru="Точность">Accuracy</div>
                        </div>
                    </div>
                    <div class="card-status status-planned" data-en="Planned" data-ru="Запланировано">Planned</div>
                </div>

                <div class="module-card">
                    <div class="card-header">
                        <div class="card-icon">⏱️</div>
                        <div>
                            <h3 class="card-title" data-en="Timeline Optimizer" data-ru="Оптимизатор сроков">Timeline Optimizer</h3>
                        </div>
                    </div>
                    <p class="card-description">Оптимизация временных рамок проектов</p>
                    <div class="card-metrics">
                        <div class="metric">
                            <div class="metric-value">89</div>
                            <div class="metric-label">Projects</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">23%</div>
                            <div class="metric-label">Time Saved</div>
                        </div>
                    </div>
                    <div class="card-status status-planned" data-en="Planned" data-ru="Запланировано">Planned</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Chatbot Section -->
    <div class="chatbot-section">
        <button class="chatbot-toggle" id="chatbotToggle">💬</button>
        <div class="chatbot-window" id="chatbotWindow">
            <div class="chatbot-header">
                <div class="chatbot-avatar">AI</div>
                <div class="chatbot-info">
                    <h3>HVAC Assistant</h3>
                    <p>Online</p>
                </div>
            </div>
            <div class="chatbot-messages" id="chatMessages">
                <div class="message">
                    <div class="message-content" data-en="Hi! I'm HVAC Assistant. How can I help with your modules?" data-ru="Привет! Я HVAC Assistant. Чем могу помочь с вашими модулями?">
                        Hi! I'm HVAC Assistant. How can I help with your modules?
                    </div>
                </div>
            </div>
            <div class="chatbot-input">
                <input type="text" id="messageInput" placeholder="Enter message..." data-en-placeholder="Enter message..." data-ru-placeholder="Введите сообщение...">
                <button class="send-btn" id="sendBtn">➤</button>
            </div>
        </div>
    </div>

    <!-- Selected Items Panel -->
    <div class="selected-panel" id="selectedPanel">
        <div class="selected-info">
            <span class="selected-count" id="selectedCount" data-en="0 items selected" data-ru="0 товаров выбрано">0 items selected</span>
            <span class="selected-total" id="selectedTotal">$0</span>
            <button class="btn-reset-selection" id="resetSelectionBtn" onclick="resetAllSelections()" title="Сбросить выбор" data-en="Reset" data-ru="Сбросить">
                <span class="reset-icon">✕</span>
            </button>
        </div>
        <div class="selected-actions">
            <button type="button" class="btn-quote" id="quoteButton" data-en="+ Add to KP" data-ru="+ Добавить в КП">+ Добавить в КП</button>
            <button class="btn-request" onclick="generateRequest()" data-en="Request" data-ru="Запрос">Запрос</button>
            <button class="btn-catalog" onclick="openCatalog()" data-en="Catalog" data-ru="Каталог">Catalog</button>
        </div>
    </div> <!-- End Main Content Area -->
    </div>

    <!-- Cart/Quote View Modal -->
    <div class="cart-modal" id="cartModal" style="display: none;">
        <div class="cart-modal-overlay" onclick="closeCart()"></div>
        <div class="cart-modal-content">
            <div class="cart-header">
                <h2 class="cart-title" data-en="Shopping Cart & Quote" data-ru="Корзина и КП">Корзина и КП</h2>
                <button class="cart-close" onclick="closeCart()" title="Закрыть">×</button>
            </div>
            
            <div class="cart-body">
                <!-- Cart Items by Brand -->
                <div class="cart-items" id="cartItems">
                    <!-- Items will be dynamically generated here -->
                </div>
                
                <!-- Cart Summary -->
                <div class="cart-summary">
                    <div class="summary-row">
                        <span data-en="Total Products:" data-ru="Всего товаров:">Всего товаров:</span>
                        <span id="cartTotalProducts">0</span>
                    </div>
                    <div class="summary-row">
                        <span data-en="Total Brands:" data-ru="Всего брендов:">Всего брендов:</span>
                        <span id="cartTotalBrands">0</span>
                    </div>
                    <div class="summary-row total">
                        <span data-en="Total Price:" data-ru="Общая стоимость:">Общая стоимость:</span>
                        <span id="cartTotalPrice">$0</span>
                    </div>
                </div>
                
                <!-- Cart Actions -->
                <div class="cart-actions">
                    <button class="btn-cart-action btn-primary" onclick="generatePDFQuote()" data-en="Generate PDF Quote" data-ru="Создать PDF КП">Создать PDF КП</button>
                    <button class="btn-cart-action btn-secondary" onclick="sendQuoteRequest()" data-en="Send Request" data-ru="Отправить запрос">Отправить запрос</button>
                    <button class="btn-cart-action btn-danger" onclick="clearCart()" data-en="Clear Cart" data-ru="Очистить корзину">Очистить корзину</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // HVAC Navigation System
        function initHVACNavigation() {
            console.log('Initializing HVAC navigation...');
            
            // Add click events to HVAC letters
            const letters = document.querySelectorAll('.hvac-letter');
            console.log('Found HVAC letters:', letters.length);
            
            letters.forEach(letter => {
                console.log('Adding click event to letter:', letter.textContent, 'platform:', letter.getAttribute('data-platform'));
                letter.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    const platform = this.getAttribute('data-platform');
                    console.log('Letter clicked:', this.textContent, 'navigating to platform:', platform);
                    
                    // Navigate to respective platform file
                    if (platform === 'heating') {
                        window.location.href = 'heating.html';
                    } else if (platform === 'ventilation') {
                        window.location.href = 'ventilation.html';
                    } else if (platform === 'airconditioning') {
                        window.location.href = 'air-conditioning.html';
                    }
                });
                
                // Also add hover effect
                letter.addEventListener('mouseenter', function() {
                    console.log('Hovering over letter:', this.textContent);
                });
            });
        }

        // Dashboard JavaScript
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, starting initialization...');
            try {
                initHVACNavigation();
                console.log('✓ initHVACNavigation completed');
                initChatbot();
                console.log('✓ initChatbot completed');
                initAnimations();
                console.log('✓ initAnimations completed');
                initLanguageToggle();
                console.log('✓ initLanguageToggle completed');
                initEquipmentSearch();
                console.log('✓ initEquipmentSearch completed');
                initCategoryTabs();
                console.log('✓ initCategoryTabs completed');
                initRangeSliders();
                console.log('✓ initRangeSliders completed');
                initCheckboxFilters();
                console.log('✓ initCheckboxFilters completed');
                initMobileMenu();
                console.log('✓ initMobileMenu completed');
                initNavMenu();
                console.log('✓ initNavMenu completed');
                initEquipmentSidebar();
                console.log('✓ initEquipmentSidebar completed');
                initQuoteSystem();
                console.log('✓ initQuoteSystem completed');
            } catch (error) {
                console.error('Initialization error:', error);
            }
            
            // Force product generation after everything is loaded
            setTimeout(() => {
                console.log('Force generating products...');
                generateSampleProducts();
            }, 500);
            
            // Handle hash navigation on page load
            handleHashNavigation();
        });

        // Handle hash-based navigation
        function handleHashNavigation() {
            const hash = window.location.hash.substring(1); // Remove #
            if (hash) {
                // Small delay to ensure page is fully loaded
                setTimeout(() => {
                    switchToModule(hash);
                }, 100);
            }
        }

        // Listen for hash changes
        window.addEventListener('hashchange', handleHashNavigation);

        // Equipment Search System
        function initEquipmentSearch() {
            initScoutTabs();
            initBrandTabs();
            initFilters();
            initProductCards();
            initSettingsPanel();
            initAISearch();
            initAIChat();
            generateSampleProducts();
        }

        // Scout Sub-tabs functionality
        function initScoutTabs() {
            const tabs = document.querySelectorAll('.scout-tab');
            const contents = document.querySelectorAll('.scout-content');

            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const module = this.getAttribute('data-scout-module');
                    
                    // Remove active class from all tabs and contents
                    tabs.forEach(t => t.classList.remove('active'));
                    contents.forEach(c => c.classList.remove('active'));
                    
                    // Add active class to clicked tab and corresponding content
                    this.classList.add('active');
                    document.querySelector(`[data-scout-content="${module}"]`).classList.add('active');
                });
            });
        }

        // AI Chat functionality
        function initAIChat() {
            const chatSendBtn = document.getElementById('aiChatSendBtn');
            const chatInput = document.getElementById('aiChatInput');
            const chatMessages = document.getElementById('aiChatMessages');

            function sendChatMessage() {
                const message = chatInput.value.trim();
                if (message) {
                    // Add user message
                    addChatMessage(message, 'user');
                    chatInput.value = '';
                    
                    // Simulate AI response
                    setTimeout(() => {
                        addChatAIResponse(message);
                    }, 1000);
                }
            }

            if (chatSendBtn) {
                chatSendBtn.addEventListener('click', sendChatMessage);
            }

            if (chatInput) {
                chatInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        sendChatMessage();
                    }
                });
            }

            function addChatMessage(text, type = 'ai') {
                if (!chatMessages) return;
                
                const messageDiv = document.createElement('div');
                messageDiv.className = `ai-message ${type}`;
                
                if (type === 'user') {
                    messageDiv.innerHTML = `
                        <div class="ai-message-content" style="background: var(--signature-blue); color: white; margin-left: auto; max-width: 80%;">${text}</div>
                        <div class="ai-avatar" style="background: var(--deep-graphite);">👤</div>
                    `;
                    messageDiv.style.flexDirection = 'row-reverse';
                } else {
                    messageDiv.innerHTML = `
                        <div class="ai-avatar">🤖</div>
                        <div class="ai-message-content">${text}</div>
                    `;
                }
                
                chatMessages.appendChild(messageDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }

            function addChatAIResponse(userMessage) {
                const lowerMessage = userMessage.toLowerCase();
                const currentLang = localStorage.getItem('preferredLanguage') || 'en';
                let response = '';

                if (lowerMessage.includes('quiet') || lowerMessage.includes('тихий')) {
                    response = currentLang === 'en' ? 
                        'I found several quiet HVAC systems. The Daikin FTXM series and LG Dual Inverter models are excellent for low noise operation. Would you like specific recommendations?' :
                        'Я нашел несколько тихих HVAC систем. Серии Daikin FTXM и LG Dual Inverter отлично подходят для малошумной работы. Хотите конкретные рекомендации?';
                } else if (lowerMessage.includes('room') || lowerMessage.includes('комнат')) {
                    response = currentLang === 'en' ? 
                        'For room sizing, I recommend: 25m² = 9000-12000 BTU. Daikin FTXM35R or Mitsubishi MSZ-LN25VG would be perfect. Need heating function too?' :
                        'Для размера комнаты рекомендую: 25м² = 9000-12000 BTU. Daikin FTXM35R или Mitsubishi MSZ-LN25VG будут идеальны. Нужна также функция обогрева?';
                } else if (lowerMessage.includes('price') || lowerMessage.includes('цен')) {
                    response = currentLang === 'en' ? 
                        'Based on current market data: Split systems range from $800-2500, Multi-split $1200-4000, VRF systems $3000-15000. Prices include dealer and client discounts.' :
                        'На основе текущих рыночных данных: Сплит-системы $800-2500, Мульти-сплит $1200-4000, VRF системы $3000-15000. Цены включают скидки дилера и клиента.';
                } else {
                    response = currentLang === 'en' ? 
                        `I understand you're looking for "${userMessage}". Let me analyze the requirements and suggest optimal HVAC solutions. What specific features are most important?` :
                        `Я понимаю, что вы ищете "${userMessage}". Позвольте проанализировать требования и предложить оптимальные HVAC решения. Какие характеристики наиболее важны?`;
                }
                
                addChatMessage(response, 'ai');
            }
        }

        // AI Search Functionality
        function initAISearch() {
            const aiSearchBtn = document.getElementById('aiSearchBtn');
            const aiSearchInput = document.getElementById('aiSearchInput');

            function performAISearch() {
                const query = aiSearchInput.value.trim();
                if (query) {
                    // Show loading state
                    aiSearchBtn.innerHTML = '<span class="loading"></span>';
                    aiSearchBtn.disabled = true;
                    
                    // Simulate AI processing
                    setTimeout(() => {
                        processAIQuery(query);
                        
                        // Reset button
                        aiSearchBtn.innerHTML = '<span class="ai-icon">🤖</span>';
                        aiSearchBtn.disabled = false;
                        aiSearchInput.value = '';
                    }, 1500);
                }
            }

            aiSearchBtn.addEventListener('click', performAISearch);
            aiSearchInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    performAISearch();
                }
            });
        }

        // Process AI query and apply filters
        function processAIQuery(query) {
            const lowerQuery = query.toLowerCase();
            const currentLang = localStorage.getItem('preferredLanguage') || 'en';

            // Reset all filters first
            document.querySelectorAll('.filter-checkbox.checked').forEach(cb => {
                cb.classList.remove('checked');
            });

            // Smart query processing
            if (lowerQuery.includes('split') || lowerQuery.includes('сплит')) {
                document.querySelector('[data-filter="split"]')?.classList.add('checked');
            }
            
            if (lowerQuery.includes('multi') || lowerQuery.includes('мульти')) {
                document.querySelector('[data-filter="multi"]')?.classList.add('checked');
            }
            
            if (lowerQuery.includes('vrf') || lowerQuery.includes('vrv')) {
                document.querySelector('[data-filter="vrf"]')?.classList.add('checked');
            }
            
            if (lowerQuery.includes('inverter') || lowerQuery.includes('инвертор')) {
                document.querySelector('[data-filter="inverter"]')?.classList.add('checked');
            }
            
            if (lowerQuery.includes('wifi') || lowerQuery.includes('wi-fi') || lowerQuery.includes('вай-фай')) {
                document.querySelector('[data-filter="wifi"]')?.classList.add('checked');
            }
            
            if (lowerQuery.includes('heating') || lowerQuery.includes('heat') || lowerQuery.includes('обогрев') || lowerQuery.includes('тепло')) {
                document.querySelector('[data-filter="heating"]')?.classList.add('checked');
            }
            
            if (lowerQuery.includes('quiet') || lowerQuery.includes('тихий') || lowerQuery.includes('бесшумн')) {
                document.querySelector('[data-filter="quiet"]')?.classList.add('checked');
            }

            // Energy class detection
            if (lowerQuery.includes('a+++')) {
                document.querySelector('[data-filter="a+++"]')?.classList.add('checked');
            } else if (lowerQuery.includes('a++')) {
                document.querySelector('[data-filter="a++"]')?.classList.add('checked');
            } else if (lowerQuery.includes('a+')) {
                document.querySelector('[data-filter="a+"]')?.classList.add('checked');
            }

            // Brand detection
            const brands = ['daikin', 'mitsubishi', 'lg', 'panasonic', 'toshiba', 'fujitsu', 'carrier', 'york', 'trane', 'lennox'];
            brands.forEach(brand => {
                if (lowerQuery.includes(brand)) {
                    const brandTab = document.querySelector(`[data-brand="${brand}"]`);
                    if (brandTab) {
                        // Switch to brand
                        document.querySelectorAll('.brand-tab').forEach(tab => tab.classList.remove('active'));
                        brandTab.classList.add('active');
                        currentBrand = brand;
                    }
                }
            });

            // Capacity detection (BTU ranges)
            const capacityMatch = lowerQuery.match(/(\d+)[\s]*(?:k|000|к)?[\s]*(?:btu|бте|bte)/i);
            if (capacityMatch) {
                const capacity = parseInt(capacityMatch[1]);
                const capacityInputs = document.querySelectorAll('.filter-input');
                if (capacityInputs.length >= 2) {
                    if (capacity < 12) {
                        capacityInputs[0].value = Math.max(capacity - 3, 6) * 1000;
                        capacityInputs[1].value = (capacity + 3) * 1000;
                    } else {
                        capacityInputs[0].value = (capacity - 5) * 1000;
                        capacityInputs[1].value = (capacity + 5) * 1000;
                    }
                }
            }

            // Apply filters and show results
            filterProducts();

            // Show AI response message
            const message = currentLang === 'en' ? 
                `AI Search applied filters based on: "${query}"` :
                `ИИ поиск применил фильтры на основе: "${query}"`;
            
            showAIResponse(message);
        }

        // Show AI response notification
        function showAIResponse(message) {
            const notification = document.createElement('div');
            notification.className = 'ai-notification';
            notification.textContent = message;
            notification.style.cssText = `
                position: fixed;
                top: 100px;
                right: 20px;
                background: var(--signature-blue);
                color: white;
                padding: 1rem 1.5rem;
                border-radius: 8px;
                box-shadow: 0 4px 20px rgba(0,0,0,0.15);
                z-index: 1001;
                max-width: 300px;
                font-size: 0.9rem;
                animation: slideIn 0.3s ease-out;
            `;

            document.body.appendChild(notification);

            // Remove after 4 seconds
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease-in';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 4000);
        }

        // Settings Panel Functions
        function initSettingsPanel() {
            const currencySelect = document.getElementById('currencySelect');
            const clientDiscountInput = document.getElementById('clientDiscount');

            // Currency change handler
            if (currencySelect) {
                currencySelect.addEventListener('change', function() {
                    currentCurrency = this.value;
                    filterProducts(); // Refresh product display
                });
            }

            // Client discount change handler
            if (clientDiscountInput) {
                clientDiscountInput.addEventListener('input', function() {
                    filterProducts(); // Refresh product display
                });
            }
        }

        // Currency conversion function
        function convertPrice(usdPrice) {
            switch(currentCurrency) {
                case 'rub':
                    return usdPrice * exchangeRates.rub;
                case 'eur':
                    return usdPrice * exchangeRates.eur;
                default:
                    return usdPrice;
            }
        }

        // Format price with currency symbol
        function formatPrice(price) {
            const convertedPrice = convertPrice(price);
            switch(currentCurrency) {
                case 'rub':
                    return `₽${Math.round(convertedPrice).toLocaleString()}`;
                case 'eur':
                    return `€${convertedPrice.toFixed(2)}`;
                default:
                    return `$${convertedPrice.toFixed(0)}`;
            }
        }

        // Apply discounts to price
        function applyDiscounts(price, isClientPrice = false) {
            const clientDiscountInput = document.getElementById('clientDiscount');
            const clientDiscount = clientDiscountInput ? parseFloat(clientDiscountInput.value) || 0 : 0;
            
            let discountedPrice = price;
            
            if (isClientPrice) {
                discountedPrice = discountedPrice * (1 - clientDiscount / 100);
            }
            
            return discountedPrice;
        }

        // Fetch exchange rates (placeholder function)
        function fetchExchangeRate(fromCurrency, toCurrency) {
            // Placeholder for real API integration
            const rates = {
                'usd-rub': Math.random() * 10 + 70, // 70-80 range
                'usd-eur': Math.random() * 0.2 + 0.75 // 0.75-0.95 range
            };
            
            const rateKey = `${fromCurrency}-${toCurrency}`;
            const newRate = rates[rateKey];
            
            if (newRate) {
                if (toCurrency === 'rub') {
                    document.getElementById('usdRubRate').value = newRate.toFixed(2);
                    exchangeRates.rub = newRate;
                } else if (toCurrency === 'eur') {
                    document.getElementById('usdEurRate').value = newRate.toFixed(3);
                    exchangeRates.eur = newRate;
                }
                
                if (currentCurrency === toCurrency) {
                    filterProducts(); // Refresh display if current currency updated
                }
            }
        }

        // Sample product data
        let sampleProducts = [];

        let selectedProducts = [];
        let currentBrand = 'daikin';
        let currentSubcategory = ''; // Start with no subcategory filter
        let currentCurrency = 'usd';
        let exchangeRates = {
            usd: 1,
            rub: 75.50,
            eur: 0.85
        };

        function initBrandTabs() {
            const brandTabs = document.querySelectorAll('.brand-tab');
            const settingsPanel = document.querySelector('.settings-panel');
            
            brandTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    // Remove active class from all tabs
                    brandTabs.forEach(t => t.classList.remove('active'));
                    // Add active class to clicked tab
                    this.classList.add('active');
                    
                    const newBrand = this.getAttribute('data-brand');
                    if (newBrand !== currentBrand) {
                        currentBrand = newBrand;
                        // Generate new products for the selected brand
                        generateSampleProducts();
                    }
                });

                // Add hover effect to highlight settings panel
                tab.addEventListener('mouseenter', function() {
                    if (settingsPanel) {
                        settingsPanel.classList.add('brand-hover');
                    }
                });

                tab.addEventListener('mouseleave', function() {
                    if (settingsPanel) {
                        settingsPanel.classList.remove('brand-hover');
                    }
                });
            });
        }

        function initFilters() {
            const checkboxes = document.querySelectorAll('.filter-checkbox');
            const inputs = document.querySelectorAll('.filter-input');
            
            checkboxes.forEach(checkbox => {
                checkbox.addEventListener('click', function() {
                    this.classList.toggle('checked');
                    filterProducts();
                });
            });

            inputs.forEach(input => {
                input.addEventListener('input', filterProducts);
            });
        }

        function filterProducts() {
            console.log('Filtering products for brand:', currentBrand);
            // Generate products for current brand if sampleProducts is empty or for different brand
            if (sampleProducts.length === 0 || !sampleProducts[0].brand || sampleProducts[0].brand !== currentBrand) {
                generateSampleProducts();
            } else {
                renderProducts(sampleProducts);
                updateResultsCount(sampleProducts.length);
            }
        }


        // Comprehensive product database for all brands - make it global
        window.allBrandProducts = {
            daikin: [
                { model: 'FTXS25K', title: 'Daikin FTXS25K Split System', specs: '9,000 BTU/h, A++ Energy Class', price: 850, capacity: 9000, type: 'split' },
                { model: 'FTXS35K', title: 'Daikin FTXS35K Split System', specs: '12,000 BTU/h, A++ Energy Class', price: 950, capacity: 12000, type: 'split' },
                { model: 'FTXS50K', title: 'Daikin FTXS50K Split System', specs: '18,000 BTU/h, A+ Energy Class', price: 1150, capacity: 18000, type: 'split' },
                { model: 'FCAG71A', title: 'Daikin FCAG71A Cassette System', specs: '24,000 BTU/h, A+ Energy Class', price: 1650, capacity: 24000, type: 'cassette' },
                { model: 'FDXS35F', title: 'Daikin FDXS35F Floor System', specs: '12,000 BTU/h, A++ Energy Class', price: 1100, capacity: 12000, type: 'floor' }
            ],
            mitsubishi: [
                { model: 'MSZ-AP25VG', title: 'Mitsubishi MSZ-AP25VG Split System', specs: '9,000 BTU/h, A+++ Energy Class', price: 900, capacity: 9000, type: 'split' },
                { model: 'MSZ-AP35VG', title: 'Mitsubishi MSZ-AP35VG Split System', specs: '12,000 BTU/h, A+++ Energy Class', price: 1000, capacity: 12000, type: 'split' },
                { model: 'MSZ-EF50VE', title: 'Mitsubishi MSZ-EF50VE Split System', specs: '18,000 BTU/h, A++ Energy Class', price: 1200, capacity: 18000, type: 'split' },
                { model: 'PLA-M71EA', title: 'Mitsubishi PLA-M71EA Ceiling System', specs: '24,000 BTU/h, A+ Energy Class', price: 1700, capacity: 24000, type: 'ceiling' },
                { model: 'MLZ-KP25VF', title: 'Mitsubishi MLZ-KP25VF Floor System', specs: '9,000 BTU/h, A++ Energy Class', price: 950, capacity: 9000, type: 'floor' }
            ],
            lg: [
                { model: 'S09EQ', title: 'LG S09EQ Split System', specs: '9,000 BTU/h, A++ Energy Class', price: 750, capacity: 9000, type: 'split' },
                { model: 'S12EQ', title: 'LG S12EQ Split System', specs: '12,000 BTU/h, A++ Energy Class', price: 850, capacity: 12000, type: 'split' },
                { model: 'S18EQ', title: 'LG S18EQ Split System', specs: '18,000 BTU/h, A+ Energy Class', price: 1050, capacity: 18000, type: 'split' },
                { model: 'CT24F', title: 'LG CT24F Cassette System', specs: '24,000 BTU/h, A++ Energy Class', price: 1550, capacity: 24000, type: 'cassette' },
                { model: 'UV42F', title: 'LG UV42F Floor System', specs: '12,000 BTU/h, A+ Energy Class', price: 980, capacity: 12000, type: 'floor' }
            ],
            panasonic: [
                { model: 'CS-Z25TKEW', title: 'Panasonic CS-Z25TKEW Split System', specs: '9,000 BTU/h, A+++ Energy Class', price: 950, capacity: 9000, type: 'split' },
                { model: 'CS-Z35TKEW', title: 'Panasonic CS-Z35TKEW Split System', specs: '12,000 BTU/h, A+++ Energy Class', price: 1050, capacity: 12000, type: 'split' },
                { model: 'CS-Z50TKEW', title: 'Panasonic CS-Z50TKEW Split System', specs: '18,000 BTU/h, A++ Energy Class', price: 1250, capacity: 18000, type: 'split' },
                { model: 'S-71PU2E5A', title: 'Panasonic S-71PU2E5A Cassette System', specs: '24,000 BTU/h, A+ Energy Class', price: 1750, capacity: 24000, type: 'cassette' },
                { model: 'S-35PF2E5A', title: 'Panasonic S-35PF2E5A Floor System', specs: '12,000 BTU/h, A++ Energy Class', price: 1150, capacity: 12000, type: 'floor' }
            ],
            toshiba: [
                { model: 'RAS-25PKVSG', title: 'Toshiba RAS-25PKVSG Split System', specs: '9,000 BTU/h, A++ Energy Class', price: 820, capacity: 9000, type: 'split' },
                { model: 'RAS-35PKVSG', title: 'Toshiba RAS-35PKVSG Split System', specs: '12,000 BTU/h, A++ Energy Class', price: 920, capacity: 12000, type: 'split' },
                { model: 'RAS-50PKVSG', title: 'Toshiba RAS-50PKVSG Split System', specs: '18,000 BTU/h, A+ Energy Class', price: 1120, capacity: 18000, type: 'split' },
                { model: 'RAV-SM804CTP', title: 'Toshiba RAV-SM804CTP Cassette System', specs: '24,000 BTU/h, A+ Energy Class', price: 1620, capacity: 24000, type: 'cassette' },
                { model: 'RAV-SM364FTP', title: 'Toshiba RAV-SM364FTP Floor System', specs: '12,000 BTU/h, A++ Energy Class', price: 1050, capacity: 12000, type: 'floor' }
            ],
            fujitsu: [
                { model: 'ASYG09KMCC', title: 'Fujitsu ASYG09KMCC Split System', specs: '9,000 BTU/h, A+++ Energy Class', price: 880, capacity: 9000, type: 'split' },
                { model: 'ASYG12KMCC', title: 'Fujitsu ASYG12KMCC Split System', specs: '12,000 BTU/h, A+++ Energy Class', price: 980, capacity: 12000, type: 'split' },
                { model: 'ASYG18KMCC', title: 'Fujitsu ASYG18KMCC Split System', specs: '18,000 BTU/h, A++ Energy Class', price: 1180, capacity: 18000, type: 'split' },
                { model: 'AUYG24LVLA', title: 'Fujitsu AUYG24LVLA Cassette System', specs: '24,000 BTU/h, A+ Energy Class', price: 1680, capacity: 24000, type: 'cassette' },
                { model: 'AGYG12LVCB', title: 'Fujitsu AGYG12LVCB Floor System', specs: '12,000 BTU/h, A++ Energy Class', price: 1080, capacity: 12000, type: 'floor' }
            ],
            carrier: [
                { model: '42QHC009DS', title: 'Carrier 42QHC009DS Split System', specs: '9,000 BTU/h, A++ Energy Class', price: 780, capacity: 9000, type: 'split' },
                { model: '42QHC012DS', title: 'Carrier 42QHC012DS Split System', specs: '12,000 BTU/h, A++ Energy Class', price: 880, capacity: 12000, type: 'split' },
                { model: '42QHC018DS', title: 'Carrier 42QHC018DS Split System', specs: '18,000 BTU/h, A+ Energy Class', price: 1080, capacity: 18000, type: 'split' },
                { model: '42GW024DS', title: 'Carrier 42GW024DS Cassette System', specs: '24,000 BTU/h, A+ Energy Class', price: 1580, capacity: 24000, type: 'cassette' },
                { model: '42GW012DS', title: 'Carrier 42GW012DS Floor System', specs: '12,000 BTU/h, A++ Energy Class', price: 980, capacity: 12000, type: 'floor' }
            ],
            york: [
                { model: 'YHFC09FS', title: 'York YHFC09FS Split System', specs: '9,000 BTU/h, A++ Energy Class', price: 760, capacity: 9000, type: 'split' },
                { model: 'YHFC12FS', title: 'York YHFC12FS Split System', specs: '12,000 BTU/h, A++ Energy Class', price: 860, capacity: 12000, type: 'split' },
                { model: 'YHFC18FS', title: 'York YHFC18FS Split System', specs: '18,000 BTU/h, A+ Energy Class', price: 1060, capacity: 18000, type: 'split' },
                { model: 'YCAC024FS', title: 'York YCAC024FS Cassette System', specs: '24,000 BTU/h, A+ Energy Class', price: 1560, capacity: 24000, type: 'cassette' },
                { model: 'YFAC012FS', title: 'York YFAC012FS Floor System', specs: '12,000 BTU/h, A++ Energy Class', price: 960, capacity: 12000, type: 'floor' }
            ],
            trane: [
                { model: '4TXK3009A', title: 'Trane 4TXK3009A Split System', specs: '9,000 BTU/h, A++ Energy Class', price: 800, capacity: 9000, type: 'split' },
                { model: '4TXK3012A', title: 'Trane 4TXK3012A Split System', specs: '12,000 BTU/h, A++ Energy Class', price: 900, capacity: 12000, type: 'split' },
                { model: '4TXK3018A', title: 'Trane 4TXK3018A Split System', specs: '18,000 BTU/h, A+ Energy Class', price: 1100, capacity: 18000, type: 'split' },
                { model: '4TCC4024A', title: 'Trane 4TCC4024A Cassette System', specs: '24,000 BTU/h, A+ Energy Class', price: 1600, capacity: 24000, type: 'cassette' },
                { model: '4TFC4012A', title: 'Trane 4TFC4012A Floor System', specs: '12,000 BTU/h, A++ Energy Class', price: 1000, capacity: 12000, type: 'floor' }
            ],
            lennox: [
                { model: 'MLA009S4M', title: 'Lennox MLA009S4M Split System', specs: '9,000 BTU/h, A++ Energy Class', price: 790, capacity: 9000, type: 'split' },
                { model: 'MLA012S4M', title: 'Lennox MLA012S4M Split System', specs: '12,000 BTU/h, A++ Energy Class', price: 890, capacity: 12000, type: 'split' },
                { model: 'MLA018S4M', title: 'Lennox MLA018S4M Split System', specs: '18,000 BTU/h, A+ Energy Class', price: 1090, capacity: 18000, type: 'split' },
                { model: 'MCA024S4M', title: 'Lennox MCA024S4M Cassette System', specs: '24,000 BTU/h, A+ Energy Class', price: 1590, capacity: 24000, type: 'cassette' },
                { model: 'MFA012S4M', title: 'Lennox MFA012S4M Floor System', specs: '12,000 BTU/h, A++ Energy Class', price: 990, capacity: 12000, type: 'floor' }
            ]
        };
        
        // Selection view toggle function
        function toggleSelectionView() {
            console.log('Selection view toggle clicked');
            
            if (window.brandSearch && window.brandSearch.selectedProducts.length > 0) {
                const brandSearch = window.brandSearch;
                const selectedProducts = brandSearch.selectedProducts;
                const selectedCount = selectedProducts.length;
                const currentBrand = brandSearch.currentBrand;
                const currentBrandName = brandSearch.equipmentStructure.brands[currentBrand]?.name || currentBrand;
                
                let message = `Выбрано товаров: ${selectedCount}\n`;
                message += `Текущий бренд: ${currentBrandName}\n\n`;
                
                // Check if we're showing analogs or original products
                const isShowingAnalogs = selectedProducts.length > 0 && selectedProducts[0].originalBrand !== currentBrand;
                
                if (isShowingAnalogs) {
                    // Show analog products with their prices
                    const matches = brandSearch.findMultipleCrossMatches(selectedProducts);
                    const currentBrandMatches = matches[currentBrand] || [];
                    
                    message += `Найденные аналоги (${currentBrandName}):\n`;
                    currentBrandMatches.forEach((product, index) => {
                        const price = brandSearch.formatPrice(product.price || 0);
                        const score = product.score ? ` (${Math.round(product.score)}% совпадение)` : '';
                        message += `${index + 1}. ${product.title || product.model} - ${price}${score}\n`;
                    });
                    
                    const totalPrice = currentBrandMatches.reduce((sum, p) => sum + (p.price || 0), 0);
                    message += `\nОбщая стоимость аналогов: ${brandSearch.formatPrice(totalPrice)}`;
                } else {
                    // Show original selected products
                    message += `Изначально выбранные товары:\n`;
                    selectedProducts.forEach((product, index) => {
                        const price = brandSearch.formatPrice(product.price || 0);
                        const brandName = brandSearch.equipmentStructure.brands[product.originalBrand]?.name || product.originalBrand;
                        message += `${index + 1}. ${product.title || product.model} (${brandName}) - ${price}\n`;
                    });
                    
                    const totalPrice = selectedProducts.reduce((sum, p) => sum + (p.price || 0), 0);
                    message += `\nОбщая стоимость: ${brandSearch.formatPrice(totalPrice)}`;
                }
                
                console.log('Selection summary:', message);
            } else {
                console.log('Nothing selected. Click on products to select them.');
            }
        }
        
        function generateSampleProducts() {
            console.log('=== GENERATING SAMPLE PRODUCTS FOR BRAND:', currentBrand, '===');
            
            // Очищаем массив
            sampleProducts.splice(0, sampleProducts.length);
            
            // Получаем продукты для текущего бренда
            const brandProducts = window.allBrandProducts[currentBrand] || [];
            
            console.log('Adding products to array for brand:', currentBrand);
            brandProducts.forEach((product, index) => {
                sampleProducts.push({
                    id: index + 1,
                    title: product.title,
                    model: product.model,
                    specs: product.specs,
                    price: product.price,
                    capacity: product.capacity,
                    type: product.type,
                    brand: currentBrand,
                    stock: Math.floor(Math.random() * 20) + 5
                });
            });
            
            console.log(`Generated ${sampleProducts.length} products for ${currentBrand}`);
            console.log('Products:', sampleProducts);
            
            // Напрямую вызываем renderProducts
            setTimeout(() => {
                renderProducts(sampleProducts);
                
                // Уведомляем систему перекрестного поиска о новых продуктах
                if (window.brandSearch) {
                    window.brandSearch.injectProductCardStyling();
                }
            }, 100);
        }

        function renderProducts(products) {
            console.log('=== RENDERING PRODUCTS ===');
            console.log('Products to render:', products.length);
            console.log('Products array:', products);
            
            const grid = document.getElementById('productsGrid');
            console.log('Grid element:', grid);
            
            if (!grid) {
                console.error('Products grid not found!');
                return;
            }

            if (!products || products.length === 0) {
                console.log('No products to render');
                grid.innerHTML = '<div style="padding: 20px; text-align: center; color: #666;">No products found</div>';
                return;
            }

            grid.innerHTML = products.map(product => {
                return `
                <div class="product-card" data-product-id="${product.id}">
                    <div class="product-image" title="Hover to enlarge">🌀</div>
                    <div class="product-info">
                        <div class="product-details">
                            <h4 class="product-title">${product.title}</h4>
                            <p class="product-specs">${product.specs}</p>
                        </div>
                        
                        <div class="product-capacity">
                            <div class="capacity-value">9.0k</div>
                            <div class="capacity-label">BTU/h</div>
                        </div>
                        
                        <div class="product-availability">
                            <div class="availability-scale">
                                <div class="availability-square filled"></div>
                                <div class="availability-square filled"></div>
                                <div class="availability-square filled"></div>
                                <div class="availability-square empty"></div>
                                <div class="availability-square empty"></div>
                            </div>
                            <div class="availability-label">Stock</div>
                            <div class="availability-text">${product.stock} units</div>
                        </div>
                        
                        <div class="product-prices">
                            <div class="price-item">
                                <span class="price-label">Розница:</span>
                                <span class="price-value price-retail">${formatPrice(product.price * 1.4)}</span>
                            </div>
                            <div class="price-item">
                                <span class="price-label">Закупка:</span>
                                <span class="price-value price-purchase">${formatPrice(product.price)}</span>
                            </div>
                            <div class="price-item">
                                <span class="price-label">Клиент:</span>
                                <span class="price-value price-sale">${formatPrice(applyDiscounts(product.price * 1.25, true))}</span>
                            </div>
                        </div>
                        
                        <div class="product-actions">
                            <button class="action-btn btn-select" onclick="toggleProductSelection(${product.id})" title="Select product">
                                <span class="action-icon">✓</span>
                            </button>
                            <button class="action-btn btn-compare" onclick="toggleCompare(${product.id})" title="Add to comparison">
                                <span class="action-icon">⚖</span>
                            </button>
                            <button class="action-btn btn-details" onclick="showProductDetails(${product.id})" title="Technical specifications">
                                <span class="action-icon">⚙</span>
                            </button>
                            <button class="action-btn btn-favorite" onclick="toggleFavorite(${product.id})" title="Add to favorites">
                                <span class="action-icon">♥</span>
                            </button>
                        </div>
                    </div>
                </div>
                `;
            }).join('');
        }

        let favoriteProducts = [];
        let compareProducts = [];

        function toggleProductSelection(productId) {
            const product = sampleProducts.find(p => p.id === productId);
            const productCard = document.querySelector(`[data-product-id="${productId}"]`);
            const selectButton = productCard.querySelector('.btn-select');
            
            const existingIndex = selectedProducts.findIndex(p => p.id === productId);
            
            if (existingIndex > -1) {
                selectedProducts.splice(existingIndex, 1);
                selectButton.classList.remove('selected');
            } else {
                selectedProducts.push(product);
                selectButton.classList.add('selected');
            }
            
            updateSelectedPanel();
        }

        function toggleFavorite(productId) {
            const productCard = document.querySelector(`[data-product-id="${productId}"]`);
            const favoriteButton = productCard.querySelector('.btn-favorite');
            
            const existingIndex = favoriteProducts.findIndex(p => p === productId);
            
            if (existingIndex > -1) {
                favoriteProducts.splice(existingIndex, 1);
                favoriteButton.classList.remove('favorited');
            } else {
                favoriteProducts.push(productId);
                favoriteButton.classList.add('favorited');
            }
        }

        function toggleCompare(productId) {
            const productCard = document.querySelector(`[data-product-id="${productId}"]`);
            const compareButton = productCard.querySelector('.btn-compare');
            
            const existingIndex = compareProducts.findIndex(p => p === productId);
            
            if (existingIndex > -1) {
                compareProducts.splice(existingIndex, 1);
                compareButton.classList.remove('comparing');
            } else {
                if (compareProducts.length >= 4) {
                    alert('Maximum 4 products for comparison');
                    return;
                }
                compareProducts.push(productId);
                compareButton.classList.add('comparing');
            }
        }

        function showProductDetails(productId) {
            const product = sampleProducts.find(p => p.id === productId);
            if (!product) return;
            
            // Create modal with product details
            const modal = document.createElement('div');
            modal.className = 'product-modal';
            modal.innerHTML = `
                <div class="modal-overlay" onclick="closeProductModal()"></div>
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>${product.title}</h3>
                        <button class="modal-close" onclick="closeProductModal()">×</button>
                    </div>
                    <div class="modal-body">
                        <div class="product-image-large">🌀</div>
                        <div class="product-details-full">
                            <p><strong>Технические характеристики:</strong> ${product.specs}</p>
                            <p><strong>Наличие на складе:</strong> ${product.stock} единиц</p>
                            <p><strong>Энергетический класс:</strong> A++</p>
                            <p><strong>Тип установки:</strong> Настенный</p>
                            <p><strong>Функции:</strong> Охлаждение, обогрев, осушение, вентиляция</p>
                            <p><strong>Дополнительно:</strong> Wi-Fi управление, инверторная технология</p>
                            <div class="price-details">
                                <p><strong>Розничная цена:</strong> ${formatPrice(product.price * 1.4)}</p>
                                <p><strong>Цена закупки:</strong> ${formatPrice(product.price)}</p>
                                <p><strong>Цена для клиента:</strong> ${formatPrice(applyDiscounts(product.price * 1.25, true))}</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }

        function closeProductModal() {
            const modal = document.querySelector('.product-modal');
            if (modal) {
                document.body.removeChild(modal);
            }
        }


        function updateSelectedPanel() {
            const panel = document.getElementById('selectedPanel');
            const countElement = document.getElementById('selectedCount');
            const totalElement = document.getElementById('selectedTotal');
            
            if (selectedProducts.length > 0) {
                const total = selectedProducts.reduce((sum, product) => sum + product.price * 1.25, 0);
                const currentLang = localStorage.getItem('preferredLanguage') || 'en';
                
                countElement.textContent = currentLang === 'en' ? 
                    `${selectedProducts.length} items selected` : 
                    `Выбрано ${selectedProducts.length} товаров`;
                totalElement.textContent = `${formatPrice(total)}`;
                panel.classList.add('active');
            } else {
                panel.classList.remove('active');
            }
        }

        function updateResultsCount(count) {
            const countElement = document.querySelector('.results-count-box');
            if (countElement) {
                const currentLang = localStorage.getItem('preferredLanguage') || 'en';
                countElement.textContent = currentLang === 'en' ? 
                    `${count} products` : 
                    `${count} товаров`;
            }
        }

        // Stock availability functions
        function generateAvailabilityScale(stock) {
            let squares = '';
            for (let i = 1; i <= 6; i++) {
                let cssClass = 'availability-square';
                
                if (i <= stock) {
                    cssClass += ' filled';
                    if (stock <= 2) {
                        cssClass += ' red';
                    } else if (stock <= 4) {
                        cssClass += ' yellow';
                    } else {
                        cssClass += ' green';
                    }
                } else {
                    cssClass += ' empty';
                }
                
                squares += `<div class="${cssClass}"></div>`;
            }
            return squares;
        }

        function getStockText(stock, lang) {
            if (stock <= 2) {
                return lang === 'en' ? 'Low' : 'Мало';
            } else if (stock <= 4) {
                return lang === 'en' ? 'Limited' : 'Ограничено';
            } else {
                return lang === 'en' ? 'Available' : 'Достаточно';
            }
        }

        function initProductCards() {
            // This function is no longer needed as we use onclick handlers directly
            console.log('initProductCards called but no longer needed');
        }

        // Global quote storage for multi-brand support
        let globalQuoteData = JSON.parse(localStorage.getItem('globalQuoteData') || '{}');

        // Add to cart function - only adds products, no redirect
        function addToCart(event) {
            if (event) {
                event.preventDefault();
                event.stopPropagation();
            }
            console.log('Adding products to cart - NO REDIRECT - event prevented');
            
            // Check if we have brand search data
            if (window.brandSearch && window.brandSearch.selectedProducts.length > 0) {
                const brandSearch = window.brandSearch;
                const selectedProducts = brandSearch.selectedProducts;
                const currentBrand = brandSearch.currentBrand;
                
                console.log('Adding products to cart for brand:', currentBrand);
                console.log('Selected products:', selectedProducts);
                
                // Get products for current brand (analogs or originals)
                let productsForQuote;
                if (selectedProducts.length > 0 && selectedProducts[0].originalBrand !== currentBrand) {
                    // We're viewing analogs, get the analog products
                    const matches = brandSearch.findMultipleCrossMatches(selectedProducts);
                    const currentBrandMatches = matches[currentBrand] || [];
                    productsForQuote = currentBrandMatches.map(product => ({
                        ...product,
                        brand: currentBrand,
                        quantity: 1,
                        isAnalog: true,
                        originalSelections: selectedProducts
                    }));
                } else {
                    // We're viewing original selections
                    productsForQuote = selectedProducts.filter(p => p.originalBrand === currentBrand).map(product => ({
                        ...product,
                        brand: currentBrand,
                        quantity: 1
                    }));
                }
                
                if (productsForQuote.length === 0) {
                    console.log('No products to add to cart');
                    return;
                }
                
                // Determine the correct brand for each product
                productsForQuote.forEach(product => {
                    // Ensure product has correct brand information
                    const productBrand = product.brand || product.originalBrand || currentBrand;
                    
                    // Normalize brand name
                    const normalizedBrand = normalizeBrandName(productBrand);
                    
                    // Add to global quote data by normalized brand
                    if (!globalQuoteData[normalizedBrand]) {
                        globalQuoteData[normalizedBrand] = [];
                    }
                    
                    // Check if product already exists to avoid duplicates
                    const existingProduct = globalQuoteData[normalizedBrand].find(p => 
                        (p.model === product.model || p.title === product.title) && 
                        p.capacity === product.capacity
                    );
                    
                    if (!existingProduct) {
                        globalQuoteData[normalizedBrand].push({
                            ...product,
                            brand: normalizedBrand,
                            addedDate: new Date().toISOString()
                        });
                    }
                });
                
                // Save to localStorage
                localStorage.setItem('globalQuoteData', JSON.stringify(globalQuoteData));
                
                console.log('Products saved to globalQuoteData:');
                console.log('Current globalQuoteData:', globalQuoteData);
                console.log('Brand keys:', Object.keys(globalQuoteData));
                
                // Update cart badge with animation
                updateCartBadge(true);
                
                // Just update counter without popup
                
                console.log('Products successfully added to cart, NO REDIRECT PERFORMED');
                
                // Extra protection against any delayed redirects
                setTimeout(() => {
                    console.log('TIMEOUT CHECK: Still on same page - no redirect occurred');
                }, 100);
                
            } else if (selectedProducts.length > 0) {
                // Fallback for regular selection - add to global quote data
                const productsForQuote = selectedProducts.map(product => ({
                    ...product,
                    quantity: product.quantity || 1,
                    brand: product.brand || 'other'
                }));

                // Add to globalQuoteData by brand
                productsForQuote.forEach(product => {
                    const brand = product.brand || 'other';
                    if (!globalQuoteData[brand]) {
                        globalQuoteData[brand] = [];
                    }
                    globalQuoteData[brand].push(product);
                });

                // Save to localStorage
                localStorage.setItem('globalQuoteData', JSON.stringify(globalQuoteData));
                
                // Update cart badge with animation
                updateCartBadge(true);
                
                console.log('Fallback products successfully added to cart, NO REDIRECT PERFORMED');
                
            } else {
                console.log('No products selected for cart');
            }
        }

        function generateQuote() {
            console.log('Adding products to cart...');
            
            // Check if we have brand search data
            if (window.brandSearch && window.brandSearch.selectedProducts.length > 0) {
                const brandSearch = window.brandSearch;
                const selectedProducts = brandSearch.selectedProducts;
                const currentBrand = brandSearch.currentBrand;
                
                console.log('Adding products to quote for brand:', currentBrand);
                console.log('Selected products:', selectedProducts);
                
                // Get products for current brand (analogs or originals)
                let productsForQuote;
                if (selectedProducts.length > 0 && selectedProducts[0].originalBrand !== currentBrand) {
                    // We're viewing analogs, get the analog products
                    const matches = brandSearch.findMultipleCrossMatches(selectedProducts);
                    const currentBrandMatches = matches[currentBrand] || [];
                    productsForQuote = currentBrandMatches.map(product => ({
                        ...product,
                        brand: currentBrand,
                        quantity: 1,
                        isAnalog: true,
                        originalSelections: selectedProducts
                    }));
                } else {
                    // We're viewing original selections
                    productsForQuote = selectedProducts.filter(p => p.originalBrand === currentBrand).map(product => ({
                        ...product,
                        brand: currentBrand,
                        quantity: 1
                    }));
                }
                
                if (productsForQuote.length === 0) {
                    console.log('No products to add to quote');
                    return;
                }
                
                // Add to global quote data by brand
                if (!globalQuoteData[currentBrand]) {
                    globalQuoteData[currentBrand] = [];
                }
                
                // Clear existing products for this brand and add new ones
                globalQuoteData[currentBrand] = productsForQuote;
                
                // Save to localStorage
                localStorage.setItem('globalQuoteData', JSON.stringify(globalQuoteData));
                
                // Update cart badge with animation
                updateCartBadge(true);
                
            } else if (selectedProducts.length > 0) {
                // Fallback for regular selection - add to global quote data
                const productsForQuote = selectedProducts.map(product => ({
                    ...product,
                    quantity: product.quantity || 1,
                    brand: product.brand || 'other' // Default brand if not specified
                }));

                // Add to globalQuoteData by brand
                productsForQuote.forEach(product => {
                    const brand = product.brand || 'other';
                    if (!globalQuoteData[brand]) {
                        globalQuoteData[brand] = [];
                    }
                    globalQuoteData[brand].push(product);
                });

                // Save to localStorage
                localStorage.setItem('globalQuoteData', JSON.stringify(globalQuoteData));
                
                // Update cart badge with animation
                updateCartBadge(true);
            } else {
                console.log('No products selected for quote');
            }
        }
        
        function updateCartBadge(animate = false) {
            const cartBadge = document.getElementById('cartBadge');
            
            if (cartBadge) {
                const brandCount = Object.keys(globalQuoteData).length;
                const totalProducts = Object.values(globalQuoteData).reduce((sum, brandProducts) => {
                    return sum + brandProducts.length;
                }, 0);
                
                if (totalProducts > 0) {
                    cartBadge.textContent = totalProducts;
                    cartBadge.style.display = 'flex';
                    
                    // Add animation if requested
                    if (animate) {
                        cartBadge.classList.add('updated');
                        setTimeout(() => {
                            cartBadge.classList.remove('updated');
                        }, 500);
                    }
                } else {
                    cartBadge.textContent = '0';
                    cartBadge.style.display = 'none';
                    cartBadge.classList.remove('updated');
                }
            }
        }
        
        // Keep updateQuoteButtonCounter for backward compatibility but redirect to cart
        function updateQuoteButtonCounter() {
            updateCartBadge();
        }
        
        function openQuotePage() {
            if (Object.keys(globalQuoteData).length > 0) {
                // Store comprehensive quote data
                localStorage.setItem('globalQuoteData', JSON.stringify(globalQuoteData));
                localStorage.setItem('quoteCurrency', currentCurrency || 'usd');
                localStorage.setItem('quoteExchangeRates', JSON.stringify(exchangeRates || {usd: 1, rub: 75.50, eur: 0.85}));
                
                // Navigate to quote page
                window.location.href = 'quote.html';
            } else {
                alert('КП пуст. Добавьте товары из разных брендов.');
            }
        }

        // Generate request - add to cart without redirect
        function generateRequest() {
            // Add to requests instead of KP
            addToRequests();
        }

        // Add selected products to requests (without prices)
        function addToRequests(event) {
            if (event) {
                event.preventDefault();
                event.stopPropagation();
            }
            
            console.log('Adding products to requests - for supplier inquiries');
            
            // Check if we have brand search data
            if (window.brandSearch && window.brandSearch.selectedProducts.length > 0) {
                const brandSearch = window.brandSearch;
                const selectedProducts = brandSearch.selectedProducts;
                const currentBrand = brandSearch.currentBrand;
                
                console.log('Adding products to requests for brand:', currentBrand);
                console.log('Selected products:', selectedProducts);
                
                // Get products for current brand (analogs or originals)
                let productsForRequest;
                if (selectedProducts.length > 0 && selectedProducts[0].originalBrand !== currentBrand) {
                    // We're viewing analogs, get the analog products
                    const matches = brandSearch.findMultipleCrossMatches(selectedProducts);
                    const currentBrandMatches = matches[currentBrand] || [];
                    productsForRequest = currentBrandMatches.map(product => ({
                        ...product,
                        brand: currentBrand,
                        quantity: 1,
                        isAnalog: true,
                        originalSelections: selectedProducts,
                        // Remove price info for requests
                        price: undefined,
                        price_rub: undefined
                    }));
                } else {
                    // We're viewing original selections
                    productsForRequest = selectedProducts.filter(p => p.originalBrand === currentBrand).map(product => ({
                        ...product,
                        brand: currentBrand,
                        quantity: 1,
                        // Remove price info for requests
                        price: undefined,
                        price_rub: undefined
                    }));
                }
                
                if (productsForRequest.length === 0) {
                    console.log('No products to add to requests');
                    return;
                }
                
                // Get existing request products
                let requestProducts = JSON.parse(localStorage.getItem('requestProducts') || '[]');
                
                // Add new products to requests
                productsForRequest.forEach(product => {
                    // Check if product already exists to avoid duplicates
                    const existingProduct = requestProducts.find(p => 
                        (p.model === product.model || p.title === product.title) && 
                        p.brand === product.brand &&
                        p.capacity === product.capacity
                    );
                    
                    if (!existingProduct) {
                        requestProducts.push({
                            ...product,
                            id: `request_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
                            model: product.model || product.title,
                            type: product.type || 'HVAC Equipment',
                            specs: product.specs || `${product.cooling_capacity || product.capacity || 'N/A'} kW`,
                            addedDate: new Date().toISOString()
                        });
                    }
                });
                
                // Save to localStorage
                localStorage.setItem('requestProducts', JSON.stringify(requestProducts));
                
                console.log('Products saved to requestProducts:', requestProducts);
                
                // Update cart badge
                updateCartBadge(true);
                
                console.log('Products successfully added to requests, NO REDIRECT PERFORMED');
                
            } else if (selectedProducts.length > 0) {
                console.log('Using fallback selectedProducts for requests');
                
                // Fallback for regular selected products
                let requestProducts = JSON.parse(localStorage.getItem('requestProducts') || '[]');
                
                selectedProducts.forEach(product => {
                    const existingProduct = requestProducts.find(p => 
                        (p.model === product.model || p.title === product.title) && 
                        p.brand === product.brand
                    );
                    
                    if (!existingProduct) {
                        requestProducts.push({
                            ...product,
                            id: `request_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
                            model: product.model || product.title,
                            type: product.type || 'HVAC Equipment',
                            specs: product.specs || `${product.capacity || 'N/A'} BTU/h`,
                            // Remove price info for requests
                            price: undefined,
                            price_rub: undefined,
                            addedDate: new Date().toISOString()
                        });
                    }
                });
                
                localStorage.setItem('requestProducts', JSON.stringify(requestProducts));
                updateCartBadge(true);
                
                console.log('Products added to requests from selectedProducts');
            } else {
                console.log('No products selected for requests');
            }
        }

        // Add to catalog for technical specifications
        function openCatalog() {
            addToCatalog();
        }

        // Add selected products to catalog (for technical comparison)
        function addToCatalog(event) {
            if (event) {
                event.preventDefault();
                event.stopPropagation();
            }
            
            console.log('Adding products to catalog - for technical specifications');
            
            // Check if we have brand search data
            if (window.brandSearch && window.brandSearch.selectedProducts.length > 0) {
                const brandSearch = window.brandSearch;
                const selectedProducts = brandSearch.selectedProducts;
                const currentBrand = brandSearch.currentBrand;
                
                console.log('Adding products to catalog for brand:', currentBrand);
                console.log('Selected products:', selectedProducts);
                
                // Get products for current brand (analogs or originals)
                let productsForCatalog;
                if (selectedProducts.length > 0 && selectedProducts[0].originalBrand !== currentBrand) {
                    // We're viewing analogs, get the analog products
                    const matches = brandSearch.findMultipleCrossMatches(selectedProducts);
                    const currentBrandMatches = matches[currentBrand] || [];
                    productsForCatalog = currentBrandMatches.map(product => ({
                        ...product,
                        brand: currentBrand,
                        quantity: 1,
                        isAnalog: true,
                        originalSelections: selectedProducts
                    }));
                } else {
                    // We're viewing original selections
                    productsForCatalog = selectedProducts.filter(p => p.originalBrand === currentBrand).map(product => ({
                        ...product,
                        brand: currentBrand,
                        quantity: 1
                    }));
                }
                
                if (productsForCatalog.length === 0) {
                    console.log('No products to add to catalog');
                    return;
                }
                
                // Get existing catalog products
                let catalogProducts = JSON.parse(localStorage.getItem('catalogProducts') || '[]');
                
                // Add new products to catalog
                productsForCatalog.forEach(product => {
                    // Check if product already exists to avoid duplicates
                    const existingProduct = catalogProducts.find(p => 
                        (p.model === product.model || p.title === product.title) && 
                        p.brand === product.brand &&
                        p.capacity === product.capacity
                    );
                    
                    if (!existingProduct) {
                        catalogProducts.push({
                            ...product,
                            id: `catalog_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
                            model: product.model || product.title,
                            type: product.type || 'HVAC Equipment',
                            specs: product.specs || `${product.cooling_capacity || product.capacity || 'N/A'} kW`,
                            addedDate: new Date().toISOString(),
                            // Keep all technical specifications for comparison
                            cooling_capacity: product.cooling_capacity,
                            heating_capacity: product.heating_capacity,
                            power: product.power,
                            airflow: product.airflow,
                            energy_class: product.energy_class,
                            price: product.price,
                            price_rub: product.price_rub
                        });
                    }
                });
                
                // Save to localStorage
                localStorage.setItem('catalogProducts', JSON.stringify(catalogProducts));
                
                console.log('Products saved to catalogProducts:', catalogProducts);
                
                // Update cart badge
                updateCartBadge(true);
                
                console.log('Products successfully added to catalog');
                
            } else if (selectedProducts.length > 0) {
                console.log('Using fallback selectedProducts for catalog');
                
                // Fallback for regular selected products
                let catalogProducts = JSON.parse(localStorage.getItem('catalogProducts') || '[]');
                
                selectedProducts.forEach(product => {
                    const existingProduct = catalogProducts.find(p => 
                        (p.model === product.model || p.title === product.title) && 
                        p.brand === product.brand
                    );
                    
                    if (!existingProduct) {
                        catalogProducts.push({
                            ...product,
                            id: `catalog_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
                            model: product.model || product.title,
                            type: product.type || 'HVAC Equipment',
                            specs: product.specs || `${product.capacity || 'N/A'} BTU/h`,
                            addedDate: new Date().toISOString()
                        });
                    }
                });
                
                localStorage.setItem('catalogProducts', JSON.stringify(catalogProducts));
                updateCartBadge(true);
                
                console.log('Products added to catalog from selectedProducts');
            } else {
                console.log('No products selected for catalog');
            }
        }

        // Reset all selected products
        function resetAllSelections() {
            console.log('Resetting all selections...');
            
            // Clear selected products array
            selectedProducts = [];
            
            // Clear all product card selections
            document.querySelectorAll('.product-card').forEach(card => {
                card.classList.remove('selected', 'analog-product');
                card.removeAttribute('data-selection-order');
                
                // Clear checkmark highlighting
                const selectButton = card.querySelector('.btn-select');
                if (selectButton) {
                    selectButton.classList.remove('selected');
                }
                
                // Remove compatibility displays
                const compatibilityDisplay = card.querySelector('.compatibility-percentage');
                if (compatibilityDisplay) {
                    compatibilityDisplay.remove();
                }
            });
            
            // Reset brand search selections if available
            if (window.brandSearch) {
                window.brandSearch.selectedProducts = [];
                window.brandSearch.updateSelectionCounter();
                window.brandSearch.updateTotalPrice();
            }
            
            // Clear quote data
            globalQuoteData = {};
            localStorage.removeItem('globalQuoteData');
            updateCartBadge();
            
            // Hide selection panel
            const selectedPanel = document.getElementById('selectedPanel');
            if (selectedPanel) {
                selectedPanel.classList.remove('active');
            }
            
            // Update UI
            updateSelectionPanel();
            
            console.log('All selections cleared');
        }
        
        function initQuoteSystem() {
            // Initialize quote counter from localStorage
            globalQuoteData = JSON.parse(localStorage.getItem('globalQuoteData') || '{}');
            updateCartBadge();
            
            // Add event listener to quote button - NO REDIRECT
            const quoteButton = document.getElementById('quoteButton');
            if (quoteButton) {
                // Remove any existing listeners by cloning
                const newQuoteButton = quoteButton.cloneNode(true);
                quoteButton.parentNode.replaceChild(newQuoteButton, quoteButton);
                
                newQuoteButton.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    e.stopImmediatePropagation();
                    console.log('QUOTE BUTTON CLICKED - ADDING TO CART');
                    addToCart(e);
                    return false;
                });
                
                console.log('Quote button listener added - NO REDIRECT WILL HAPPEN');
            }
            
            console.log('Quote system initialized with data:', globalQuoteData);
        }

        // Language switching functionality
        function initLanguageToggle() {
            const languageSelect = document.getElementById('languageSelect');
            const elementsWithTranslations = document.querySelectorAll('[data-en][data-ru]');
            const inputElement = document.getElementById('messageInput');
            
            let currentLang = localStorage.getItem('preferredLanguage') || 'en';
            languageSelect.value = currentLang;
            switchLanguage(currentLang);
            
            languageSelect.addEventListener('change', function() {
                const newLang = this.value;
                if (newLang !== currentLang) {
                    switchLanguage(newLang);
                    currentLang = newLang;
                    localStorage.setItem('preferredLanguage', newLang);
                }
            });
            
            function switchLanguage(lang) {
                elementsWithTranslations.forEach(element => {
                    const translation = element.getAttribute(`data-${lang}`);
                    if (translation) {
                        element.innerHTML = translation;
                    }
                });
                
                // Update input placeholder
                if (inputElement) {
                    const placeholder = inputElement.getAttribute(`data-${lang}-placeholder`);
                    if (placeholder) {
                        inputElement.placeholder = placeholder;
                    }
                }
                
                // Update AI search placeholder
                const aiSearchInput = document.getElementById('aiSearchInput');
                if (aiSearchInput) {
                    const aiPlaceholder = aiSearchInput.getAttribute(`data-${lang}-placeholder`);
                    if (aiPlaceholder) {
                        aiSearchInput.placeholder = aiPlaceholder;
                    }
                }
                
                // Update language select dropdown
                languageSelect.value = lang;
                
                document.documentElement.lang = lang === 'ru' ? 'ru' : 'en';
            }
        }


        // Chatbot functionality
        function initChatbot() {
            const toggle = document.getElementById('chatbotToggle');
            const window = document.getElementById('chatbotWindow');
            const sendBtn = document.getElementById('sendBtn');
            const messageInput = document.getElementById('messageInput');
            const messagesContainer = document.getElementById('chatMessages');

            // Toggle chatbot window
            toggle.addEventListener('click', function() {
                window.classList.toggle('active');
            });

            // Send message functionality
            function sendMessage() {
                const message = messageInput.value.trim();
                if (message) {
                    // Add user message
                    addMessage(message, 'user');
                    messageInput.value = '';
                    
                    // Simulate AI response
                    setTimeout(() => {
                        addAIResponse(message);
                    }, 1000);
                }
            }

            sendBtn.addEventListener('click', sendMessage);
            messageInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });

            function addMessage(text, type = 'ai') {
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${type}`;
                messageDiv.innerHTML = `<div class="message-content">${text}</div>`;
                messagesContainer.appendChild(messageDiv);
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }

            function addAIResponse(userMessage) {
                let response = '';
                const lowerMessage = userMessage.toLowerCase();
                const currentLang = localStorage.getItem('preferredLanguage') || 'en';
                
                if (lowerMessage.includes('scout') || lowerMessage.includes('поиск')) {
                    response = currentLang === 'en' ? 
                        'Search module processes product search with 94% accuracy. The module is active and serves 2.4k requests per day.' :
                        'Модуль поиска обрабатывает поиск продуктов с точностью 94%. Модуль активен и обслуживает 2,4к запросов в день.';
                } else if (lowerMessage.includes('match') || lowerMessage.includes('сопоставление')) {
                    response = currentLang === 'en' ? 
                        'Analysis module shows 91% configuration accuracy. The system is active and works in real time.' :
                        'Модуль анализа показывает 91% точности конфигурации. Система активна и работает в реальном времени.';
                } else if (lowerMessage.includes('status') || lowerMessage.includes('статус')) {
                    response = currentLang === 'en' ? 
                        'Active modules: Search and Analysis. In development: Analytics Overview and Optimization AI.' :
                        'Активные модули: Поиск и Анализ. В разработке: Аналитический обзор и Optimization AI.';
                } else if (lowerMessage.includes('help') || lowerMessage.includes('помощь')) {
                    response = currentLang === 'en' ? 
                        'I can help with information about modules, their status, metrics and development plans. Just ask about a specific module!' :
                        'Я могу помочь с информацией о модулях, их статусе, метриках и планах развития. Просто спросите о конкретном модуле!';
                } else {
                    response = currentLang === 'en' ? 
                        'Thank you for your question! I work with information about HVAC Markets modules. Ask about module status, metrics or development plans.' :
                        'Спасибо за вопрос! Я работаю с информацией о модулях HVAC Markets. Спросите о статусе модулей, метриках или планах развития.';
                }
                
                addMessage(response, 'ai');
            }
        }

        // Animation initialization
        function initAnimations() {
            const observerOptions = {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            };

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                    }
                });
            }, observerOptions);

            // Observe module cards
            document.querySelectorAll('.module-card').forEach((card, index) => {
                card.classList.add('fade-in');
                card.style.transitionDelay = `${index * 0.1}s`;
                observer.observe(card);
            });
        }

        // Category row functionality
        function initCategoryTabs() {
            const categoryBtns = document.querySelectorAll('.category-btn');
            const categoryMenus = document.querySelectorAll('.category-menu');
            const subcategoryOptions = document.querySelectorAll('.subcategory-option');

            // Handle category button clicks
            categoryBtns.forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    
                    const menu = this.parentElement.querySelector('.category-menu');
                    const isOpen = menu.classList.contains('show');
                    
                    // Close all other menus
                    categoryMenus.forEach(m => {
                        m.classList.remove('show');
                    });
                    categoryBtns.forEach(b => {
                        b.classList.remove('open');
                    });
                    
                    // Toggle current menu
                    if (!isOpen) {
                        menu.classList.add('show');
                        this.classList.add('open');
                    }
                });
            });

            // Handle category activation (making category active/inactive)
            categoryBtns.forEach(btn => {
                btn.addEventListener('dblclick', function() {
                    const isActive = this.classList.contains('active');
                    
                    if (isActive) {
                        // Deactivate category
                        this.classList.remove('active');
                        const category = this.getAttribute('data-category');
                        deactivateCategory(category);
                    } else {
                        // Activate category
                        this.classList.add('active');
                        const category = this.getAttribute('data-category');
                        activateCategory(category);
                    }
                });
            });

            // Handle subcategory selection
            subcategoryOptions.forEach(option => {
                option.addEventListener('click', function() {
                    const parentDropdown = this.closest('.category-dropdown');
                    const categoryBtn = parentDropdown.querySelector('.category-btn');
                    const subcategory = this.getAttribute('data-subcategory');
                    const category = categoryBtn.getAttribute('data-category');
                    
                    // Remove active from all subcategories in this dropdown
                    const siblingOptions = parentDropdown.querySelectorAll('.subcategory-option');
                    siblingOptions.forEach(o => o.classList.remove('active'));
                    
                    // Add active to clicked option
                    this.classList.add('active');

                    // Handle exclude option
                    if (subcategory === 'exclude') {
                        // Mark category as excluded
                        categoryBtn.classList.remove('active');
                        categoryBtn.classList.add('excluded');
                        
                        // Hide this category section completely
                        excludeCategory(category);
                    } else {
                        // Normal subcategory selection
                        categoryBtn.classList.remove('excluded');
                        categoryBtn.classList.add('active');
                        
                        // Filter products
                        filterProductsByCategory(category);
                        filterProductsBySubcategory(subcategory);
                    }

                    // Close menu
                    const menu = parentDropdown.querySelector('.category-menu');
                    menu.classList.remove('show');
                    categoryBtn.classList.remove('open');
                });
            });

            // Close menus when clicking outside
            document.addEventListener('click', function() {
                categoryMenus.forEach(menu => {
                    menu.classList.remove('show');
                });
                categoryBtns.forEach(btn => {
                    btn.classList.remove('open');
                });
            });

            // Prevent menu closing when clicking inside
            categoryMenus.forEach(menu => {
                menu.addEventListener('click', function(e) {
                    e.stopPropagation();
                });
            });
        }

        // Activate category function
        function activateCategory(category) {
            filterProductsByCategory(category);
        }

        // Deactivate category function
        function deactivateCategory(category) {
            // Show all products when category is deactivated
            const products = document.querySelectorAll('.product-card');
            products.forEach(product => {
                product.style.display = 'block';
            });
            updateResultsCount(products.length);
        }

        // Exclude category function
        function excludeCategory(category) {
            // Hide all products from this category
            const products = document.querySelectorAll('.product-card');
            products.forEach(product => {
                const productCategory = product.getAttribute('data-category');
                if (productCategory === category) {
                    product.style.display = 'none';
                }
            });
            
            // Update results count
            const visibleProducts = document.querySelectorAll('.product-card[style*="block"], .product-card:not([style*="none"])');
            updateResultsCount(visibleProducts.length);
        }

        // Filter products by category
        function filterProductsByCategory(category) {
            const products = document.querySelectorAll('.product-card');
            products.forEach(product => {
                const productCategory = product.getAttribute('data-category');
                if (!productCategory || productCategory === category) {
                    product.style.display = 'block';
                } else {
                    product.style.display = 'none';
                }
            });
            updateResultsCount(document.querySelectorAll('.product-card[style*="block"]').length);
        }

        // Filter products by subcategory
        function filterProductsBySubcategory(subcategory) {
            const products = document.querySelectorAll('.product-card');
            products.forEach(product => {
                const productSubcategory = product.getAttribute('data-subcategory');
                if (!productSubcategory || productSubcategory === subcategory) {
                    product.style.display = 'block';
                } else {
                    product.style.display = 'none';
                }
            });
            updateResultsCount(document.querySelectorAll('.product-card[style*="block"]').length);
        }

        // Clear all filters functionality
        function clearAllFilters() {
            // Clear checkboxes
            const checkboxes = document.querySelectorAll('.filter-checkbox');
            checkboxes.forEach(checkbox => {
                checkbox.classList.remove('checked');
                const input = checkbox.querySelector('input[type="checkbox"]');
                if (input) input.checked = false;
            });

            // Reset range inputs
            const rangeInputs = document.querySelectorAll('input[type="range"]');
            rangeInputs.forEach(input => {
                input.value = input.min || 0;
                const display = input.parentElement.querySelector('.range-display');
                if (display) {
                    display.textContent = input.value;
                }
            });

            // Reset text inputs
            const textInputs = document.querySelectorAll('.filter-input input[type="text"], .filter-input input[type="number"]');
            textInputs.forEach(input => {
                input.value = '';
            });

            // Reset selects
            const selects = document.querySelectorAll('.filter-input select');
            selects.forEach(select => {
                select.selectedIndex = 0;
            });

            // Reset excluded categories
            const categoryBtns = document.querySelectorAll('.category-btn');
            categoryBtns.forEach(btn => {
                btn.classList.remove('excluded');
            });

            // Reset subcategory options to first non-exclude option
            const subcategoryOptions = document.querySelectorAll('.subcategory-option');
            subcategoryOptions.forEach(option => {
                option.classList.remove('active');
            });

            // Set first non-exclude subcategory as active for each category
            const categoryDropdowns = document.querySelectorAll('.category-dropdown');
            categoryDropdowns.forEach(dropdown => {
                const firstNonExcludeOption = dropdown.querySelector('.subcategory-option:not(.exclude-option)');
                if (firstNonExcludeOption) {
                    firstNonExcludeOption.classList.add('active');
                }
            });

            // Show all products
            const products = document.querySelectorAll('.product-card');
            products.forEach(product => {
                product.style.display = 'block';
            });

            updateResultsCount(products.length);
        }

        // Initialize new range sliders
        function initRangeSliders() {
            const rangeInputs = document.querySelectorAll('input[type="range"]');
            rangeInputs.forEach(input => {
                const display = input.parentElement.querySelector('.range-display');
                if (display) {
                    // Update display on input
                    input.addEventListener('input', function() {
                        const value = this.value;
                        if (this.id === 'priceRange') {
                            display.textContent = formatPrice(parseInt(value));
                        } else if (this.id === 'areaRange') {
                            display.textContent = value + ' м²';
                        } else if (this.id === 'capacityRange') {
                            display.textContent = value + ' BTU';
                        } else {
                            display.textContent = value;
                        }
                    });

                    // Trigger initial display update
                    input.dispatchEvent(new Event('input'));
                }
            });
        }

        // Initialize new checkbox filters
        function initCheckboxFilters() {
            const checkboxes = document.querySelectorAll('.filter-checkbox');
            checkboxes.forEach(checkbox => {
                checkbox.addEventListener('click', function() {
                    this.classList.toggle('checked');
                    const input = this.querySelector('input[type="checkbox"]');
                    if (input) {
                        input.checked = this.classList.contains('checked');
                    }
                    filterProducts();
                });
            });
        }

        // Mobile menu functionality
        function initMobileMenu() {
            const mobileMenuToggle = document.getElementById('mobileMenuToggle');
            const mobileMenu = document.getElementById('mobileMenu');
            const mobileMenuItems = document.querySelectorAll('.mobile-menu-item');

            if (mobileMenuToggle && mobileMenu) {
                mobileMenuToggle.addEventListener('click', function() {
                    this.classList.toggle('active');
                    mobileMenu.classList.toggle('active');
                    
                    // Prevent body scroll when menu is open
                    if (mobileMenu.classList.contains('active')) {
                        document.body.style.overflow = 'hidden';
                    } else {
                        document.body.style.overflow = '';
                    }
                });

                // Close menu when clicking on menu items
                mobileMenuItems.forEach(item => {
                    item.addEventListener('click', function() {
                        mobileMenuToggle.classList.remove('active');
                        mobileMenu.classList.remove('active');
                        document.body.style.overflow = '';
                    });
                });

                // Close menu when clicking outside
                document.addEventListener('click', function(e) {
                    if (!mobileMenu.contains(e.target) && !mobileMenuToggle.contains(e.target)) {
                        mobileMenuToggle.classList.remove('active');
                        mobileMenu.classList.remove('active');
                        document.body.style.overflow = '';
                    }
                });

                // Handle window resize
                window.addEventListener('resize', function() {
                    if (window.innerWidth > 768) {
                        mobileMenuToggle.classList.remove('active');
                        mobileMenu.classList.remove('active');
                        document.body.style.overflow = '';
                    }
                });
            }
        }

        // Navigation menu functionality
        function initNavMenu() {
            const navItems = document.querySelectorAll('.nav-item[data-module]');
            const mobileMenuItems = document.querySelectorAll('.mobile-menu-item[data-module]');
            const moduleItems = [...navItems, ...mobileMenuItems];
            
            moduleItems.forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    const targetModule = this.getAttribute('data-module');
                    
                    // Switch to the module
                    switchToModule(targetModule);
                    
                    // Close mobile menu if open
                    const mobileMenuToggle = document.getElementById('mobileMenuToggle');
                    const mobileMenu = document.getElementById('mobileMenu');
                    if (mobileMenu && mobileMenuToggle) {
                        mobileMenuToggle.classList.remove('active');
                        mobileMenu.classList.remove('active');
                        document.body.style.overflow = '';
                    }
                });
            });
        }

        // Function to switch to a specific module
        function switchToModule(moduleId) {
            // Remove active class from all nav items
            const navItems = document.querySelectorAll('.nav-item[data-module]');
            const mobileMenuItems = document.querySelectorAll('.mobile-menu-item[data-module]');
            
            navItems.forEach(item => item.classList.remove('active'));
            mobileMenuItems.forEach(item => item.classList.remove('active'));
            
            // Add active class to target nav items
            const targetNavItems = document.querySelectorAll(`[data-module="${moduleId}"]`);
            targetNavItems.forEach(item => item.classList.add('active'));
            
            // Switch module content directly
            const moduleContent = document.querySelector(`[data-content="${moduleId}"].module-content`);
            
            if (moduleContent) {
                // Remove active class from all module content
                const allModuleContent = document.querySelectorAll('.module-content');
                allModuleContent.forEach(content => content.classList.remove('active'));
                
                // Add active class to target content
                moduleContent.classList.add('active');
            }
        }

        // Equipment Sidebar functionality
        function initEquipmentSidebar() {
            const equipmentItems = document.querySelectorAll('.equipment-type-item');
            
            equipmentItems.forEach(item => {
                item.addEventListener('click', function() {
                    const subcategory = this.getAttribute('data-subcategory');
                    
                    // Remove active class from all items
                    equipmentItems.forEach(i => i.classList.remove('active'));
                    
                    // Add active class to clicked item
                    this.classList.add('active');
                    
                    // Update current subcategory
                    currentSubcategory = subcategory;
                    
                    // Update filters based on equipment type
                    updateFiltersForEquipmentType(subcategory);
                    
                    // Filter products
                    filterProducts();
                });
            });
        }

        // Update filters based on selected equipment type
        function updateFiltersForEquipmentType(subcategory) {
            const technologyFilter = document.querySelector('#technologyFilter');
            const heatPumpFilter = document.querySelector('#heatPumpFilter');
            const wifiFilter = document.querySelector('#wifiFilter');
            
            if (!technologyFilter || !heatPumpFilter || !wifiFilter) return;
            
            // Clear current selections
            technologyFilter.selectedIndex = 0;
            heatPumpFilter.selectedIndex = 0;
            wifiFilter.selectedIndex = 0;
            
            // Update filters based on equipment subcategory
            if (['split-systems', 'multi-split', 'vrf', 'accessories'].includes(subcategory)) {
                // Air Conditioning filters
                updateTechnologyFilter(['full-dc-inverter', 'inverter', 'on-off']);
                updateHeatPumpFilter(['yes', 'no']);
                updateWifiFilter(['yes', 'no']);
            } else if (['supply-ventilation', 'exhaust-ventilation', 'heat-recovery', 'air-handling', 'fans'].includes(subcategory)) {
                // Ventilation filters
                updateTechnologyFilter(['ec-motor', 'ac-motor', 'variable-speed']);
                updateHeatPumpFilter(['heat-recovery', 'no']);
                updateWifiFilter(['yes', 'no']);
            } else if (['heat-pumps', 'boilers', 'radiators', 'floor-heating', 'heat-exchangers'].includes(subcategory)) {
                // Heating filters
                updateTechnologyFilter(['inverter', 'modulating', 'on-off']);
                updateHeatPumpFilter(['air-source', 'ground-source', 'no']);
                updateWifiFilter(['yes', 'no']);
            }
        }

        function updateTechnologyFilter(options) {
            const technologyFilter = document.querySelector('#technologyFilter');
            if (!technologyFilter) return;
            
            const currentLang = localStorage.getItem('preferredLanguage') || 'en';
            
            // Clear existing options except "All"
            technologyFilter.innerHTML = `<option value="">${currentLang === 'en' ? 'All' : 'Все'}</option>`;
            
            // Add new options based on equipment type
            options.forEach(option => {
                const optionElement = document.createElement('option');
                optionElement.value = option;
                
                if (option === 'full-dc-inverter') {
                    optionElement.textContent = currentLang === 'en' ? 'Full DC Inverter' : 'Full DC Инвертор';
                } else if (option === 'inverter') {
                    optionElement.textContent = currentLang === 'en' ? 'Inverter' : 'Инвертор';
                } else if (option === 'on-off') {
                    optionElement.textContent = currentLang === 'en' ? 'On/Off' : 'Вкл/Выкл';
                } else if (option === 'ec-motor') {
                    optionElement.textContent = currentLang === 'en' ? 'EC Motor' : 'EC Двигатель';
                } else if (option === 'ac-motor') {
                    optionElement.textContent = currentLang === 'en' ? 'AC Motor' : 'AC Двигатель';
                } else if (option === 'variable-speed') {
                    optionElement.textContent = currentLang === 'en' ? 'Variable Speed' : 'Переменная скорость';
                } else if (option === 'modulating') {
                    optionElement.textContent = currentLang === 'en' ? 'Modulating' : 'Модулирующий';
                }
                
                technologyFilter.appendChild(optionElement);
            });
        }

        function updateHeatPumpFilter(options) {
            const heatPumpFilter = document.querySelector('#heatPumpFilter');
            if (!heatPumpFilter) return;
            
            const currentLang = localStorage.getItem('preferredLanguage') || 'en';
            
            // Clear existing options except "All"
            heatPumpFilter.innerHTML = `<option value="">${currentLang === 'en' ? 'All' : 'Все'}</option>`;
            
            // Add new options
            options.forEach(option => {
                const optionElement = document.createElement('option');
                optionElement.value = option;
                
                if (option === 'yes') {
                    optionElement.textContent = currentLang === 'en' ? 'Yes' : 'Да';
                } else if (option === 'no') {
                    optionElement.textContent = currentLang === 'en' ? 'No' : 'Нет';
                } else if (option === 'heat-recovery') {
                    optionElement.textContent = currentLang === 'en' ? 'Heat Recovery' : 'Рекуперация';
                } else if (option === 'air-source') {
                    optionElement.textContent = currentLang === 'en' ? 'Air Source' : 'Воздух-вода';
                } else if (option === 'ground-source') {
                    optionElement.textContent = currentLang === 'en' ? 'Ground Source' : 'Земля-вода';
                }
                
                heatPumpFilter.appendChild(optionElement);
            });
        }

        function updateWifiFilter(options) {
            const wifiFilter = document.querySelector('#wifiFilter');
            if (!wifiFilter) return;
            
            const currentLang = localStorage.getItem('preferredLanguage') || 'en';
            
            // Wi-Fi options are usually the same for all equipment types
            wifiFilter.innerHTML = `
                <option value="">${currentLang === 'en' ? 'All' : 'Все'}</option>
                <option value="yes">${currentLang === 'en' ? 'Yes' : 'Да'}</option>
                <option value="no">${currentLang === 'en' ? 'No' : 'Нет'}</option>
            `;
        }

        // Update equipment category selection
        function updateEquipmentCategory(category) {
            console.log('Selected equipment category:', category);
            
            // Here you can add logic to filter products based on equipment category
            // For example, update the product search results
            filterProductsByCategory(category);
        }

        // Filter products by equipment category
        function filterProductsByCategory(category) {
            // This function would implement the filtering logic
            // For now, just log the category for demonstration
            console.log('Filtering products by category:', category);
            
            // You can implement actual product filtering here
            // For example, show/hide product cards based on category
        }

        // Initialize header functionality
        document.addEventListener('DOMContentLoaded', function() {
            initHeaderFunctionality();
            initModuleNavigation();
            handleInitialHash();
            ensureActiveModule();
        });

        // Ensure at least one module is always active
        function ensureActiveModule() {
            const activeModule = document.querySelector('.module-content.active');
            if (!activeModule) {
                // If no module is active, activate scout by default
                const scoutModule = document.querySelector('[data-content="scout"]');
                if (scoutModule) {
                    scoutModule.classList.add('active');
                }
                
                // Also update navigation
                const scoutNav = document.querySelector('[data-module="scout"]');
                if (scoutNav) {
                    scoutNav.classList.add('active');
                }
            }
        }


        // Handle initial hash navigation
        function handleInitialHash() {
            const hash = window.location.hash.substring(1);
            if (hash) {
                const targetModule = document.querySelector(`[data-content="${hash}"]`);
                if (targetModule) {
                    // Hide all modules
                    document.querySelectorAll('.module-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    
                    // Show target module
                    targetModule.classList.add('active');
                    
                    // Update navigation active state
                    document.querySelectorAll('[data-module]').forEach(nav => nav.classList.remove('active'));
                    const activeNav = document.querySelector(`[data-module="${hash}"]`);
                    if (activeNav) {
                        activeNav.classList.add('active');
                    }
                    
                    // Scroll to module
                    setTimeout(() => {
                        const contentArea = document.querySelector('.main-content-area');
                        if (contentArea) {
                            contentArea.scrollIntoView({ 
                                behavior: 'smooth',
                                block: 'start'
                            });
                        }
                    }, 100);
                } else {
                    // If hash doesn't match any module, ensure scout is active
                    document.querySelectorAll('.module-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    const scoutModule = document.querySelector('[data-content="scout"]');
                    if (scoutModule) {
                        scoutModule.classList.add('active');
                    }
                }
            }
        }

        // Also handle hash changes (when user navigates with back/forward)
        window.addEventListener('hashchange', function() {
            handleInitialHash();
        });

        function initHeaderFunctionality() {
            const searchBtn = document.getElementById('searchBtn');
            const cartBtn = document.getElementById('cartBtn');
            const searchModal = document.getElementById('searchModal');
            const searchModalClose = document.getElementById('searchModalClose');
            
            // Search button functionality
            if (searchBtn) {
                searchBtn.addEventListener('click', function() {
                    searchModal.classList.add('active');
                    document.body.style.overflow = 'hidden';
                    
                    // Focus on search input
                    const searchInput = document.getElementById('aiSearchInput');
                    if (searchInput) {
                        setTimeout(() => searchInput.focus(), 100);
                    }
                });
            }
            
            // Close search modal
            if (searchModalClose) {
                searchModalClose.addEventListener('click', closeSearchModal);
            }
            
            // Close modal when clicking outside
            if (searchModal) {
                searchModal.addEventListener('click', function(e) {
                    if (e.target === searchModal) {
                        closeSearchModal();
                    }
                });
            }
            
            // Cart functionality - open cart modal
            if (cartBtn) {
                cartBtn.addEventListener('click', function() {
                    window.open('cart.html', '_blank');
                });
            }
            
            // Initialize cart badge from stored data
            initQuoteSystem();
        }
        
        function closeSearchModal() {
            const searchModal = document.getElementById('searchModal');
            if (searchModal) {
                searchModal.classList.remove('active');
                document.body.style.overflow = '';
            }
        }
        

        // Module navigation functionality
        function initModuleNavigation() {
            const navItems = document.querySelectorAll('[data-module]');
            const moduleContents = document.querySelectorAll('[data-content]');
            
            
            navItems.forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    const targetModule = this.getAttribute('data-module');
                    
                    // Remove active class from all nav items
                    navItems.forEach(nav => nav.classList.remove('active'));
                    
                    // Add active class to clicked nav item
                    this.classList.add('active');
                    
                    // Hide all module contents
                    const moduleContents = document.querySelectorAll('.module-content');
                    moduleContents.forEach(content => {
                        content.classList.remove('active');
                    });
                    
                    // Show target module content
                    const targetContent = document.querySelector(`[data-content="${targetModule}"]`);
                    if (targetContent) {
                        targetContent.classList.add('active');
                        
                        
                        // Smooth scroll to content area
                        const contentArea = document.querySelector('.main-content-area');
                        if (contentArea) {
                            contentArea.scrollIntoView({ 
                                behavior: 'smooth',
                                block: 'start'
                            });
                        }
                    }
                });
            });
            
            // Initialize scout tabs functionality
            initScoutTabs();
        }

        // Scout tabs functionality (for sub-navigation within modules)
        function initScoutTabs() {
            const scoutTabs = document.querySelectorAll('[data-scout-module]');
            const scoutContents = document.querySelectorAll('[data-scout-content]');
            
            scoutTabs.forEach(tab => {
                tab.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    const targetContent = this.getAttribute('data-scout-module');
                    const parentModule = this.closest('.module-content');
                    
                    if (parentModule) {
                        // Remove active class from tabs in this module
                        parentModule.querySelectorAll('.scout-tab').forEach(t => t.classList.remove('active'));
                        
                        // Add active class to clicked tab
                        this.classList.add('active');
                        
                        // Hide all scout contents in this module
                        parentModule.querySelectorAll('[data-scout-content]').forEach(content => {
                            content.classList.remove('active');
                        });
                        
                        // Show target scout content
                        const targetElement = parentModule.querySelector(`[data-scout-content="${targetContent}"]`);
                        if (targetElement) {
                            targetElement.classList.add('active');
                        }
                    }
                });
            });
        }
    </script>
    
    <!-- AI Search Modal -->
    <div class="search-modal" id="searchModal">
        <div class="search-modal-content">
            <div class="search-modal-header">
                <h3 class="search-modal-title">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"/>
                    </svg>
                    <span data-en="AI Search" data-ru="ИИ Поиск">AI Search</span>
                </h3>
                <button class="search-modal-close" id="searchModalClose">&times;</button>
            </div>
            <div class="search-modal-body">
                <div class="ai-search-interface">
                    <div class="ai-chat-container">
                        <div class="ai-chat-messages" id="modalChatMessages">
                            <div class="ai-message">
                                <div class="ai-avatar">🤖</div>
                                <div class="ai-message-content" data-en="Hello! I can help you find HVAC equipment using natural language. Try asking: 'Find quiet split systems with heating for a 25m² room'" data-ru="Привет! Я помогу найти HVAC оборудование через естественный язык. Попробуйте спросить: 'Найди тихие сплит-системы с обогревом для комнаты 25м²'">Hello! I can help you find HVAC equipment using natural language. Try asking: 'Find quiet split systems with heating for a 25m² room'</div>
                            </div>
                        </div>
                        <div class="ai-chat-input">
                            <input type="text" class="ai-chat-input-field" id="aiSearchInput" placeholder="Ask me anything about HVAC equipment..." data-en-placeholder="Ask me anything about HVAC equipment..." data-ru-placeholder="Спросите меня о HVAC оборудовании...">
                            <button class="ai-chat-send-btn" id="aiSearchSendBtn">➤</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Brand Search Integration -->
    <script src="js/brand-search.js"></script>

    <!-- Cart Modal Functions -->
    <script>
        // Cart Modal Functions
        function openCart() {
            console.log('openCart() called');
            console.log('Current globalQuoteData:', globalQuoteData);
            
            const cartModal = document.getElementById('cartModal');
            console.log('Cart modal element:', cartModal);
            
            if (cartModal) {
                cartModal.style.display = 'flex';
                document.body.style.overflow = 'hidden';
                console.log('Cart modal display set to flex');
                
                populateCartItems();
                updateCartSummary();
                console.log('Cart opened with', Object.keys(globalQuoteData).length, 'brands');
            } else {
                console.error('Cart modal element not found!');
            }
        }

        function closeCart() {
            const cartModal = document.getElementById('cartModal');
            if (cartModal) {
                cartModal.style.display = 'none';
                document.body.style.overflow = '';
                console.log('Cart closed');
            }
        }

        function populateCartItems() {
            const cartItems = document.getElementById('cartItems');
            if (!cartItems) return;

            if (Object.keys(globalQuoteData).length === 0) {
                cartItems.innerHTML = `
                    <div class="cart-empty">
                        <div class="cart-empty-icon">🛒</div>
                        <div class="cart-empty-text" data-en="Cart is empty" data-ru="Корзина пуста">Корзина пуста</div>
                        <div class="cart-empty-subtext" data-en="Add products from different brands to create a quote" data-ru="Добавьте товары из разных брендов для создания КП">Добавьте товары из разных брендов для создания КП</div>
                    </div>
                `;
                return;
            }

            let html = '';
            
            // Sort brands alphabetically for consistent display
            const sortedBrands = Object.keys(globalQuoteData).sort();
            
            sortedBrands.forEach(brand => {
                const products = globalQuoteData[brand];
                if (!products || products.length === 0) return;

                // Get brand display name and color
                const brandInfo = getBrandInfo(brand);
                
                html += `
                    <div class="cart-brand-section" data-brand="${brand}">
                        <div class="cart-brand-header" style="background: ${brandInfo.color}; color: ${brandInfo.textColor};">
                            <div class="cart-brand-logo">
                                ${brandInfo.icon}
                                <span class="cart-brand-name">${brandInfo.displayName}</span>
                            </div>
                            <div class="cart-brand-count">${products.length}</div>
                        </div>
                        <div class="cart-brand-products">
                            ${products.map((product, index) => `
                                <div class="cart-product-item">
                                    <div class="cart-product-icon">🌀</div>
                                    <div class="cart-product-info">
                                        <div class="cart-product-name">${product.title || product.model || product.name || 'Unnamed Product'}</div>
                                        <div class="cart-product-specs">${formatProductSpecs(product)}</div>
                                        ${product.isAnalog ? '<div class="cart-product-analog">🔄 Analog Match</div>' : ''}
                                    </div>
                                    <div class="cart-product-price">${formatPrice(product.price || 0)}</div>
                                    <button class="cart-product-remove" onclick="removeFromCart('${brand}', ${index})" title="Удалить товар">×</button>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            });

            cartItems.innerHTML = html;
        }

        function getBrandInfo(brand) {
            const brandMap = {
                'daikin': { 
                    displayName: 'Daikin', 
                    color: 'linear-gradient(135deg, #003DA5, #0056d6)', 
                    textColor: 'white',
                    icon: '❄️'
                },
                'mitsubishi': { 
                    displayName: 'Mitsubishi Electric', 
                    color: 'linear-gradient(135deg, #E60012, #ff1a2b)', 
                    textColor: 'white',
                    icon: '⚡'
                },
                'lg': { 
                    displayName: 'LG Electronics', 
                    color: 'linear-gradient(135deg, #A50034, #c7004b)', 
                    textColor: 'white',
                    icon: '🔴'
                },
                'panasonic': { 
                    displayName: 'Panasonic', 
                    color: 'linear-gradient(135deg, #0066cc, #0080ff)', 
                    textColor: 'white',
                    icon: '🔵'
                },
                'toshiba': { 
                    displayName: 'Toshiba', 
                    color: 'linear-gradient(135deg, #d50000, #ff1744)', 
                    textColor: 'white',
                    icon: '🔺'
                }
            };
            
            return brandMap[brand.toLowerCase()] || {
                displayName: brand.charAt(0).toUpperCase() + brand.slice(1),
                color: 'linear-gradient(135deg, #666, #888)',
                textColor: 'white',
                icon: '🏢'
            };
        }

        function formatProductSpecs(product) {
            const specs = [];
            if (product.capacity) specs.push(product.capacity);
            if (product.cooling_capacity) specs.push(`Охлаждение: ${product.cooling_capacity}`);
            if (product.heating_capacity) specs.push(`Обогрев: ${product.heating_capacity}`);
            if (product.power_consumption) specs.push(`Потребление: ${product.power_consumption}`);
            if (product.specs) specs.push(product.specs);
            
            return specs.length > 0 ? specs.join(' | ') : 'Технические характеристики не указаны';
        }

        function formatPrice(price) {
            if (!price || price === 0) return 'Цена по запросу';
            
            const currencySelect = document.getElementById('currencySelect');
            const currency = currencySelect ? currencySelect.value : 'usd';
            
            switch (currency) {
                case 'rub':
                    return `${(price * 75).toLocaleString('ru-RU')} ₽`;
                case 'eur':
                    return `${(price * 0.85).toLocaleString('de-DE')} €`;
                default:
                    return `$${price.toLocaleString('en-US')}`;
            }
        }

        function normalizeBrandName(brandName) {
            if (!brandName) return 'unknown';
            
            const normalized = brandName.toLowerCase().trim();
            
            // Handle common brand variations
            const brandMappings = {
                'daikin': 'daikin',
                'daikin industries': 'daikin',
                'mitsubishi': 'mitsubishi',
                'mitsubishi electric': 'mitsubishi',
                'mitsubishi heavy': 'mitsubishi',
                'lg': 'lg',
                'lg electronics': 'lg',
                'panasonic': 'panasonic',
                'toshiba': 'toshiba',
                'toshiba carrier': 'toshiba',
                'carrier': 'carrier',
                'york': 'york',
                'goodman': 'goodman',
                'rheem': 'rheem',
                'lennox': 'lennox'
            };
            
            return brandMappings[normalized] || normalized;
        }

        function updateCartSummary() {
            const totalProducts = Object.values(globalQuoteData).reduce((sum, brandProducts) => {
                return sum + brandProducts.length;
            }, 0);

            const totalBrands = Object.keys(globalQuoteData).length;

            const totalPrice = Object.values(globalQuoteData).reduce((sum, brandProducts) => {
                return sum + brandProducts.reduce((brandSum, product) => {
                    return brandSum + (product.price || 0);
                }, 0);
            }, 0);

            document.getElementById('cartTotalProducts').textContent = totalProducts;
            document.getElementById('cartTotalBrands').textContent = totalBrands;
            document.getElementById('cartTotalPrice').textContent = `$${totalPrice.toFixed(0)}`;
        }

        function removeFromCart(brand, productIndex) {
            if (globalQuoteData[brand] && globalQuoteData[brand][productIndex]) {
                globalQuoteData[brand].splice(productIndex, 1);
                
                // Remove empty brand
                if (globalQuoteData[brand].length === 0) {
                    delete globalQuoteData[brand];
                }
                
                // Save to localStorage
                localStorage.setItem('globalQuoteData', JSON.stringify(globalQuoteData));
                
                // Update UI
                populateCartItems();
                updateCartSummary();
                updateCartBadge();
                
                console.log('Product removed from cart');
            }
        }

        function clearCart() {
            const currentLang = localStorage.getItem('preferredLanguage') || 'ru';
            const message = currentLang === 'en' ? 
                'Are you sure you want to clear the entire cart?' :
                'Вы уверены, что хотите очистить всю корзину?';
            
            if (confirm(message)) {
                globalQuoteData = {};
                localStorage.removeItem('globalQuoteData');
                populateCartItems();
                updateCartSummary();
                updateCartBadge();
                console.log('Cart cleared');
            }
        }

        // Debug function to test cart with multiple brands
        function testCart() {
            console.log('Testing cart functionality...');
            console.log('globalQuoteData:', globalQuoteData);
            console.log('Cart button:', document.getElementById('cartBtn'));
            console.log('Cart modal:', document.getElementById('cartModal'));
            
            // Add test products from different brands
            const testBrands = ['daikin', 'mitsubishi', 'lg'];
            
            testBrands.forEach((brand, index) => {
                if (!globalQuoteData[brand]) {
                    globalQuoteData[brand] = [];
                }
                globalQuoteData[brand].push({
                    title: `${brand.charAt(0).toUpperCase() + brand.slice(1)} Test Unit ${index + 1}`,
                    model: `${brand.toUpperCase()}-${3500 + index * 500}`,
                    capacity: `${3.5 + index * 0.5} kW`,
                    cooling_capacity: `${3.5 + index * 0.5} kW`,
                    heating_capacity: `${4.0 + index * 0.5} kW`,
                    power_consumption: `${1.2 + index * 0.1} kW`,
                    price: 1000 + index * 200,
                    brand: brand,
                    isAnalog: index > 0 // Mark second and third as analogs
                });
            });
            
            localStorage.setItem('globalQuoteData', JSON.stringify(globalQuoteData));
            updateCartBadge(true);
            console.log('Test products added to cart for brands:', testBrands);
            console.log('Updated globalQuoteData:', globalQuoteData);
            
            // Auto-open cart to show results
            setTimeout(() => {
                openCart();
            }, 500);
        }

        function generatePDFQuote() {
            const currentLang = localStorage.getItem('preferredLanguage') || 'ru';
            const message = currentLang === 'en' ? 
                'PDF quote generation will be implemented soon.' :
                'Генерация PDF КП будет реализована в ближайшее время.';
            alert(message);
        }

        function sendQuoteRequest() {
            const currentLang = localStorage.getItem('preferredLanguage') || 'ru';
            const message = currentLang === 'en' ? 
                'Quote request sending will be implemented soon.' :
                'Отправка запроса КП будет реализована в ближайшее время.';
            alert(message);
        }

        // Close cart when clicking escape
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeCart();
            }
        });
    </script>
</body>
</html>